<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mingjie's Blog</title>
    <description>Write everything, think everything.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Fri, 26 Oct 2018 11:55:45 +0900</pubDate>
    <lastBuildDate>Fri, 26 Oct 2018 11:55:45 +0900</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>OASP笔记 - 14</title>
        <description>&lt;p&gt;这俩参数是恒星的基本参数。假设有俩以某恒星为中心的同心球，一个半径万为恒星半径&lt;script type=&quot;math/tex&quot;&gt;R&lt;/script&gt;，另一个的半径为恒星到观测者的距离&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;；在这两个球面上接收到的辐射量为&lt;script type=&quot;math/tex&quot;&gt;\mathscr{F}_\nu, F_\nu&lt;/script&gt;，则有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;4\pi d^2 F_\nu =  4\pi R^2 \mathscr{F}_\nu \tag{14.1}&lt;/script&gt;

&lt;p&gt;将有效温度的定义&lt;script type=&quot;math/tex&quot;&gt;(1.2)&lt;/script&gt;代入并积分，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty F_\nu d\nu = (R/d)^2 \int_0^\infty \mathscr{F}_\nu d\nu = \theta_\mathrm{R}^2 \sigma T_\mathrm{eff}^4 \tag{14.2}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\theta_\mathrm{R}&lt;/script&gt;自然是角半径了。测量得到&lt;script type=&quot;math/tex&quot;&gt;\int_0^\infty F_\nu d\nu&lt;/script&gt;和角直径和距离之后就可以算出恒星半径以及有效温度了。例外是食双星，可以直接得出线直径。&lt;/p&gt;

&lt;p&gt;不同波段是有不同的半径的，毕竟光深和几何深度的关系随着频率而变化。同时有效温度实际上在恒星不同的表面上是不一样的（有米粒组织等），而且决定恒星大气更根本的参数是温度随着光深的分布。但是这一章我们先忽略这些东西，就看这两个参数。&lt;/p&gt;

&lt;h2 id=&quot;半径测量&quot;&gt;半径测量&lt;/h2&gt;

&lt;p&gt;半径测量分为直接和间接的方法。&lt;/p&gt;

&lt;h3 id=&quot;直接方法&quot;&gt;直接方法&lt;/h3&gt;

&lt;h5 id=&quot;干涉法&quot;&gt;干涉法&lt;/h5&gt;

&lt;p&gt;干涉法好说，测量一个方波傅立叶变换之后的零点位置可以得出这个方波的大小，而干涉仪可以测出这个零点。现在(2003年)的精度已经达到了0.05毫角秒，有几百颗星的角直径被测出来了。&lt;/p&gt;

&lt;h5 id=&quot;月掩星法&quot;&gt;月掩星法&lt;/h5&gt;

&lt;p&gt;也好说，测量恒星被掩食的时候的光变然后建模拟合就行。局限在于不同波度的光变幅度不一样，所以需要用比较窄的滤光片；类似的，月球边缘的起伏也会造成不同次掩食时光变和时标的不一样。当然最大的问题是白道和月球的运动是固定的，这个方法只对少部分恒星适用。通过这个方法测出来角直径的恒星也在100颗左右。&lt;/p&gt;

&lt;h5 id=&quot;食双星&quot;&gt;食双星&lt;/h5&gt;

&lt;p&gt;对于食双星，我们知道掩食时间与视向速度，那就知道线直径了。不过密近双星经常会偏离球形，同时物质交换会使得两颗恒星的光谱趋同，加大掩食时间与视向速度的测量难度。远距离双星的难度主要在于视向速度的测量方面。&lt;/p&gt;

&lt;h5 id=&quot;热流量法&quot;&gt;热流量法&lt;/h5&gt;

&lt;p&gt;对&lt;script type=&quot;math/tex&quot;&gt;(14.2)&lt;/script&gt;稍作变形：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{R}{d} = \theta_\mathrm{R} = \sqrt{\frac{\int_0^\infty F_\nu d\nu}{\sigma T_\mathrm{eff}^4}} \tag{14.4}&lt;/script&gt;

&lt;p&gt;不过同样需要知道距离、有效温度以及恒星的热辐射。&lt;/p&gt;

&lt;p&gt;热辐射可以通过恒星的光谱来估计，或者与太阳的数据作差转换成热星等，利用第十章的热改正来得到恒星的热星等。有效温度大致是从恒星模型来，也就是之后说的一些方法，直接或间接地得到。&lt;/p&gt;

&lt;h5 id=&quot;测光半径&quot;&gt;测光半径&lt;/h5&gt;

&lt;p&gt;热流量法要求我们知道整个光谱范围的流量，而测光半径法则走向了另一个极端。从&lt;script type=&quot;math/tex&quot;&gt;(14.1)&lt;/script&gt;我们可得：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\theta_\mathrm{R} = R/d = (F_\nu/\mathscr{F}_\nu)^{1/2} \tag{14.7}&lt;/script&gt;

&lt;p&gt;那如果我们能够准确知道某一个波长下的&lt;script type=&quot;math/tex&quot;&gt;F_\nu, \mathscr{F}_\nu&lt;/script&gt;，我们就能算出角直径来了。&lt;script type=&quot;math/tex&quot;&gt;F_\nu&lt;/script&gt;好测，而&lt;script type=&quot;math/tex&quot;&gt;\mathscr{F}_\nu&lt;/script&gt;可以从模型来。只要在几个不同的波长上有测光，我们就可以将不同参数的模型与之匹配，找到最合适的那个。当然这些测光点是越多越好，有利于选择正确的模型。&lt;/p&gt;

&lt;p&gt;这个方法依赖绝对定标，对测光以及模型的流量绝对定标要求不低。还有一个红外流量法，介于这两个方法之间：假设一个&lt;script type=&quot;math/tex&quot;&gt;T_\mathrm{eff}&lt;/script&gt;，得到一个&lt;script type=&quot;math/tex&quot;&gt;\theta_\mathrm{R}&lt;/script&gt;，又得到一个新的&lt;script type=&quot;math/tex&quot;&gt;T_\mathrm{eff}&lt;/script&gt;，如此循环。不过这个方法又和有效温度以及模型扯上了关系，同时红外的模型准确度也是要考虑的问题。&lt;/p&gt;

&lt;h3 id=&quot;间接方法&quot;&gt;间接方法&lt;/h3&gt;

&lt;h5 id=&quot;表面亮度法&quot;&gt;表面亮度法&lt;/h5&gt;

&lt;p&gt;还是从热流量法出发，将&lt;script type=&quot;math/tex&quot;&gt;(14.4)&lt;/script&gt;取对数并将流量转成星等，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\lg{\theta_\mathrm{R}} = - 0.2 (m_\mathrm{V} - BC) - 2\lg{T_\mathrm{eff}} + \text{constant} \tag{14.5}&lt;/script&gt;

&lt;p&gt;于太阳的参数作差，把不好测量的项移到一边并定义一个新变量：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathbb{P}_\mathrm{V} = \lg{\frac{T_\mathrm{eff}}{T_\mathrm{eff}^\odot}} - 0.1 (BC-BC^\odot) = -0.1 (m_\mathrm{V}-m_\mathrm{V}^\odot) - 0.5 \lg{\frac{\theta_\mathrm{R}}{\theta_\mathrm{R}^\odot}} \tag{14.10}&lt;/script&gt;

&lt;p&gt;当我们有一批通过直接方法测出来的&lt;script type=&quot;math/tex&quot;&gt;\theta_\mathrm{R}&lt;/script&gt;以及它们的&lt;script type=&quot;math/tex&quot;&gt;m_\mathrm{V}&lt;/script&gt;时，就可以很容易地算出&lt;script type=&quot;math/tex&quot;&gt;\mathbb{P}_\mathrm{V}&lt;/script&gt;；再用公式拟合&lt;script type=&quot;math/tex&quot;&gt;\mathbb{P}_\mathrm{V}&lt;/script&gt;和某些观测量（比如色指数）的关系后，就可以通过测量色指数来得到角半径了。&lt;/p&gt;

&lt;h5 id=&quot;把这些结果-放到一张-图上&quot;&gt;把这些结果 放到一张 图上&lt;/h5&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP14/01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们能从这张图上看出不少信息。&lt;/p&gt;

&lt;p&gt;首先不同方法测出来的结果是一致的，没有哪种结果有很大偏离。对于矮星来说半径的弥散比较小，而且有一个下限零龄主序(ZAMS)在。&lt;script type=&quot;math/tex&quot;&gt;B-V &gt; 0.5&lt;/script&gt;的恒星演化时标比较长，所以没怎么演化，都堆在了一起；反之高温恒星的弥散就大一点了。在0.4到0.6左右矮星半径有一个快速的下降，这是因为对流传能开始占据一定比例，帮助恒星更快地收缩（但是为什么之后又慢了？）。&lt;/p&gt;

&lt;p&gt;对巨星的分布书中没有详细的描述。&lt;/p&gt;

&lt;h2 id=&quot;有效温度测量&quot;&gt;有效温度测量&lt;/h2&gt;

&lt;p&gt;仍然从&lt;script type=&quot;math/tex&quot;&gt;(14.2)&lt;/script&gt;出发：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;T_\mathrm{eff} = \frac{\left( \int_0^\infty F_\nu d\nu / \sigma \right)^{1/4}}{(R/d)^{1/2}} \tag{14.14}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;T_\mathrm{eff} = \frac{T_\mathrm{eff}^\odot \left( \int_0^\infty F_\nu d\nu / \int_0^\infty F_\nu^\odot d\nu \right)^{1/4}}{(\theta_\mathrm{R}/\theta_\mathrm{R}^\odot)^{1/2}} \tag{14.15}&lt;/script&gt;

&lt;p&gt;前者需要流量的绝对定标、后者和太阳作比；现在的话这俩都可以用。只不过恒星的热辐射不能完全被测出来，里面就涉及到恒星模型的帮助；那么用恒型模型也可以测出有效温度。&lt;/p&gt;

&lt;h3 id=&quot;光球层模型法&quot;&gt;光球层模型法&lt;/h3&gt;

&lt;p&gt;也就是算出一个模型来（温度分布），然后加上各个波段上的吸收系数就有辐射了。当然它的好坏取决于模型有多合适。&lt;/p&gt;

&lt;h3 id=&quot;有效温度关系校准&quot;&gt;有效温度关系校准&lt;/h3&gt;

&lt;p&gt;有效温度和很多的参数有关系，比如色指数和光谱型。当然误差会来自色指数的测量、星周包层带来的红化等等。既然说到了校准，我们之后就介绍一些校准有效温度的方法。毕竟多数时候有效温度只是区分恒星的一个数字，所以拿什么来校准问题都不大。&lt;/p&gt;

&lt;h5 id=&quot;帕邢连续谱&quot;&gt;帕邢连续谱&lt;/h5&gt;

&lt;p&gt;实际上指的是帕邢连续谱的斜率。连续谱受谱线以及&lt;script type=&quot;math/tex&quot;&gt;\log{g}&lt;/script&gt;的影响不大，基本上是LTE，还对有效温度比较敏感。当然对于高温和低温恒星不一定有用，因为它们的主要辐射不在可见光了。还有一点就是连续谱形成于比较深的地方，所以从斜率转化到有效温度的时候要注意匹配。&lt;/p&gt;

&lt;h5 id=&quot;模型色指数&quot;&gt;模型色指数&lt;/h5&gt;

&lt;p&gt;当合成光谱质量很高的时候，我们可以去计算模型的色指数。这包括连续谱和谱线的计算，以及模型与观测星等的零点校正，还有观测波段的透过率。&lt;/p&gt;

&lt;h5 id=&quot;巴尔末跳跃&quot;&gt;巴尔末跳跃&lt;/h5&gt;

&lt;p&gt;用于高温恒星，类似于帕邢连续谱，但是是测量巴尔末线系限左右的流量差。不过也受&lt;script type=&quot;math/tex&quot;&gt;\log{g}&lt;/script&gt;和元素丰度影响，需要进行改正。同时在线系限附近有很多的巴尔末线，连续谱不好确定。帕邢和巴尔末附近的恒星模型有的时候也给出不同的结果。&lt;/p&gt;

&lt;h5 id=&quot;氢线&quot;&gt;氢线&lt;/h5&gt;

&lt;p&gt;氢线的强度对有效温度很敏感。但是氢线太胖了不好测量，以及高温之后它也会和&lt;script type=&quot;math/tex&quot;&gt;\log{g}&lt;/script&gt;有关系。&lt;/p&gt;

&lt;h5 id=&quot;原子谱线的ldr&quot;&gt;原子谱线的LDR&lt;/h5&gt;

&lt;p&gt;这就是我的硕士毕业论文，不多说了。&lt;/p&gt;
</description>
        <pubDate>Sun, 14 Oct 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/10/14/1026Dinner/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/10/14/1026Dinner/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>1026 Dinner</title>
        <description>&lt;script&gt;
  function ans_xt(){
    if (document.getElementById('xt_ans').value == 'happybirxt'){
  alert('The answer is right!')
  document.getElementById('answercontent_xt').hidden = false;
  document.getElementById('answersheet_xt').hidden = true;
    }
    else{
  alert('The answer is wrong T_T; please try again')
    }
  }

  function ans_wy(){
    if (document.getElementById('wy_ans').value == 'tjbomddwy'){
  alert('The answer is right!')
  document.getElementById('answercontent_wy').hidden = false;
  document.getElementById('answersheet_wy').hidden = true;
    }
    else{
  alert('The answer is wrong T_T; please try again')
    }
  }

&lt;/script&gt;

&lt;body&gt;
&lt;header&gt;
&lt;h1&gt; Reading: About SDSS &lt;/h1&gt;
&lt;/header&gt;

&lt;section&gt;
&lt;h2&gt; For XT&lt;/h2&gt;
&lt;p&gt;
Please read the following paragraph and pick up all the letters from the hint, then fill the answer in the blank.
&lt;/p&gt;
&lt;p&gt;
The Sloan Digital Sky Survey has created the most detailed three-dimensional maps of the Universe ever made, with deep* multi-color images of one third of the sky, and spectra for more than three million astronomical objects. Learn and# explore all phases and surveys-past, present, and future-of the SDSS.
&lt;/p&gt;
&lt;/section&gt;


&lt;section id=&quot;answersheet_xt&quot;&gt;

*:20, #:40 &lt;br /&gt;

Hint: 1(2) 2(4) 13(3) 20(4) 4(3) 38(2) 3(2) 5(3) 41(2) 38(6) &lt;br /&gt;

Answer: &lt;input type=&quot;email&quot; name=&quot;xt_ans&quot; id=&quot;xt_ans&quot; /&gt; &amp;lt;button type=&quot;submit&quot; onclick=ans_xt()&amp;gt;Verify&amp;lt;/button&amp;gt;
&lt;/section&gt;

&lt;section hidden=&quot;&quot; id=&quot;answercontent_xt&quot;&gt;
&lt;picture&gt;
&lt;img src=&quot;1026dinner_img/HB_xt.png&quot; alt=&quot;hb_xt&quot; style=&quot;width:100%;&quot; /&gt;
&lt;/picture&gt;
&lt;p&gt;
&lt;h3&gt;Which galaxies are used in this image?&lt;/h3&gt;
&lt;div id=&quot;letterlist&quot; class=&quot;hidden&quot; style=&quot;overflow: visible;&quot;&gt;
&lt;div&gt;
&lt;dl&gt;
&lt;dt class=&quot;letterlisthead&quot;&gt;Letter   SDSS ID &lt;small&gt;(click for more information)&lt;/small&gt;&lt;/dt&gt;

&lt;dt&gt;H   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587733608561442856&quot;&gt;587733608561442856&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;O   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587736543089000513&quot;&gt;587736543089000513   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;P   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587728668803006586&quot;&gt;587728668803006586   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;P   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587728931330982204&quot;&gt;587728931330982204   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;T   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587732701790666878&quot;&gt;587732701790666878   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;T   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587726032791404626&quot;&gt;587726032791404626   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;Y   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587725775607169322&quot;&gt;587725775607169322   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;Y   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587735489208778875&quot;&gt;587735489208778875   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;a   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587741532254109848&quot;&gt;587741532254109848   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;a   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587730774426452217&quot;&gt;587730774426452217   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;b   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=588017719576625235&quot;&gt;588017719576625235   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;d   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587739407301279839&quot;&gt;587739407301279839   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;h   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=588023048016035879&quot;&gt;588023048016035879   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;i   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587736584977580389&quot;&gt;587736584977580389   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;r   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587739721376989338&quot;&gt;587739721376989338   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;t   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=588017979992441297&quot;&gt;588017979992441297   &lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;x   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587738947194388877&quot;&gt;587738947194388877   &lt;/a&gt;&lt;/dt&gt;

&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/section&gt;

&lt;section&gt;
&lt;h2&gt; For WY&lt;/h2&gt;
&lt;p&gt;
Please read the following paragraph and pick up all the letters from the hint, then fill the answer in the blank.
&lt;/p&gt;
&lt;p&gt;
The SDSS began regular survey operations in 2000, after a decade of design and construction.  It has progressed through several&amp;amp; phases, SDSSI, SDSSII, SDSSIII, and SDSSIV. Each of these phases has involved multiple object surveys with interlocking science goals.  The$ three surveys that comprise SDSSIV are eBOSS, APOGEE2, and MaNGA, described at the links below.
&lt;/p&gt;
&lt;/section&gt;

&lt;section id=&quot;answersheet_wy&quot;&gt;

&amp;amp;: 20, $: 40. &lt;br /&gt;

Hint: 1(1) 34(3) 3(1) 6(1) 44(3) 22(2) 23(2) 36(1) 5(6)&lt;br /&gt;

Answer: &lt;input type=&quot;email&quot; name=&quot;wy_ans&quot; id=&quot;wy_ans&quot; /&gt; &amp;lt;button type=&quot;submit&quot; onclick=ans_wy()&amp;gt;Verify&amp;lt;/button&amp;gt;
&lt;/section&gt;

&lt;section hidden=&quot;&quot; id=&quot;answercontent_wy&quot;&gt;
&lt;picture&gt;
&lt;img src=&quot;1026dinner_img/HB_wy.png&quot; alt=&quot;hb_wy&quot; style=&quot;width:100%;&quot; /&gt;
&lt;/picture&gt;

&lt;div id=&quot;letterlist&quot; class=&quot;hidden&quot; style=&quot;overflow: visible;&quot;&gt;
&lt;div&gt;
&lt;dl&gt;
&lt;dt class=&quot;letterlisthead&quot;&gt;Letter   SDSS ID &lt;small&gt;(click for more information)&lt;/small&gt;&lt;/dt&gt;

&lt;dt&gt;A   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=588011101032546573&quot;&gt;588011101032546573&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;H   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587733608561442856&quot;&gt;587733608561442856&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;P   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587728931330982204&quot;&gt;587728931330982204&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;T   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587725083039563953&quot;&gt;587725083039563953&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;T   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587741391036612754&quot;&gt;587741391036612754&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;Y   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587735489208778875&quot;&gt;587735489208778875&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;Y   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587735348038468080&quot;&gt;587735348038468080&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;a   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587729782813491982&quot;&gt;587729782813491982&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;b   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587729776370450597&quot;&gt;587729776370450597&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;d   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=588017726548476142&quot;&gt;588017726548476142&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;h   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=588023048016035879&quot;&gt;588023048016035879&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;i   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587731186736169172&quot;&gt;587731186736169172&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;o   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587736543089000513&quot;&gt;587736543089000513&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;p   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587729774758133902&quot;&gt;587729774758133902&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;r   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587739721376989338&quot;&gt;587739721376989338&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;w   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587722982838436141&quot;&gt;587722982838436141&lt;/a&gt;&lt;/dt&gt;

&lt;dt&gt;y   &lt;a href=&quot;http://cas.sdss.org/dr7/en/tools/explore/obj.asp?id=587736477060300967&quot;&gt;587736477060300967&lt;/a&gt;&lt;/dt&gt;

&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/section&gt;

&lt;footer&gt;
This page is created by Mingjie Jian. To learn more about SDSS, visit &lt;a href=&quot;https://www.sdss.org/&quot;&gt; here&lt;/a&gt;.
&lt;/footer&gt;
&lt;/body&gt;
</description>
        <pubDate>Sun, 14 Oct 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/10/14/OASP14/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/10/14/OASP14/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 13</title>
        <description>&lt;p&gt;Image credit: &lt;a href=&quot;http://www.jonathanwalker.net.au/spectral-painting.php&quot;&gt;Jonathan Walker&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;我们在归一化光谱下面讨论。&lt;/p&gt;

&lt;h3 id=&quot;谱线的转移方程&quot;&gt;谱线的转移方程&lt;/h3&gt;

&lt;p&gt;主要参考第七章的东西。大气连续谱上有吸收和发射，那么谱线也有。&lt;/p&gt;

&lt;p&gt;令&lt;script type=&quot;math/tex&quot;&gt;l_\nu&lt;/script&gt;为谱线吸收系数，&lt;script type=&quot;math/tex&quot;&gt;j^l_\nu&lt;/script&gt;为谱线发射系数；对于连续谱这两个量是&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu, j^c_\nu&lt;/script&gt;。那么对于式子&lt;script type=&quot;math/tex&quot;&gt;(7.1)&lt;/script&gt;，我们还有同样的形式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \frac{dI_\nu}{d\tau_\nu} &amp;= -I_\nu + \frac{j^l_\nu + j^c_\nu}{l_\nu + \kappa_\nu} \\  &amp;= -I_\nu + S_\nu \end{align} \tag{13.3} %]]&gt;&lt;/script&gt;

&lt;p&gt;只是这时候光深&lt;script type=&quot;math/tex&quot;&gt;S_\nu&lt;/script&gt;包含了谱线和连续谱的部分，变成了&lt;script type=&quot;math/tex&quot;&gt;\frac{j^l_\nu + j^c_\nu}{l_\nu + \kappa_\nu}&lt;/script&gt;。同样光深也要包含谱线的贡献：&lt;script type=&quot;math/tex&quot;&gt;d\tau_\nu = (l_\nu + \kappa_\nu) \rho dx&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;因为光深还是&lt;script type=&quot;math/tex&quot;&gt;S_\nu&lt;/script&gt;，所以大气辐射转移的基本式子&lt;script type=&quot;math/tex&quot;&gt;(7.4), (7.9)&lt;/script&gt;以及它们有关恒星表面的推论&lt;script type=&quot;math/tex&quot;&gt;(7.10), (7.15)&lt;/script&gt;仍然成立，就不抄过来了。&lt;/p&gt;

&lt;p&gt;如此这般，这般如此，我们的主要任务还是回到了如何求新的源函数上。&lt;/p&gt;

&lt;h3 id=&quot;谱线的源函数&quot;&gt;谱线的源函数&lt;/h3&gt;

&lt;p&gt;我们先定性的看谱线形成的深度。利用灰大气假设，我们有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S(\tau_\nu) = \frac{3F_\nu(0)}{4\pi}(\tau_\nu+\frac{2}{3}) \tag{13.7}&lt;/script&gt;

&lt;p&gt;形式和&lt;script type=&quot;math/tex&quot;&gt;(7.34)&lt;/script&gt;是完全一样的，只不过虽然连续谱和波长无关，谱线却和波长有关，所以&lt;script type=&quot;math/tex&quot;&gt;\nu&lt;/script&gt;的下标回来了。这个式子告诉我们光深越大的时候源函数越大（大气底层发射更多嘛），同时&lt;script type=&quot;math/tex&quot;&gt;F_\nu(0)&lt;/script&gt;也与光深成正比。这就说明了谱线中心所对应的光深比较小，形成场所在大气较上层；而谱线的边缘所对应的光深比较大，形成场所在大气较下层。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP13/01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;当然这个只是定性的分析，实际定量的要这么做：&lt;/p&gt;

&lt;p&gt;我们引入谱线的发射和吸收轮廓&lt;script type=&quot;math/tex&quot;&gt;\psi(\nu), \phi(\nu)&lt;/script&gt;，并且加在&lt;script type=&quot;math/tex&quot;&gt;(5.16), (5.17)&lt;/script&gt;上面：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;j^l_\nu \rho = N_u A_{ul} \psi(\nu) h\nu&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;l^l_\nu \rho = N_l B_{lu} \phi(\nu) h\nu - N_u B_{ul} \phi(\nu) h\nu&lt;/script&gt;

&lt;p&gt;所以源函数就是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_l = \frac{j^l_\nu}{l^l_\nu} = \frac{N_u A_{ul} \psi(\nu) h\nu}{N_l B_{lu} \phi(\nu) h\nu - N_u B_{ul} \phi(\nu) h\nu}&lt;/script&gt;

&lt;p&gt;把&lt;script type=&quot;math/tex&quot;&gt;(6.8)&lt;/script&gt;拿过来消掉所有的AABB：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_l = \frac{2h\nu^3}{c^2} \frac{1}{(N_l/N_u)(g_u/g_l)-1}\frac{\psi(\nu)}{\phi(\nu)} \tag{13.9}&lt;/script&gt;

&lt;p&gt;这就是non-LTE下的源函数。&lt;/p&gt;

&lt;p&gt;如果在LTE下并且有细致平衡原理的话，吸收发射轮廓相等并且有&lt;script type=&quot;math/tex&quot;&gt;(1.17)&lt;/script&gt;，则&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_l = \frac{2h\nu^3}{c^2} \frac{1}{e^{h\nu/kT}-1} = B_\nu(T) \tag{13.10}&lt;/script&gt;

&lt;p&gt;就比较简单了。&lt;/p&gt;

&lt;p&gt;LTE的东西当然比较好用，不过最近在华沙的一个Gaia Workshop里面Maria Bergermann把LTE批判了一番，说nLTE对于元素丰度确定来说很重要。&lt;/p&gt;

&lt;h4 id=&quot;nlte下的源函数&quot;&gt;nLTE下的源函数&lt;/h4&gt;

&lt;p&gt;假设我们已知发射/吸收轮廓（或者它们比较好确定？），&lt;script type=&quot;math/tex&quot;&gt;(3.19)&lt;/script&gt;剩下的东西就是&lt;script type=&quot;math/tex&quot;&gt;(N_l/N_u)&lt;/script&gt;了。在稳态下处于某个能级的原子数量是不变的，所以有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dN_j}{dt} = \sum^M_{i=1}(N_iP_{ij} - N_jP_{ji}) = 0 \tag{13.11}&lt;/script&gt;

&lt;p&gt;也是守恒嘛。那这俩概率&lt;script type=&quot;math/tex&quot;&gt;P&lt;/script&gt;怎么求呢？它们包含了辐射跃迁的概率以及碰撞跃迁的概率：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P_{ij} = 4\pi A_{ij} + 4\pi B_{ij} \int_0^\infty J_\nu\phi(\nu)d\nu + C_{ij} \tag{13.12}&lt;/script&gt;

&lt;p&gt;就是概率=自发的+受激的+碰撞的呗。当然&lt;script type=&quot;math/tex&quot;&gt;i \ne j&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;i \lt j&lt;/script&gt;时&lt;script type=&quot;math/tex&quot;&gt;A_{ij}&lt;/script&gt;就没了。&lt;/p&gt;

&lt;p&gt;类似的对于&lt;script type=&quot;math/tex&quot;&gt;P_{ji}&lt;/script&gt;也有相似的形式，只不过&lt;script type=&quot;math/tex&quot;&gt;i \lt j&lt;/script&gt;变成了&lt;script type=&quot;math/tex&quot;&gt;i \gt j&lt;/script&gt;。有了这一堆&lt;script type=&quot;math/tex&quot;&gt;P&lt;/script&gt;之后我们就可以解方程&lt;script type=&quot;math/tex&quot;&gt;(3.11)&lt;/script&gt;了。&lt;/p&gt;

&lt;p&gt;所以我们可以从这里看出来想求&lt;script type=&quot;math/tex&quot;&gt;S_\nu&lt;/script&gt;我们需要&lt;script type=&quot;math/tex&quot;&gt;(N_l/N_u)&lt;/script&gt;，从而需要一堆&lt;script type=&quot;math/tex&quot;&gt;P&lt;/script&gt;，从而需要&lt;script type=&quot;math/tex&quot;&gt;J_\nu&lt;/script&gt;，从而需要&lt;script type=&quot;math/tex&quot;&gt;S_\nu&lt;/script&gt;。循环了怎么办？迭代呗。&lt;/p&gt;

&lt;h4 id=&quot;还有一些东西&quot;&gt;还有一些东西&lt;/h4&gt;

&lt;p&gt;实际上什么时候是LTE，什么时候是nLTE呢？大致来说，恒星大气内部是LTE，外部是nLTE。这其实很好理解，因为内部密度大，基本上能把里面来的光全部吸收掉再发射，就LTE了；而大气外部密度下降，就会有光子逃逸，所以就会逐渐偏离LTE。同时光子逃逸说明外层原子发射的光子变少了，源函数减小，并且原子逐渐变为吸收源，为谱线中心的吸收作出了贡献。&lt;/p&gt;

&lt;p&gt;这个结论同时也可以有一个有趣的推论：谱线中心是nLTE的，而线翼是LTE的。一个例子是太阳的Na D线。&lt;/p&gt;

&lt;h3 id=&quot;lte下的谱线轮廓计算&quot;&gt;LTE下的谱线轮廓计算&lt;/h3&gt;

&lt;p&gt;No more nLTE things. 究竟什么时候LTE是好的得通过实际比较才能知道，或者问Maria去。&lt;/p&gt;

&lt;p&gt;实际计算用的是&lt;script type=&quot;math/tex&quot;&gt;(7.15)&lt;/script&gt;，但是要加上谱线的吸收系数。&lt;script type=&quot;math/tex&quot;&gt;(13.15), (13.16)&lt;/script&gt;还没完全理解就不放上来了，毕竟这本书也没有涉及到具体详细的计算方法。&lt;/p&gt;

&lt;p&gt;有一个有用的推论就是：当谱线比较弱的时候，谱线的轮廓和吸收系数的轮廓是一样的。&lt;/p&gt;

&lt;p&gt;令&lt;script type=&quot;math/tex&quot;&gt;(13.7)&lt;/script&gt;中的&lt;script type=&quot;math/tex&quot;&gt;\tau_\nu = (4\pi-2)/3 = \tau_1&lt;/script&gt;，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_\nu(\tau_1) = F_\nu(0) \tag{13.8}&lt;/script&gt;

&lt;p&gt;那么&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{F_c - F_\nu}{F_c} \approx \frac{S_\nu(\tau_c=\tau_1) - S_\nu(\tau_\nu=\tau_1)}{S_\nu(\tau_c=\tau_1)} \tag{13.17}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\tau_c,\tau_\nu&lt;/script&gt;指的是没有/有谱线下的光深，并且LTE下谱线以及连续谱的源函数都是黑体辐射函数。&lt;/p&gt;

&lt;p&gt;现在的光深变为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\tau_\nu = \int_0^{\tau_0} \frac{l_\nu}{\kappa_0}dt_0 + \int_0^{\tau_0} \frac{\kappa_\nu}{\kappa_0}dt_0 = \tau_l + \tau_c&lt;/script&gt;

&lt;p&gt;（不熟悉的话参见第九章&lt;script type=&quot;math/tex&quot;&gt;(9.13)&lt;/script&gt;后面的式子）&lt;/p&gt;

&lt;p&gt;简化，假设&lt;script type=&quot;math/tex&quot;&gt;\frac{l_\nu}{\kappa_0}, \frac{\kappa_\nu}{\kappa_0}&lt;/script&gt;与光深无关，有&lt;script type=&quot;math/tex&quot;&gt;\tau_l = \frac{l_\nu}{\kappa_0}\tau_0, \tau_c = \frac{\kappa_\nu}{\kappa_0}\tau_0&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;S_\nu(\tau_\nu=\tau_1) = S_\nu(\tau_l+\tau_c=\tau_1) = S_\nu(\tau_c=\tau_1-\tau_l)&lt;/script&gt;以及&lt;script type=&quot;math/tex&quot;&gt;\tau_l \ll \tau_c&lt;/script&gt;，泰勒展开有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_\nu(\tau_\nu=\tau_1) = S_\nu(\tau_c=\tau_1) + \frac{dS_\nu}{d\tau_c}(-\tau_l) + ...&lt;/script&gt;

&lt;p&gt;所以&lt;script type=&quot;math/tex&quot;&gt;(13.17)&lt;/script&gt;变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{F_c - F_\nu}{F_c} \approx \frac{\tau_l}{S_\nu(\tau_c=\tau_1)} \frac{dS_\nu}{d\tau_c}|_{\tau1} = \tau_l  \frac{d\ln{S_\nu}}{d\tau_c}|_{\tau1}&lt;/script&gt;

&lt;p&gt;将&lt;script type=&quot;math/tex&quot;&gt;\tau_l = \frac{l_\nu}{\kappa_0}\tau_0&lt;/script&gt;代入，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \frac{F_c - F_\nu}{F_c} &amp;\approx \frac{l_\nu}{\kappa_0}\tau_0 \frac{d\ln{S_\nu}}{d\tau_c}|_{\tau1} \\
&amp;= \frac{l_\nu}{\kappa_\nu}\tau_c \frac{d\ln{S_\nu}}{d\tau_c}|_{\tau1}\\
&amp;= \text{constant} \frac{l_\nu}{\kappa_\nu} \tag{13.19}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;就是这样。&lt;/p&gt;

&lt;h3 id=&quot;谱线的贡献函数&quot;&gt;谱线的贡献函数&lt;/h3&gt;

&lt;p&gt;“王老五就是未结婚的王老五”，贡献函数就是第九章的贡献函数。不多说了，放两张图自己体会。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP13/02.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/img/in-post/post-OASP13/03.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;谱线强度的行为&quot;&gt;谱线强度的行为&lt;/h3&gt;

&lt;p&gt;这里只讨论几个对谱线强度有比较大影响的参数：温度、&lt;script type=&quot;math/tex&quot;&gt;\log{g}&lt;/script&gt;以及金属丰度。&lt;/p&gt;

&lt;h4 id=&quot;温度&quot;&gt;温度&lt;/h4&gt;

&lt;p&gt;对于弱线来说，温度变化影响了原子的占据数以及跃迁、连续谱的吸收，从而改变了谱线强度。强线以及氢线的话，还要考虑&lt;script type=&quot;math/tex&quot;&gt;\gamma&lt;/script&gt;随温度的变化。&lt;/p&gt;

&lt;p&gt;这里姑且只讨论弱线，则有下图：&lt;/p&gt;

&lt;p&gt;首先由&lt;script type=&quot;math/tex&quot;&gt;(8.12)&lt;/script&gt;有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa_\nu = \text{constant} T^{-5/2} P_\mathrm{e} e^{0.75/kT}&lt;/script&gt;

&lt;p&gt;Case 1时，是原子谱线+中性原子：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;N_l = \text{constant} N_0 e^{-\chi/kT} \approx e^{-\chi/kT}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Rightarrow R = \frac{l_\nu}{\kappa_\nu} = \text{constant} \frac{T^{5/2}}{P_\mathrm{e}} e^{-(\chi+0.75)/kT} \tag{13.20}&lt;/script&gt;

&lt;p&gt;又因为&lt;script type=&quot;math/tex&quot;&gt;(9.27)&lt;/script&gt;，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\ln{R} = \text{constant} +2.5 \ln{T} - \frac{chi+0.75}{kT} -\Omega T&lt;/script&gt;

&lt;p&gt;其他Case类似，具体公式请看书。要留意Case 1和4的表达式是完全一样的，但是因为温度范围不同趋势不同。&lt;/p&gt;

&lt;h4 id=&quot;压力&quot;&gt;压力&lt;/h4&gt;

&lt;p&gt;有三种：1. 电离平衡改变导致谱线/连续谱吸收原子数改变； 2. damping常数与与压力有关； 3. 线性斯塔克效应。&lt;/p&gt;

&lt;p&gt;这里的讨论都基于&lt;script type=&quot;math/tex&quot;&gt;(13.19)&lt;/script&gt;；低温时&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu \propto P_\mathrm{e}&lt;/script&gt;，高温时&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu \propto \text{constant}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;第一种：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;l_\nu \propto N_i&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{N_{r+1}}{N_r} = \frac{\Phi(T)}{P_\mathrm{e}}&lt;/script&gt;

&lt;p&gt;实际上是原子电离的Saha方程&lt;script type=&quot;math/tex&quot;&gt;(1.20)&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;当跃迁是发生在&lt;script type=&quot;math/tex&quot;&gt;r&lt;/script&gt;电离态而多数原子在&lt;script type=&quot;math/tex&quot;&gt;r+1&lt;/script&gt;电离态的时候，&lt;script type=&quot;math/tex&quot;&gt;l_\nu \propto P_\mathrm{e}&lt;/script&gt;；当跃迁是发生在&lt;script type=&quot;math/tex&quot;&gt;r+1&lt;/script&gt;电离态而多数原子在&lt;script type=&quot;math/tex&quot;&gt;r+1&lt;/script&gt;电离态的时候，&lt;script type=&quot;math/tex&quot;&gt;l_\nu \propto \text{constant}&lt;/script&gt;。当跃迁是发生在&lt;script type=&quot;math/tex&quot;&gt;r+1&lt;/script&gt;电离态而多数原子在&lt;script type=&quot;math/tex&quot;&gt;r&lt;/script&gt;电离态的时候，&lt;script type=&quot;math/tex&quot;&gt;l_\nu \propto P_\mathrm{e}^{-1}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;第二种主要作用于线翼处，&lt;script type=&quot;math/tex&quot;&gt;l_\nu \propto \gamma = \gamma_6 + \gamma_4 + \gamma_\mathrm{nat}&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;第三种主要影响氢线，&lt;script type=&quot;math/tex&quot;&gt;l_\nu \propto P_\mathrm{e}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;再往高温走，电子散射会比较重要，所以由&lt;script type=&quot;math/tex&quot;&gt;(8.17)&lt;/script&gt;有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa_\nu \approx \kappa_\mathrm{e} = \frac{\alpha(e)P_\mathrm{e}\sum A_j}{P_\mathrm{g}-P_\mathrm{e}}&lt;/script&gt;

&lt;p&gt;此时&lt;script type=&quot;math/tex&quot;&gt;P_\mathrm{g} \approx 2P_\mathrm{e}&lt;/script&gt;，所以&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;独立于&lt;script type=&quot;math/tex&quot;&gt;P_\mathrm{e}&lt;/script&gt;；同时&lt;script type=&quot;math/tex&quot;&gt;l_\nu \propto P_\mathrm{e}^2&lt;/script&gt;（哪来的？）&lt;/p&gt;

&lt;h4 id=&quot;金属丰度&quot;&gt;金属丰度&lt;/h4&gt;

&lt;p&gt;生长曲线。&lt;/p&gt;

&lt;p&gt;简单地来说，我们考虑这么一个图像：连续谱光源在后面，前面是一团冷的气体，厚度为&lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;。&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu = F_c e^{-\tau_\nu} \tag{13.28}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\tau_\nu = \int_0^L l_\nu \rho dx = \int_0^L N \alpha dx = A \int_0^L (N/N_E) N_\mathrm{H} \alpha dx \tag{13.29}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;N&lt;/script&gt;为吸收原子个数，&lt;script type=&quot;math/tex&quot;&gt;N_E&lt;/script&gt;为这种原子的总个数。&lt;/p&gt;

&lt;p&gt;当&lt;script type=&quot;math/tex&quot;&gt;\tau_\nu \ll 1&lt;/script&gt;，即谱线很弱的时候，我们有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu \approx F_c(1-\tau_\nu)&lt;/script&gt;

&lt;p&gt;所以这个时候线深和谱线强都都正比于&lt;script type=&quot;math/tex&quot;&gt;A&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;对于强线来说，我们需要考虑线翼；结论是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;W = (\langle\gamma\rangle Afh)^{1/2} \int_0^\infty (1-e^{-1/u^2})du \tag{13.31}&lt;/script&gt;

&lt;p&gt;这里的生长曲线指的是仅仅改变某个元素的丰度；而如果我们改变整个恒星的金属丰度的话，生长曲线会不一样；这是因为改变整体的丰度会改变电离平衡、连续谱吸收以及碰撞的damping。一个例子如下图：&lt;/p&gt;

&lt;p&gt;&lt;em&gt;图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;对于实际的谱线来说，例子如下：&lt;/p&gt;

&lt;p&gt;&lt;em&gt;图三张&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;最后的碎碎念&quot;&gt;最后的碎碎念&lt;/h3&gt;

&lt;p&gt;LTE和nLTE都有可能出错&lt;/p&gt;

&lt;p&gt;&lt;em&gt;图两张&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;它们都需要致宽；就连生长曲线都会受到致宽的影响（为什么？）&lt;/p&gt;
</description>
        <pubDate>Sun, 07 Oct 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/10/07/OASP13/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/10/07/OASP13/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 12</title>
        <description>&lt;p&gt;手里有数据，心里不慌。上一章讲了谱线的轮廓，那么实际我们怎么去测这个轮廓呢？毕竟测到了才能推出下面几章的东西来，那么就要看看我们是拿什么东西来测量谱线轮廓，以及怎么还原谱线轮廓的了。&lt;/p&gt;

&lt;h3 id=&quot;仪器&quot;&gt;仪器&lt;/h3&gt;

&lt;p&gt;打住。我不是做仪器的，所以这块就不详细说了。要有轮廓肯定需要高色散光谱仪（虽然不同波段的高指的分辨率不一样，大家也都在吹自己的是高色散），光谱仪有分辨率公式&lt;script type=&quot;math/tex&quot;&gt;(3.15)&lt;/script&gt;：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda = - \frac{W'}{f_\mathrm{coll}} \frac{d}{n} \cos{\alpha} \tag{12.1}&lt;/script&gt;

&lt;p&gt;所以要减小&lt;script type=&quot;math/tex&quot;&gt;\Delta \lambda&lt;/script&gt;，提高分辨率，主要就是增大&lt;script type=&quot;math/tex&quot;&gt;f_\mathrm{coll}&lt;/script&gt;或者&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;。所以要不就做得老长老长，要不就把反射光栅搞好，提升可用级数大小。&lt;/p&gt;

&lt;p&gt;第二是每个光谱仪都需要有一个slit viewer，说白了就是导星镜。但是恒星的光都到狭缝里面去了，射到导星镜的光又怎么来呢？实际上是将狭缝的两边变成镜子，然后将狭缝稍微斜过来，就可以反光了。&lt;/p&gt;

&lt;h3 id=&quot;仪器轮廓&quot;&gt;仪器轮廓&lt;/h3&gt;

&lt;p&gt;仪器肯定会对谱线有致宽，这个致宽就叫仪器轮廓。假设我们有一个理想谱线，宽度可以忽略不计，它通过光谱仪之后的形状我们叫做&lt;script type=&quot;math/tex&quot;&gt;I(\lambda)&lt;/script&gt;。令理想光谱为&lt;script type=&quot;math/tex&quot;&gt;F(\lambda)&lt;/script&gt;，那么观测到的光谱&lt;script type=&quot;math/tex&quot;&gt;D(\lambda)&lt;/script&gt;自然是它们俩的卷积：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
  D(\lambda) &amp;= \int_{-\infty}^{\infty} I(\lambda-\lambda_0) F(\lambda_0) d\lambda_0\\
  &amp;= I(\lambda) * F(\lambda) \tag{12.2}
  \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;假设一个仪器轮廓是半高全宽为0.1埃的高斯函数，那么它的傅立叶变换还是一个高斯，只是宽度变为了10埃而已。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;这里有图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;在&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;域里面说话，观测到的光谱的傅立叶变换&lt;script type=&quot;math/tex&quot;&gt;d(\sigma)&lt;/script&gt;就是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;d(\sigma) = i(\sigma) f(\sigma) \tag{12.3}&lt;/script&gt;

&lt;p&gt;这意味着仪器轮廓充当了一个低通滤波器的角色，把高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;的信号滤掉了。从&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;域的角度来说，也就是卷积将光谱模糊/平滑了。这都是第二章的东西。&lt;/p&gt;

&lt;p&gt;这看起来没什么，毕竟这么高分辨率的信号我们也看不到（后面还有采样在）。不过需要留意的一点是仪器轮廓还会改变谱线的深度和宽度。当然这也是显然的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;这里有图&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;复原&quot;&gt;复原&lt;/h3&gt;

&lt;p&gt;&lt;del&gt;说完生光我们就该复圆了。&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;我们想求&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;。这好说，把&lt;script type=&quot;math/tex&quot;&gt;(12.3)&lt;/script&gt;的&lt;script type=&quot;math/tex&quot;&gt;i(\sigma)&lt;/script&gt;除过去不就完了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f(\sigma) = d(\sigma) / i(\sigma) \tag{12.4}&lt;/script&gt;

&lt;p&gt;为了处理不对称的轮廓，我们需要让上式中的三个量都为复数，则有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
  f_\mathrm{R}(\sigma) &amp;= \frac{d_\mathrm{R}(\sigma)i_\mathrm{R}(\sigma) + d_\mathrm{I}(\sigma)i_\mathrm{I}(\sigma)}{i_\mathrm{R}(\sigma)^2 + i_\mathrm{I}(\sigma)^2} \\
  f_\mathrm{I}(\sigma) &amp;= \frac{d_\mathrm{I}(\sigma)i_\mathrm{R}(\sigma) - d_\mathrm{R}(\sigma)i_\mathrm{I}(\sigma)}{i_\mathrm{R}(\sigma)^2 + i_\mathrm{I}(\sigma)^2} \\
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;最后做个逆傅立叶变换就好了。&lt;/p&gt;

&lt;h3 id=&quot;噪声&quot;&gt;噪声&lt;/h3&gt;

&lt;p&gt;问题在于噪声和另外一个东西。令噪声为&lt;script type=&quot;math/tex&quot;&gt;n(\sigma0)&lt;/script&gt;，则有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;d(\sigma) = d_0(\sigma) + n(\sigma) \tag{12.6}&lt;/script&gt;

&lt;p&gt;所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f(\sigma) = \frac{d_0(\sigma)}{i(\sigma)} + \frac{n(\sigma)}{i(\sigma)}&lt;/script&gt;

&lt;p&gt;噪声一般是高频的，而&lt;script type=&quot;math/tex&quot;&gt;i(\sigma)&lt;/script&gt;在高频处很小，所以仪器轮廓会加大噪声。&lt;/p&gt;

&lt;p&gt;&lt;em&gt;这里有图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;那怎么办？这么搞的话光谱毛刺特别多。这个时候我们就要人为加入一个低通滤波器将高频的信号滤掉，反正主要是噪声。&lt;/p&gt;

&lt;p&gt;我们将低通滤波器叫做&lt;script type=&quot;math/tex&quot;&gt;\phi(\sigma)&lt;/script&gt;，那么加入了滤波器的“真实”信号就是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_1(\sigma) = d(\sigma) \phi(\sigma) / i(\sigma) \tag{12.7}&lt;/script&gt;

&lt;p&gt;我们希望&lt;script type=&quot;math/tex&quot;&gt;f_1(\sigma)&lt;/script&gt;与&lt;script type=&quot;math/tex&quot;&gt;f_0(\sigma)&lt;/script&gt;的区别尽量的小，所以我们需要将&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\epsilon = f_0(\sigma) - f_1(\sigma) = f_0(\sigma)[1-\phi(\sigma)] - n(\sigma)\phi(\sigma)/i(\sigma)&lt;/script&gt;

&lt;p&gt;最小化。结论是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\phi = \frac{1}{1+[n(\sigma)/d(\sigma)]^2} \tag{12.9}&lt;/script&gt;

&lt;p&gt;噪声的傅立叶变换大小可以测量出来，令&lt;script type=&quot;math/tex&quot;&gt;% &lt;![CDATA[
B= &lt;n(\sigma)&gt; %]]&gt;&lt;/script&gt;；&lt;script type=&quot;math/tex&quot;&gt;d(\sigma)&lt;/script&gt;可以用一个高斯函数来近似：&lt;script type=&quot;math/tex&quot;&gt;d(\sigma) \approx A 10^{-b_0^2\sigma^2}&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\phi = \frac{1}{1+(B/A)^2 10^{-2b_0^2\sigma^2}} \tag{12.9}&lt;/script&gt;

&lt;p&gt;就安排得明明白白了。&lt;/p&gt;

&lt;p&gt;当然如果仪器轮廓太大或者信噪比太低那神仙都救不了，需要其他办法比如正向建模或者干脆data-driven的办法。&lt;/p&gt;

&lt;p&gt;仪器轮廓会平滑掉一些高频信息，所以当仪器轮廓比较大的时候，采样频率可以适当降低；反之亦然。&lt;/p&gt;

&lt;h4 id=&quot;仪器轮廓的测量&quot;&gt;仪器轮廓的测量&lt;/h4&gt;

&lt;p&gt;可以通过汞灯、激光以及大气吸收线来测量。当仪器轮廓被狭缝宽度主导的时候，它与级数无关；但是最好还是用和恒星曝光时类似的设置来测量。&lt;/p&gt;

&lt;h3 id=&quot;散射光&quot;&gt;散射光&lt;/h3&gt;

&lt;p&gt;略写。主要是因为我们只考虑了仪器轮廓附近的波长范围，如果外面还有光进来的话就归为散射光。散射光主要集中在低&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;部分，抬高了&lt;script type=&quot;math/tex&quot;&gt;i(\sigma)&lt;/script&gt;所以会使得整个光谱被压低，所以散射光越小越好。&lt;/p&gt;

&lt;h3 id=&quot;等值宽度&quot;&gt;等值宽度&lt;/h3&gt;

&lt;p&gt;等值宽度定义为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;W = \int_{-\infty}^{\infty} \frac{F_\mathrm{c}-F_\mathrm{\nu}}{F_\mathrm{c}} \mathrm{d}\nu \tag{12.20}&lt;/script&gt;

&lt;p&gt;但是实际上我们测得的是&lt;script type=&quot;math/tex&quot;&gt;D_\mathrm{\nu} = I(\lambda) * (F_\mathrm{c}-F_\mathrm{\nu})&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;W_\mathrm{m} = \int_{-\lambda_0}^{\lambda_0} \frac{I(\lambda) * (F_\mathrm{c}-F_\mathrm{\nu})}{D_\mathrm{c}} \mathrm{d}\nu \tag{12.20}&lt;/script&gt;

&lt;p&gt;这导致了我们有的时候不能覆盖整条谱线的范围，因为有别的线在；同时一般来说我们会低估&lt;script type=&quot;math/tex&quot;&gt;D_\mathrm{c}&lt;/script&gt;，导致&lt;script type=&quot;math/tex&quot;&gt;W_\mathrm{m}&lt;/script&gt;被高估。&lt;/p&gt;

&lt;h3 id=&quot;谱线测量方法&quot;&gt;谱线测量方法&lt;/h3&gt;

&lt;p&gt;在波长域我们可以测量谱线的半高全宽，以此表征比如自转之类的一些物理量。谱线的位置不对称性可以从谱线的中线看出来。&lt;/p&gt;

&lt;p&gt;在&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;域我们可以方便地测量误差（看高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;的弥散）、将卷积可视化（变成相乘了）等等。&lt;/p&gt;
</description>
        <pubDate>Thu, 14 Jun 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/06/14/OASP12/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/06/14/OASP12/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>日本天文年会相关文件</title>
        <description>&lt;p&gt;作为初级阶段的学生，经常要写各种初级文书。日本人的长处在于把一切都整得井井有条，给你一个excel表格里面不能填的就是不能填；不过当遇上latex这个对非英语语言不怎么友好的东西的时候就很容易抓瞎。这里记录一下日本天文年会相关文件的编译方法，以免（其实免不了）我忘掉。&lt;/p&gt;

&lt;h3 id=&quot;年会报名&quot;&gt;年会报名&lt;/h3&gt;

&lt;p&gt;用英语来进行年会报名其实不难。只要跑到&lt;a href=&quot;http://www.asj.or.jp/nenkai/abs/&quot;&gt;这里&lt;/a&gt;下载package（“パッケージをダウンロードしてご利用ください”里面那个パッケージ的链接），然后按照里面的readme-en.txt的指示做就行了。tex文件的编码方式不用在意，反正里面也没有日语；编译方式好像也没什么要求。记得报名的时候是把&lt;strong&gt;tex文件&lt;/strong&gt;而不是编译好的pdf发到abs2018b@nenkai.asj.or.jp。&lt;/p&gt;

&lt;p&gt;记得在报名前入会，报名之后记得交钱。&lt;/p&gt;

&lt;h3 id=&quot;早川幸男基金&quot;&gt;早川幸男基金&lt;/h3&gt;

&lt;p&gt;这个是最麻烦的，但是给钱。重点在于它不能用平常的命令去编译，而是必须用&lt;code class=&quot;highlighter-rouge&quot;&gt;platex&lt;/code&gt;。如果使用TeXstudio的话需要将设置-命令里面的latex改成&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  platex -src -interaction&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;nonstopmode %.tex
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后在&lt;code class=&quot;highlighter-rouge&quot;&gt;Build-Build &amp;amp; View&lt;/code&gt;里面改成&lt;code class=&quot;highlighter-rouge&quot;&gt;DVI-&amp;gt;PDF Chain&lt;/code&gt;，这样应该就可以了。&lt;/p&gt;

&lt;p&gt;顺便原来的命令是&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  latex  -synctex&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 -interaction&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;nonstopmode %.tex
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;若手&quot;&gt;若手&lt;/h3&gt;

&lt;h3 id=&quot;reference&quot;&gt;Reference&lt;/h3&gt;

&lt;p&gt;http://www.asj.or.jp/nenkai/abs/&lt;/p&gt;
</description>
        <pubDate>Sun, 03 Jun 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/06/03/latex-asj/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/06/03/latex-asj/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 11</title>
        <description>&lt;p&gt;看了这么久从这一章开始才是正餐。&lt;/p&gt;

&lt;p&gt;谱线的强度和形状都是我们很关心的东西，因为它们可以同时受多个物理量影响；相反连续谱的形状基本上只是有效温度的函数。谱线吸收系数就决定了这条谱线位于什么波长、将会有什么形状。&lt;/p&gt;

&lt;p&gt;这一章我们基本上讨论三种谱线致宽的机制：自然致宽、压强致宽以及热运动致宽。虽然字面上看起来这三个机制只会告诉我们谱线宽了多少，但是实际上我们会推导出谱线吸收系数，也就把能定的都定下来了。从结论上来说前两个致宽是一个洛仑兹轮廓，最后一个是高斯轮廓；然后把它们卷积起来就得到最终的轮廓了。&lt;/p&gt;

&lt;h3 id=&quot;自然致宽&quot;&gt;自然致宽&lt;/h3&gt;

&lt;p&gt;吸收嘛，肯定得有入射光&lt;script type=&quot;math/tex&quot;&gt;E&lt;/script&gt;和吸收光的原子。光作为电磁波有波动方程以及光速的关系：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\partial^2 E}{\partial t^2} = v^2 \frac{\partial^2 E}{\partial x^2}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;v = c\left(\frac{\epsilon_0 \mu_0}{\epsilon \mu}\right)^{1/2}&lt;/script&gt;

&lt;p&gt;而且光可以叠加，为了简单起见只考虑其中的一个成分：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;E = E_0 e^{-2\pi i (x/\lambda-t/P)} = E_0 e^{-2\pi i (x-vt)/\lambda} = E_0 e^{-i\omega (x/v-t)} \tag{11.1}&lt;/script&gt;

&lt;p&gt;我们忽略磁场，就有&lt;script type=&quot;math/tex&quot;&gt;\mu = \mu_0&lt;/script&gt;。但是因为吸收光的原子是一个个电偶极子，所以介电常数发生了变化：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\epsilon}{\epsilon_0} = \frac{E + 4\pi Nqz}{E} = 1 + \frac{4\pi Nqz}{E} \tag{11.2}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;N&lt;/script&gt;为电偶极子数密度、&lt;script type=&quot;math/tex&quot;&gt;q&lt;/script&gt;为电偶极子电量（之后一般会换成&lt;script type=&quot;math/tex&quot;&gt;e&lt;/script&gt;）、&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;为电偶极子长度。把电偶极子看成谐振子(&lt;script type=&quot;math/tex&quot;&gt;\frac{d^2 z}{dt^2}&lt;/script&gt;)，加上驱动力(&lt;script type=&quot;math/tex&quot;&gt;\omega_0^2 z&lt;/script&gt;)和阻尼(&lt;script type=&quot;math/tex&quot;&gt;\gamma \frac{dz}{dt}&lt;/script&gt;)，就有振动方程：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{d^2 z}{dt^2} + \gamma \frac{dz}{dt} + \omega_0^2 z = \frac{e}{m} E_0 e^{i\omega t} \tag{11.3}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;x = 0&lt;/script&gt;时方程有解为&lt;script type=&quot;math/tex&quot;&gt;z = z_0 e^{i\omega t}&lt;/script&gt;，所以&lt;script type=&quot;math/tex&quot;&gt;\dot{z} = i\omega z, \ddot{z} = -\omega^2 z&lt;/script&gt;，方程变为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;-\omega^2 z + \gamma i\omega z + \omega_0^2 z = \frac{e}{m} E_0 e^{i\omega t}&lt;/script&gt;

&lt;p&gt;或者&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;z = \frac{e}{m} \frac{E_0 e^{i\omega t}}{\omega_0^2 - \omega^2 + i\gamma\omega} = \frac{e}{m} \frac{E}{\omega_0^2 - \omega^2 + i\gamma\omega}&lt;/script&gt;

&lt;p&gt;可以看到&lt;script type=&quot;math/tex&quot;&gt;\omega = \omega_0&lt;/script&gt;的时候振幅最大，被称为共振频率，也是谱线所在的地方。将这个结果代回&lt;script type=&quot;math/tex&quot;&gt;(11.2)&lt;/script&gt;，就有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\epsilon}{\epsilon_0} = 1 + \frac{4\pi Ne^2}{m}\frac{1}{\omega_0^2 - \omega^2 + i\gamma\omega} \tag{11.4 }&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\epsilon&lt;/script&gt;很接近&lt;script type=&quot;math/tex&quot;&gt;\epsilon_0&lt;/script&gt;，所以有泰勒展开：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \frac{c}{v} = \left(\frac{\epsilon}{\epsilon_0}\right)^{1/2} &amp;\approx 1 + \frac{1}{2} \frac{4\pi Ne^2}{m}\frac{1}{\omega_0^2 - \omega^2 + i\gamma\omega} \\
&amp;= 1 + \frac{2\pi Ne^2}{m}\left[\frac{\omega_0^2-\omega^2}{(\omega_0^2-\omega^2)^2 + \gamma^2\omega^2} - i\frac{\gamma\omega}{(\omega_0^2-\omega^2)^2 + \gamma^2\omega^2}\right]
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;我们希望将这个量代回&lt;script type=&quot;math/tex&quot;&gt;(11.1)&lt;/script&gt;中间那里，然后求光强；而光强是场强实部的平方，所以可以只考虑上式中的虚部，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I = I_0 e^{-2k\omega x/c} = I_0 e^{-l_\nu \rho x}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;l_\nu \rho = \frac{4\pi Ne^2}{mc} \frac{\gamma\omega^2}{(\omega_0^2-\omega^2)^2 + \gamma^2\omega^2} \tag{11.5}&lt;/script&gt;

&lt;p&gt;考虑到谱线轮廓很小，&lt;script type=&quot;math/tex&quot;&gt;\omega \approx \omega_0&lt;/script&gt;，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\omega_0^2 - \omega^2 = (\omega_0-\omega)(\omega_0+\omega) \approx 2\omega \Delta\omega&lt;/script&gt;

&lt;p&gt;所以&lt;script type=&quot;math/tex&quot;&gt;(11.5)&lt;/script&gt;就变成了&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;l_\nu \rho = \frac{2\pi Ne^2}{mc} \frac{\gamma}{\Delta\omega^2 + (\gamma/2)^2} \tag{11.6}&lt;/script&gt;

&lt;p&gt;这是某个圆频率下单位体积内的总吸收，而如果我们想计算单个原子的吸收的话，有&lt;script type=&quot;math/tex&quot;&gt;l_\nu \rho = N \alpha&lt;/script&gt;，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
  \alpha &amp;= \frac{2\pi e^2}{mc} \frac{\gamma}{\Delta\omega^2 + (\gamma/2)^2} \\
  &amp;= \frac{e^2}{mc} \frac{\gamma/4\pi}{\Delta\nu^2 + (\gamma/4\pi)^2} \\
  &amp;= \frac{e^2}{mc} \frac{\lambda^2}{c} \frac{\gamma\lambda^2/4\pi}{\Delta\lambda^2 + (\gamma\lambda^2/4\pi c)^2} \tag{11.7}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;分别在圆频率、频率和波长下。这就是主要的结果了，也是一个洛仑兹轮廓。不知道的话请看&lt;a href=&quot;https://mingjiejian.github.io/2017/11/11/OASP2/&quot;&gt;第二章&lt;/a&gt;。这个轮廓的宽度由阻尼系数&lt;script type=&quot;math/tex&quot;&gt;\gamma&lt;/script&gt;决定。&lt;/p&gt;

&lt;p&gt;洛仑兹轮廓的积分为&lt;script type=&quot;math/tex&quot;&gt;\pi&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty \alpha d\nu = \int_{-\infty}^\infty \alpha d\Delta\nu = \frac{\pi e^2}{mc} \tag{11.8}&lt;/script&gt;

&lt;p&gt;或者&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty \alpha d\lambda = \frac{\pi e^2}{mc} \frac{\lambda^2}{c} \tag{11.9}&lt;/script&gt;

&lt;p&gt;这个量指的是一个原子每秒每平方弧度（只有一个方向）所吸收的光的比例。实际上的比例比上两式要小，这是因为在推导的过程中我们没有考虑量子力学带来的修正。假设这个修正量为&lt;script type=&quot;math/tex&quot;&gt;f&lt;/script&gt;，上面的积分同时意味着原子发生吸收的概率，也就是&lt;script type=&quot;math/tex&quot;&gt;B_{lu}h\nu (5.17)&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty \alpha d\nu = \frac{\pi e^2}{mc}f = B_{lu}h\nu&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Rightarrow f = \frac{mc}{\pi e^2} B_{lu}h\nu = 7.484 \times 10^{-7} \frac{B_{lu}}{\lambda} \tag{11.11}&lt;/script&gt;

&lt;p&gt;用&lt;script type=&quot;math/tex&quot;&gt;(6.8)&lt;/script&gt;将&lt;script type=&quot;math/tex&quot;&gt;B_{lu}&lt;/script&gt;换成&lt;script type=&quot;math/tex&quot;&gt;A_{lu}&lt;/script&gt;，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f = \frac{mc^3}{2\pi e^2\nu^2} \frac{g_u}{g_l}A_{ul} = 1.884 \times 10^{-15} \lambda^2 \frac{g_u}{g_l} A_{ul} \tag{11.12}&lt;/script&gt;

&lt;p&gt;如果我们只考虑受激辐射的话，可以写出类似的公式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_\mathrm{em} = \frac{mc}{\pi e^2} B_{ul}h\nu&lt;/script&gt;

&lt;p&gt;所以有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;g_u f_\mathrm{em} = g_l f_\mathrm{abs}&lt;/script&gt;

&lt;p&gt;因此很多实际的表格会给出&lt;script type=&quot;math/tex&quot;&gt;gf&lt;/script&gt;而不是单纯的&lt;script type=&quot;math/tex&quot;&gt;f&lt;/script&gt;以避免歧义。多数的&lt;script type=&quot;math/tex&quot;&gt;f&lt;/script&gt;值都是测出来的，不过有些简单的比如氢原子有公式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f = \frac{2^5}{3^{3/2}\pi} \frac{g_\mathrm{bb}}{l^5u^3} \left( \frac{1}{l^2} - \frac{1}{u^2} \right)^{-3}&lt;/script&gt;

&lt;h4 id=&quot;自然致宽的阻尼常数&quot;&gt;自然致宽的阻尼常数&lt;/h4&gt;

&lt;p&gt;知道了自然致宽是一个洛仑兹轮廓之后，只要知道阻尼常数&lt;script type=&quot;math/tex&quot;&gt;\gamma&lt;/script&gt;就可以确定轮廓了。Menzal (1961)给出了阻尼常数的方程：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dW}{dt} = -\frac{2}{3}\frac{e^2\omega^2}{mc^3}W = -\gamma W&lt;/script&gt;

&lt;p&gt;所以可以得出&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\gamma = \frac{2e^2\omega^2}{3mc^3} = \frac{0.22}{\lambda^2}&lt;/script&gt;

&lt;p&gt;当然后面的等号需要&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;的单位为厘米。把&lt;script type=&quot;math/tex&quot;&gt;\gamma&lt;/script&gt;和它的变式放回&lt;script type=&quot;math/tex&quot;&gt;(11.7)&lt;/script&gt;就可以算出不同自变量下的轮廓宽度了。可以看到在&lt;script type=&quot;math/tex&quot;&gt;\Delta \lambda&lt;/script&gt;下，所有谱线的宽度都是一样的，&lt;script type=&quot;math/tex&quot;&gt;0.59\times 10^{-4}&lt;/script&gt;埃。&lt;/p&gt;

&lt;p&gt;同样也需要引入量子力学的修正。一个现象学的方法就是将能级的能量&lt;script type=&quot;math/tex&quot;&gt;W&lt;/script&gt;看作很多个分立的小能级之和，&lt;script type=&quot;math/tex&quot;&gt;W = N_uh\nu&lt;/script&gt;，那么&lt;script type=&quot;math/tex&quot;&gt;(11.13)&lt;/script&gt;可以被写成&lt;script type=&quot;math/tex&quot;&gt;dN_u/dt = -\gamma N_u&lt;/script&gt;。同时能级占据数对时间的导数也是跃迁的概率，所以&lt;script type=&quot;math/tex&quot;&gt;dN_u/dt = -4\pi A_{ul} N_u&lt;/script&gt;。考虑所有可能的跃迁，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\gamma_u = 4\pi \sum_{l&lt;u} A_{ul} %]]&gt;&lt;/script&gt;

&lt;p&gt;这个爱因斯坦系数可以和海森堡不确定原理联系起来。不确定原理告诉我们&lt;script type=&quot;math/tex&quot;&gt;\Delta W_u \Delta t \gtrsim h/2\pi&lt;/script&gt;，而&lt;script type=&quot;math/tex&quot;&gt;\Delta t = 1/\sum 4\pi A_{ul}&lt;/script&gt;，因为&lt;script type=&quot;math/tex&quot;&gt;A_{ul}&lt;/script&gt;代表着1秒内跃迁的概率。所以&lt;script type=&quot;math/tex&quot;&gt;\Delta W_u \gtrsim 2h \sum A_{ul}&lt;/script&gt;，也就是每个能级都有一个宽度。&lt;/p&gt;

&lt;p&gt;那么跃迁总不是一个能级的事情，所以谱线的自然致宽阻尼常数是两个能级的轮廓卷积。从第二章我们知道&lt;script type=&quot;math/tex&quot;&gt;\gamma = \gamma_u + \gamma_l&lt;/script&gt;。如果辐射场很强的话，我们还要考虑受激辐射和吸收的问题：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\gamma_u = 4\pi \sum A_{ul} + 4\pi \sum I_\nu B_{ul} + 4\pi \sum I_\nu B_{uk}&lt;/script&gt;

&lt;p&gt;这样会更全面一点。&lt;/p&gt;

&lt;h3 id=&quot;压力致宽&quot;&gt;压力致宽&lt;/h3&gt;

&lt;p&gt;压力致宽其实挺好理解，原子被别人撞了（在别的粒子附近），能级就变了，会带来谱线移动、不对称性和致宽。因为是在别的粒子附近，所以实际上是粒子的电场使得原子的能级发生变化，一般指的是&lt;a href=&quot;https://en.wikipedia.org/wiki/Stark_effect&quot;&gt;斯塔克效应(Stark effect)&lt;/a&gt;；其实斯塔克效应就是电场下的赛曼效应。同时粒子离原子越近(&lt;script type=&quot;math/tex&quot;&gt;R&lt;/script&gt;越小)，影响(&lt;script type=&quot;math/tex&quot;&gt;\Delta W&lt;/script&gt;)应该就越大；根据这个思想我们可以写出这样的一条式子：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta W = c/R^n \tag{11.16}&lt;/script&gt;

&lt;p&gt;至于&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;是多少，就取决于粒子的种类了；一般的作用如下：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;种类&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;影响的谱线&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;粒子&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;线性斯塔克效应&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氢线&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;光子、电子&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;共振致宽&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;同种原子&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;二次斯塔克效应&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;高温恒星中的多数谱线&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;离子、电子&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;范德瓦尔斯效应&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;低温恒星中的多数谱线&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;中性氢&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;把上面的能级能量变化转为谱线频率的变化，可以得出&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \nu = C_n / R^n \tag{11.17}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;C_n&lt;/script&gt;需要被测出来。&lt;/p&gt;

&lt;h4 id=&quot;简化the-impact-approximation&quot;&gt;简化！(The impact approximation)&lt;/h4&gt;

&lt;p&gt;貌似到这里我们还没能给出谱线轮廓，怎么办？当然是简化了。假设碰撞是绝热的，也就是碰撞不会导致跃迁；同时因为恒星大气比较稀薄，我们认为碰撞的时间远远短于两次碰撞的时间(impact apprximation)。&lt;/p&gt;

&lt;p&gt;我们把一个光子看成一个长为&lt;script type=&quot;math/tex&quot;&gt;W = \Delta t&lt;/script&gt;的方波，那么它的光谱就是&lt;script type=&quot;math/tex&quot;&gt;\mathrm{sinc}^2{\pi\Delta t (\nu - \nu_0)}&lt;/script&gt;，宽度为&lt;script type=&quot;math/tex&quot;&gt;\Delta \nu = 1 / \Delta t&lt;/script&gt;。现在吸收这个光子的原子被另外的粒子影响，而且影响的大小不断在变化，那么我们就将这个光子分成很多小份（小的方波&lt;script type=&quot;math/tex&quot;&gt;\Delta t_j&lt;/script&gt;），每个小份之间的相位在受到碰撞之后不再一样，就需要独立地看待了。当然这个时候小份光的光谱就变宽了(&lt;script type=&quot;math/tex&quot;&gt;\Delta \nu_j = 1 / \Delta t_j&lt;/script&gt;)。&lt;/p&gt;

&lt;p&gt;回到宏观的视角，每一次碰撞的&lt;script type=&quot;math/tex&quot;&gt;\Delta t_j&lt;/script&gt;都是不一样的，那么最后中的谱线宽应该为&lt;script type=&quot;math/tex&quot;&gt;\Delta t_j&lt;/script&gt;对应的sinc函数乘上它的概率再对所有的&lt;script type=&quot;math/tex&quot;&gt;\Delta t_j&lt;/script&gt;积分。通过简单的推理可得&lt;script type=&quot;math/tex&quot;&gt;\Delta t_j&lt;/script&gt;的分布为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;dP(\Delta t_j) = e^{-\Delta t_j/\Delta t_0} d\Delta t_j/\Delta t_0&lt;/script&gt;

&lt;p&gt;其中&lt;script type=&quot;math/tex&quot;&gt;\Delta t_0&lt;/script&gt;是典型的碰撞间隔时间。所以原子吸收系数就是：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\alpha = \int_0^\infty \Delta t^2 \left( \frac{\sin{\pi \Delta t (\nu-\nu_0)}}{\pi \Delta t (\nu-\nu_0)} \right)^2 e^{-\Delta t_j/\Delta t_0} d\Delta t_j/\Delta t_0&lt;/script&gt;

&lt;p&gt;积分的结果（理所当然地）是一个洛仑兹轮廓：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\alpha = \frac{\mathrm{constant}}{4\pi^2(\nu-\nu_0)^2 + (1/\Delta t_0)^2} = \mathrm{constant} \frac{\gamma_n/4\pi}{(\nu-\nu_0)^2 + (\gamma_n/4\pi)^2} \tag{11.19}&lt;/script&gt;

&lt;h4 id=&quot;压力致宽的阻尼系数&quot;&gt;压力致宽的阻尼系数&lt;/h4&gt;

&lt;p&gt;从上面可以看出来&lt;script type=&quot;math/tex&quot;&gt;\gamma_n = 2/\Delta t_0&lt;/script&gt;，那就是要算&lt;script type=&quot;math/tex&quot;&gt;\Delta t_0&lt;/script&gt;了；不过这里我们要绕一个圈子。&lt;/p&gt;

&lt;p&gt;考虑谱线频率的累积变化：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\phi = 2\pi \int_0^\infty \Delta \nu dt = 2\pi \int_0^\infty C_n R^{-n} dt \tag{11.20}&lt;/script&gt;

&lt;p&gt;先只考虑一个粒子，做直线运动，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\phi = 2\pi \int_0^\infty C_n \frac{cos^n{\theta}}{\rho^n} dt&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP11/01-collision-diagram.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;原子受影响的示意图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;换元什么的，&lt;script type=&quot;math/tex&quot;&gt;v = dy/dt = (\rho/\cos{\theta})d\theta/dt, dt = (\rho/v)d\theta/\cos^2{\theta}&lt;/script&gt;，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\phi = \frac{2\pi C_n}{v\rho^{n-1}} \int_{-\pi/2}^{\pi/2} \cos^{n-2}{\theta} d\theta \tag{11.21}&lt;/script&gt;

&lt;p&gt;这个积分在某些&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;的值如下：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;n&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\int_{-\pi/2}^{\pi/2} \cos^{n-2}{\theta} d\theta&lt;/script&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\pi&lt;/script&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;2&lt;/script&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\pi/2&lt;/script&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;4/3&lt;/script&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;3\pi/8&lt;/script&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;我们很随意地确定一个阈值，&lt;script type=&quot;math/tex&quot;&gt;\phi = 1 \mathrm{rad}&lt;/script&gt;，得到一个临界半径：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\rho_0 = \left[ \frac{2\pi C_n}{v} \int_{-\pi/2}^{\pi/2} \cos^{n-2}{\theta} d\theta \right]^{1/(n-1)} \tag{11.22}&lt;/script&gt;

&lt;p&gt;然后我们只考虑那些相位差超过1个弧度，也就是距离小于临界半径的那些碰撞。在&lt;script type=&quot;math/tex&quot;&gt;\Delta t_1&lt;/script&gt;的时间内，这样的碰撞应该有&lt;script type=&quot;math/tex&quot;&gt;\pi \rho_0^2 v N \Delta t_1&lt;/script&gt;次。那么当我们让&lt;script type=&quot;math/tex&quot;&gt;\Delta t_1 = \Delta t_0&lt;/script&gt;时，应该只有1次碰撞。所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\gamma_n = \frac{2}{\Delta t_0} = 2\pi \rho_0^2 v N \tag{11.23}&lt;/script&gt;

&lt;p&gt;上式就剩一个平均相对速率&lt;script type=&quot;math/tex&quot;&gt;v&lt;/script&gt;不知道。其实就是Maxwell-Boltzmann分布的结论：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;v = \left[ \frac{8kT}{\pi} \left( \frac{1}{m_A} + \frac{1}{m_p} \right) \right]^{1/2} \tag{11.24}&lt;/script&gt;

&lt;p&gt;其实&lt;script type=&quot;math/tex&quot;&gt;\gamma_n&lt;/script&gt;更准确的形式可以表示为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\gamma_n = N \int_{-\infty}^\infty vf(v)\sigma_n(v)dv \tag{11.25}&lt;/script&gt;

&lt;h4 id=&quot;两个例子&quot;&gt;两个例子&lt;/h4&gt;

&lt;p&gt;请自行推导，对于二次斯塔克效应以及范德瓦尔斯效应，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\log{\gamma_4} \approx 19 + \frac{2}{3} \log{C_4} + \log{P_\mathrm{e}} - \frac{5}{6} \log{T} \tag{11.27}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\log{\gamma_6} \approx 20 + 0.4 \log{C_6} + \log{P_\mathrm{e}} - 0.7 \log{T} \tag{11.29}&lt;/script&gt;

&lt;p&gt;画出来就像下面这样：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP11/02-damping-const.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Na I D2线的damping constent&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;上面这两条式子在谱线计算里面经常会被用到。当然实际和理论还是有点区别，所以会加一个系数，随时修正。&lt;/p&gt;

&lt;h3 id=&quot;氢线的致宽&quot;&gt;氢线的致宽&lt;/h3&gt;

&lt;p&gt;见过谱线的同学们应该都知道，氢线的致宽和其他线的致宽根本不在一个量级上。这是因为氢线致宽的因素主要是线性斯塔克效应。那么应该怎么去计算氢线的致宽呢？&lt;/p&gt;

&lt;p&gt;与压力致宽的想法类似，我们从下式开始：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda_j = c_j E \tag{11.31}&lt;/script&gt;

&lt;p&gt;最早我们只考虑了一次电离离子的影响(&lt;script type=&quot;math/tex&quot;&gt;E = e/R^2&lt;/script&gt;)，同时因为平方反比下降，我们只考虑距离氢原子最近的那个离子。此时在半径为&lt;script type=&quot;math/tex&quot;&gt;R&lt;/script&gt;的球面上找到最近的离子的概率为不在球内的概率乘上在表面的概率：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P(R)dR = P_N(R)4\pi R^2 N dR \tag{11.32}&lt;/script&gt;

&lt;p&gt;那么再次通过简单的推理得到在半径为&lt;script type=&quot;math/tex&quot;&gt;R&lt;/script&gt;的球内找不到最近的离子的概率为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P_n(R) = P_n(0)e^{-4\pi R^3N/3}&lt;/script&gt;

&lt;p&gt;考虑到&lt;script type=&quot;math/tex&quot;&gt;R = 0, P_n = 1&lt;/script&gt;以及定义&lt;script type=&quot;math/tex&quot;&gt;R_0 = (4\pi N/3)^{-1/3}&lt;/script&gt;，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P_n(R) = e^{-(R/R_0)^3}&lt;/script&gt;

&lt;p&gt;所以&lt;script type=&quot;math/tex&quot;&gt;(11.32)&lt;/script&gt;变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P(R)dR = 3 \frac{R^2}{R_0^3} e^{-(R/R_0)^3} dR&lt;/script&gt;

&lt;p&gt;或者换元成场强&lt;script type=&quot;math/tex&quot;&gt;\beta = E/E_0&lt;/script&gt;的话，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P(\beta)d\beta = \frac{3}{2} \beta^{-5/2} e^{-\beta^{-3/2}} d\beta \tag{11.34}&lt;/script&gt;

&lt;p&gt;就差不多了。当然更准确&lt;script type=&quot;math/tex&quot;&gt;P(\beta)&lt;/script&gt;也是有的，式子&lt;script type=&quot;math/tex&quot;&gt;(11.35)&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;现在轮廓已经有了，然后就是加上量子力学修正（暂时略，还没有很好的理解）。最后画出来就像图11.9一样。当然还有一些没有考虑：电子带来的致宽，在线翼处会很明显；还有其他氢原子带来的致宽，在中低温恒星中比较明显。&lt;/p&gt;

&lt;h3 id=&quot;热运动致宽&quot;&gt;热运动致宽&lt;/h3&gt;

&lt;p&gt;这个就简单了，高中生都知道的东西。多普勒致宽是因为有视向速度&lt;script type=&quot;math/tex&quot;&gt;v_R&lt;/script&gt;：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\Delta\lambda}{\lambda} = \frac{\Delta\nu}{\nu} = \frac{v_R}{c} \tag{11.38}&lt;/script&gt;

&lt;p&gt;由&lt;script type=&quot;math/tex&quot;&gt;(11.1)&lt;/script&gt;有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\mathrm{d}N(v_R)}{N} = \frac{1}{\pi^{1/2}v_0} e^{-(\frac{v_R}{v_0})^2} \mathrm{d}v_R&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;v_0^2 = 2kT/m&lt;/script&gt;，那么就有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda_\mathrm{D} = \frac{v_0}{c}\lambda_0 = \frac{v_0}{c} \left( \frac{2kT}{m} \right) \tag{11.39}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \mu_\mathrm{D} = \frac{v_0}{c}\mu_0 = \frac{v_0}{c} \left( \frac{2kT}{m} \right) \tag{11.40}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\mathrm{d}N(\Delta\lambda)}{N} = \frac{1}{\pi^{1/2}\lambda_\mathrm{D}} e^{-(\frac{\Delta\lambda}{\lambda_\mathrm{D}})^2} \mathrm{d}\Delta\lambda \tag{11.41}&lt;/script&gt;

&lt;p&gt;转成能量就有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\alpha d\lambda = \frac{\pi^{1/2}e^2}{mc} f \frac{\lambda_0^2}{c} \frac{1}{\Delta\lambda_\mathrm{D}} e^{-(\frac{\Delta\lambda}{\lambda_\mathrm{D}})^2} d\lambda \tag{11.42}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\alpha d\nu = \frac{\pi^{1/2}e^2}{mc} f \frac{1}{\Delta\nu_\mathrm{D}} e^{-(\frac{\Delta\mu}{\nu_\mathrm{D}})^2} d\nu \tag{11.43}&lt;/script&gt;

&lt;p&gt;显然是个高斯轮廓。&lt;/p&gt;

&lt;h3 id=&quot;microturbulence&quot;&gt;Microturbulence&lt;/h3&gt;

&lt;p&gt;这东西我一直不知道怎么翻译比较好。这个东西指的是小尺度上的质量运动（谁的？），可以用宽度为&lt;script type=&quot;math/tex&quot;&gt;\xi&lt;/script&gt;的高斯分布描述。具体会在第17章讨论。&lt;/p&gt;

&lt;h3 id=&quot;将轮廓合起来&quot;&gt;将轮廓合起来&lt;/h3&gt;

&lt;p&gt;这也好说，卷卷卷卷卷积起来就好了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\alpha(\mathrm{total}) = \alpha(\mathrm{natural}) * \alpha(\mathrm{Stark}) * \alpha(\mathrm{v.d. Waals}) * \alpha(\mathrm{thermal}) * \alpha(\mathrm{micro}) \tag{11.44}&lt;/script&gt;

&lt;p&gt;前三个是一个宽为&lt;script type=&quot;math/tex&quot;&gt;\gamma = \gamma_\mathrm{natural} + \gamma_4 + \gamma_6&lt;/script&gt;的洛仑兹轮廓，后面两个的宽度是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda_\mathrm{D} = \frac{\lambda_0}{c} \left( \frac{2kT}{m} + \xi^2 \right) \tag{11.45}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \nu_\mathrm{D} = \frac{\nu_0}{c} \left( \frac{2kT}{m} + \xi^2 \right) \tag{11.45}&lt;/script&gt;

&lt;p&gt;最终&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
  \alpha &amp;= \frac{\pi e^2}{mc} f \frac{\gamma/4\pi^2}{\Delta\nu^2 + (\gamma/4\pi)^2} * \frac{1}{\pi^{1/2} \Delta\nu_\mathrm{D}} e^{-(\frac{\Delta\nu}{\nu_\mathrm{D}})^2} \\
  &amp;= \frac{\pi^{1/2}e^2}{mc} \frac{f}{\Delta\nu_\mathrm{D}}H(u,a) \\
  &amp;= \frac{\pi^{1/2}e^2}{mc} \frac{\lambda_0^2 f}{\Delta\lambda_\mathrm{D}}H(u,a) \tag{11.46}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;其中&lt;script type=&quot;math/tex&quot;&gt;H(u,a)&lt;/script&gt;为Hjerting函数，自变量为&lt;script type=&quot;math/tex&quot;&gt;u = \Delta\nu/\Delta\nu_\mathrm{D} = \Delta\lambda/\Delta\lambda_\mathrm{D}&lt;/script&gt;，和&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
  a &amp;= \frac{\gamma}{4\pi} \frac{1}{\Delta\nu_\mathrm{D}} \\
  &amp;= \frac{\gamma}{4\pi} \frac{\lambda_0^2}{c} \frac{1}{\Delta\lambda_\mathrm{D}} \tag{11.47}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;当&lt;script type=&quot;math/tex&quot;&gt;a = 0&lt;/script&gt;时，Hjerting函数就变回高斯了。我们也可以用Voigt函数来表示Hjerting函数，&lt;script type=&quot;math/tex&quot;&gt;V(u,a) = H(u,a)/(\pi^{1/2}\Delta\nu_\mathrm{D}&lt;/script&gt;)。&lt;/p&gt;

&lt;p&gt;氢线的话，也是&lt;script type=&quot;math/tex&quot;&gt;(11.35)&lt;/script&gt;乘上Hjerting函数。&lt;/p&gt;

&lt;h3 id=&quot;差不多就是这样&quot;&gt;差不多就是这样&lt;/h3&gt;

&lt;p&gt;有些再多的就用到再来总结。&lt;/p&gt;
</description>
        <pubDate>Wed, 16 May 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/05/16/OASP11/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/05/16/OASP11/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 10</title>
        <description>&lt;p&gt;又是比较简单的一章。而且因为连续谱一般和流量的绝对定标有关，我平常其实用得不多。&lt;/p&gt;

&lt;p&gt;连续谱的确定主要能匹配出有效温度来，如果细节多一些的话&lt;script type=&quot;math/tex&quot;&gt;\log{g}&lt;/script&gt;也可以确定。至于金属丰度就有点困难了，虽然也是有办法的。那么为了一次性地得到比较宽的光谱范围（毕竟高分辨率光谱需要更长的曝光时间，以及不同级数之间的流量定标相当麻烦），这里所说的连续谱的分辨率一般在10到15埃左右。在得到目标星光谱之后一般会有如下的流程：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;比较目标星和标准星光谱&lt;/li&gt;
  &lt;li&gt;校准标准星光谱的形状&lt;/li&gt;
  &lt;li&gt;校准标准星某一个/某几个波长上的绝对流量&lt;/li&gt;
  &lt;li&gt;考虑谱线对目标星连续谱的影响&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;虽然书上是这么写，但是我觉得更好的顺序是2314，因为当考虑连续谱的绝对流量的时候没有校准好的标准星当然做不下去。&lt;/p&gt;

&lt;h3 id=&quot;光谱仪&quot;&gt;光谱仪&lt;/h3&gt;

&lt;p&gt;图片请参考&lt;a href=&quot;https://mingjiejian.github.io/2017/12/18/OASP3/&quot;&gt;第三章&lt;/a&gt;的图1。顺便从那里的&lt;script type=&quot;math/tex&quot;&gt;(3.15)&lt;/script&gt;可以得到&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda = -\cos{\alpha} \frac{W'd}{f_\mathrm{coll}n}&lt;/script&gt;

&lt;p&gt;因为分辨率不高，所以为了增加进光量一般会把狭缝开到比恒星的像更大。这个时候狭缝宽度将被星像的线宽度&lt;script type=&quot;math/tex&quot;&gt;\Delta \phi F_\mathrm{eff}&lt;/script&gt;代替：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda = -\cos{\alpha} \frac{F_\mathrm{eff}d}{f_\mathrm{coll}n}\Delta \phi \tag{10.1}&lt;/script&gt;

&lt;p&gt;由上式可以看到视宁度会影响光谱仪的分辨率，不过可以通过减小&lt;script type=&quot;math/tex&quot;&gt;\frac{F_\mathrm{eff}}{f_\mathrm{coll}}&lt;/script&gt;来减小视宁度浮动的影响。&lt;/p&gt;

&lt;h3 id=&quot;大气消光&quot;&gt;大气消光&lt;/h3&gt;

&lt;p&gt;当我们观测目标星和标准星的地平高度（或者说天顶距）不一样的时候，我们需要考虑大气消光的影响。当如下的情况：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;平面平行层假设成立以及大气稳定&lt;/li&gt;
  &lt;li&gt;标准星不是变星&lt;/li&gt;
  &lt;li&gt;测得的有效波长不是天顶距的函数&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;成立时，就有最简单的流量与天顶距的关系：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu = F_\nu^0 e^{\tau_\nu \sec{Z}}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;F_\nu^0&lt;/script&gt;是大气层外的流量，&lt;script type=&quot;math/tex&quot;&gt;\tau_\nu&lt;/script&gt;是恒星在天顶时大气层的光深。取个导数再把标准星加上：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\log{\frac{F_\nu(2)}{F_\nu{(1)}}} = \log{\frac{F_\nu^0(2)}{F_\nu^0{(1)}}} - \tau_\nu \log{e(\sec{Z_2}-\sec{Z_1})} \tag{10.3}&lt;/script&gt;

&lt;p&gt;当然天顶距越接近肯定越好，这也是高分辨率光谱在做天光改正的时候需要地平高度尽量相近的标准星的原因。假设的第3点不成立的情况一般是大气消光对某个波段的短波/长波影响比较大，导致了天顶距小的时候所有光都透了过来，天顶距大了之后就只能看见长波的光了。当然在相对较高的分辨率下（小于50埃），这个问题基本不需要考虑。&lt;/p&gt;

&lt;h3 id=&quot;标准星的校准&quot;&gt;标准星的校准&lt;/h3&gt;

&lt;p&gt;标准星在不同波段的流量先相对于5556埃校准，然后我们再校准5556埃的绝对流量。标准星一般是织女星或者太阳。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://s3.amazonaws.com/aasie/images/1538-3881/146/3/68/aj481013f4_hr.jpg&quot; alt=&quot;&quot; /&gt;
织女星的光谱&lt;/p&gt;

&lt;p&gt;上面的其实已经不只是连续谱，而是高分辨率光谱了。以前的低分辨率光谱在大于8500埃那里会有很大的弥散，就是因为Pashen线系的存在。&lt;/p&gt;

&lt;p&gt;要多说几句的是这种图横纵轴的单位是比较容易混淆的。光谱的话，我们关心的是每个波长/频率上的&lt;strong&gt;流量&lt;/strong&gt;是多少，所以&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;要和&lt;script type=&quot;math/tex&quot;&gt;F_\lambda&lt;/script&gt;对应，&lt;script type=&quot;math/tex&quot;&gt;\nu&lt;/script&gt;要和&lt;script type=&quot;math/tex&quot;&gt;F_\nu&lt;/script&gt;对应。而SED的话，则是每个波长/频率上的&lt;strong&gt;能量&lt;/strong&gt;是多少，所以纵轴要相应地变为&lt;script type=&quot;math/tex&quot;&gt;\lambda F_\lambda&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;\nu F_\nu&lt;/script&gt;。取&lt;script type=&quot;math/tex&quot;&gt;\log{}&lt;/script&gt;之后可以把流量/能量比较低的部分的差异放大，但是单位就没有了。&lt;/p&gt;

&lt;h3 id=&quot;其他的校准和杂七杂八的东西&quot;&gt;其他的校准和杂七杂八的东西&lt;/h3&gt;

&lt;p&gt;谱线带来的吸收可以用模型或者高分辨率光谱来改正。有的时候为了确定一些物理量，我们会比较关注连续谱的斜率以及氢线系的线系限，但是光学的Balmer线系限除了有跳跃之外还有非常多的Balmer线，模糊了线系限左右的流量。所以有必要的话需要增加紫外/红外的观测。&lt;/p&gt;

&lt;p&gt;校准好之后将光谱和模型比较就可以得到恒星参数了。&lt;/p&gt;

&lt;h3 id=&quot;热星等&quot;&gt;热星等&lt;/h3&gt;

&lt;p&gt;略。&lt;/p&gt;
</description>
        <pubDate>Fri, 11 May 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/05/11/OASP10/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/05/11/OASP10/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>Deep Learning笔记3</title>
        <description>&lt;p&gt;这么多改进的方式，究竟要用哪个？&lt;/p&gt;

&lt;h2 id=&quot;正交化&quot;&gt;正交化&lt;/h2&gt;

&lt;p&gt;我们希望某个/些参数只影响某些结果。我们有训练样本、发展样本、测试样本、真实数据上的结果。最好就是存在某些参数可以分别改变网络在它们上的表现。&lt;/p&gt;

&lt;h3 id=&quot;single-number-evaluation-metric&quot;&gt;Single Number evaluation metric&lt;/h3&gt;

&lt;p&gt;找一个可以方便比较的数字。&lt;/p&gt;

&lt;p&gt;精确度和完整性：Harmonic average.&lt;/p&gt;

&lt;h3 id=&quot;复杂目标&quot;&gt;复杂目标&lt;/h3&gt;

&lt;p&gt;optimizing：数字越小/大越好；satisficing：够小就行了&lt;/p&gt;

&lt;p&gt;一般选一个作为optimizing，其他作为optimizing。&lt;/p&gt;

&lt;p&gt;而且实际上的模型好坏还包含别的东西，比如会不会推荐小黄片什么的。或者换一个模型或者评判的函数。&lt;/p&gt;
</description>
        <pubDate>Fri, 20 Apr 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/04/20/DL-3/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/04/20/DL-3/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>Deep Learning笔记2</title>
        <description>&lt;h4 id=&quot;数据集&quot;&gt;数据集&lt;/h4&gt;

&lt;p&gt;以前是分成两个的，训练和测试。现在分成3个，训练、发展和测试集。用发展去测试训练，最后再用测试去测试表现；甚至没有测试集都行。这里的区别是发展集是用来overfitting的，测试集不是。&lt;/p&gt;

&lt;p&gt;要注意不同数据集的数据要同质，质量相同&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;bias和variance&quot;&gt;bias和variance&lt;/h4&gt;

&lt;p&gt;训练集的错误率比与预期的高：高bias；发展集的错误率比训练集的高：高variance&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;正则化&quot;&gt;正则化&lt;/h4&gt;

&lt;p&gt;在代价函数后面加上&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;的2或者1范数&lt;/p&gt;

&lt;p&gt;通过强制减小&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;简化神经网络，减小权重。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;dropout正则化&quot;&gt;Dropout正则化&lt;/h4&gt;

&lt;p&gt;随机删掉一些节点来做一次正反向传递，然后不断重复。要注意的是删掉之后要把整个节点的值除以一个删掉的阈值概率，把取值回覆到正常水平。测试集不要用。Dropoyt的意思是不让某个节点依赖于某几个前面一层的节点，所以也是减小权重的意思。不同的层可以有不同的dropout节点数。输入层一般不dropout（或者是很小的duopout数）。最后在看J减小的时候要小心一点，必要的时候关掉dropout&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;奇技淫巧&quot;&gt;奇技淫巧&lt;/h4&gt;

&lt;p&gt;增加训练样本：把图像翻过来/旋转/放大，或者几种加起来。不过信息量其实还是一样的。标准是人脑还是会把它当成同一样东西。&lt;/p&gt;

&lt;p&gt;提早停止：看发展集的误差，以它的最小值为基准。思路是&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;会随着迭代而不断增大，导致太大以至于我们不想看到。提早停止可以防止这个。&lt;/p&gt;

&lt;p&gt;正交化：将减小损失函数和防止overfit分开。提早停止违反了这个原则。&lt;/p&gt;

&lt;p&gt;L2正则化比较简单，不过要试各种的&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;。&lt;/p&gt;

&lt;h3 id=&quot;建立最优化问题&quot;&gt;建立最优化问题&lt;/h3&gt;

&lt;h4 id=&quot;归一化训练集&quot;&gt;归一化训练集&lt;/h4&gt;

&lt;p&gt;看图，把输入数字移到0左右，将标准差scale到1。注意训练集和测试集的移动和scale需要完全一样。&lt;/p&gt;

&lt;p&gt;这么做的理由：将代价函数搞得好看一点，简单一点，学习速率也能快一点。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;奇怪的导数值&quot;&gt;奇怪的导数值&lt;/h4&gt;

&lt;p&gt;在训练很深的神经网络的时候，有的时候导数值可能会很大或者很小，比如矩阵遇到了指数增长/减小什么的。&lt;/p&gt;

&lt;p&gt;一个治标的办法是选择初始的权重。&lt;script type=&quot;math/tex&quot;&gt;z = w_1x_1 + w_2x_2 + \cdots + w_nx_n&lt;/script&gt;。&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;越大，&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;就越大，所以我们控制&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;的标准差为&lt;script type=&quot;math/tex&quot;&gt;\sqrt{\frac{2}{n^{[l-1]}}}&lt;/script&gt;。这里的2是Relu函数带来的。当然也可以当它是一个超参数来试。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;导数值检查&quot;&gt;导数值检查&lt;/h4&gt;

&lt;p&gt;往左和往右挪，计算&lt;script type=&quot;math/tex&quot;&gt;\frac{y}{x}&lt;/script&gt;。愣算就行。&lt;/p&gt;

&lt;p&gt;具体：将所有的参数竖着排成一个巨长的向量，包括正向的和反向的。然后愣算其中某个参数的导数，看两个向量之间的二范数比各自的二范数的大小。比值是拿来看相对大小的，防止它们本来就很小或者大。&lt;/p&gt;

&lt;p&gt;检查只能用在debug上。如果出错了，看具体的值哪个不正常。如果有的话，记得加上正则化项。检查不能用在dropout上，要用的话先关掉。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-2/1-10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;加速&quot;&gt;加速&lt;/h3&gt;

&lt;h4 id=&quot;切成小块&quot;&gt;切成小块&lt;/h4&gt;

&lt;p&gt;每次只处理1000个训练样本，然后循环。基本上都得用。计算1000个之后就马上更新参数。当然也可以见到1个，不过随机性就很强；这也被叫做随机梯度下降。随机梯度下降相当于没有向量化，所以很慢，而且很多噪音。&lt;/p&gt;

&lt;p&gt;但是怎么选小块的大小？当整体训练样本小的时候，当然应该整个一起搞；如果大的话，可以用2的某次方来做（可能快一点），或者和CPU/GPU匹配的大小。试呗。&lt;/p&gt;

&lt;h4 id=&quot;不用梯度下降&quot;&gt;不用梯度下降&lt;/h4&gt;

&lt;h5 id=&quot;指数平均&quot;&gt;指数平均&lt;/h5&gt;
&lt;p&gt;其实就是滑动平均的一种，只不过前后的数据不平权。&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;v_t = \beta v_{t-1} + (1-\beta)\theta_t&lt;/script&gt;

&lt;p&gt;它会将之前的数据累积起来，但是不断乘上&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;。大概相当于前&lt;script type=&quot;math/tex&quot;&gt;\frac{1}{1-\beta}&lt;/script&gt;天的温度平均：&lt;script type=&quot;math/tex&quot;&gt;v_t = \sum_{i=0}^n 0.1 \times 0.9^i \theta_i&lt;/script&gt;。&lt;/p&gt;

&lt;h5 id=&quot;bias-correction&quot;&gt;Bias Correction&lt;/h5&gt;

&lt;p&gt;更准确的计算。因为上式从0开始，所以一开始的时候肯定是不对的。当然一般数据量大的话可以不管，反正可以等。或者除一个&lt;script type=&quot;math/tex&quot;&gt;(1-\beta^t)&lt;/script&gt;。&lt;/p&gt;

&lt;h5 id=&quot;gradient-descent-with-momentum&quot;&gt;Gradient descent with momentum&lt;/h5&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
 v_{dW} &amp;= \beta v_{dW} + (1-\beta) dW \\
 v_{db} &amp;= \beta v_{db} + (1-\beta) db \\
 W &amp;= W - \alpha v_{dW} \\
 b &amp;= b - \alpha v_{db} \\
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;这样做的好处是它会在摆动的方向将摆动平均掉，在正确的方向保留导数值，所以可以加速收敛。一般&lt;script type=&quot;math/tex&quot;&gt;\beta = 0.9&lt;/script&gt;是个不错的选择。&lt;/p&gt;

&lt;h5 id=&quot;rmsprop&quot;&gt;RMSprop&lt;/h5&gt;

&lt;p&gt;另一种方式的加速。看图。&lt;/p&gt;

&lt;h5 id=&quot;adam&quot;&gt;Adam&lt;/h5&gt;

&lt;p&gt;合在一起。看图。&lt;/p&gt;

&lt;h4 id=&quot;降低学习速率&quot;&gt;降低学习速率&lt;/h4&gt;

&lt;p&gt;可以手动降低，乘上一个线性增大的分母，或者是e指数减小&lt;/p&gt;

&lt;h3 id=&quot;避免局部极小&quot;&gt;避免局部极小&lt;/h3&gt;

&lt;p&gt;很多导数为0的点实际上是鞍点，因为参数非常多。不过在那附近会转悠好久，比较慢。&lt;/p&gt;

&lt;h2 id=&quot;调超参&quot;&gt;调超参&lt;/h2&gt;

&lt;h3 id=&quot;要调的东西&quot;&gt;要调的东西&lt;/h3&gt;

&lt;p&gt;学习速率&lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;；动量项&lt;script type=&quot;math/tex&quot;&gt;\beta / (\beta_1=0.9, \beta_2=0.999, \epsilon=10^{-8})&lt;/script&gt;、多少节点、mini-batch大小；多少隐层、学习速率变化。&lt;/p&gt;

&lt;p&gt;但是调超参的时候不要用网格，随即就好；因为超参数量太多了，而且不同的超参对模型影响不同，所以随机会给所有的超参更多选择。最初的参数空间可能比较大，都跑一次之后可以缩小参数空间再做一次。随机的时候，对于某些超参，也可以不用平均随机，而是用其他的概率分布，或者log scale，量级上平均就行。或者说在模型对超参变化更剧烈的时候放更多的点。&lt;/p&gt;

&lt;h3 id=&quot;训练中&quot;&gt;训练中&lt;/h3&gt;

&lt;p&gt;训练中可以不断调整超参什么的。或者同时训练很多个模型，有钱有资源的话。&lt;/p&gt;

&lt;h3 id=&quot;让模型更稳健&quot;&gt;让模型更稳健&lt;/h3&gt;

&lt;p&gt;逻辑回归的时候将输入归一化可以让代价函数更规则，那么在神经网络里面也可以这么做，对&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;归一化。可以将&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;的平均值和标准差倒过来，或者自己设定一组数，或者让网络自己学习去。&lt;script type=&quot;math/tex&quot;&gt;b&lt;/script&gt;也可以不要了，因为归一化的时候带上了常数。&lt;/p&gt;

&lt;p&gt;其他具体流程和普通的差不多。它防止了隐层的值的分布距离原点太远。它会带来一些噪声。&lt;/p&gt;

&lt;p&gt;在测试集的时候，我们可以用指数平均的方法记录训练集的平均值和scatter，然后当成测试集的均值以及&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;。&lt;/p&gt;

&lt;h2 id=&quot;多项选择题&quot;&gt;多项选择题&lt;/h2&gt;

&lt;p&gt;Softmax回归。在最后一层隐层的地方将节点数和分类数相等，让每一个节点表示属于每一类的概率。sigmod函数会变成softmax函数，对这节点的值进行e指数，归一化。因为e指数会将值之间的差异扩大，所以可以进行分类。如果只有两类的话，softmax会退化回逻辑回归。&lt;/p&gt;

&lt;p&gt;损失函数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;L(y, \hat{y}) = -\sum y_j \ln{\hat{y_j}}&lt;/script&gt;

&lt;p&gt;只留下正确的那一项，然后最大化它的概率。&lt;/p&gt;

&lt;p&gt;代价函数：还是损失函数的平均。&lt;/p&gt;

&lt;p&gt;反向传递：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;dz^{[l]} = \hat{y} - y&lt;/script&gt;

&lt;p&gt;但是在用框架的时候，只要正向传递对了，反向传递交给框架就行。&lt;/p&gt;

&lt;h2 id=&quot;机器学习框架&quot;&gt;机器学习框架&lt;/h2&gt;

&lt;p&gt;易用、快速、开源（特别是长期开源）&lt;/p&gt;
</description>
        <pubDate>Wed, 14 Mar 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/03/14/DL-2/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/03/14/DL-2/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>Deep Learning笔记1</title>
        <description>&lt;h3 id=&quot;逻辑回归&quot;&gt;逻辑回归&lt;/h3&gt;

&lt;h4 id=&quot;binary-classification&quot;&gt;Binary Classification&lt;/h4&gt;

&lt;p&gt;Binary Classification指的是输入一堆东西，最后给出一个只有两个结果（0或者1）的输出的分类过程。一个典型而符合惯例的例子是判断某张图片上有没有猫，也就是将图片的红绿蓝像素值矩阵作为输入，是猫(1)以及不是猫(0)作为输出。&lt;/p&gt;

&lt;p&gt;在这里我们不考虑这么多细节，直接将红绿蓝的像素排成一列，作为输入&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;。&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;的大小就是总的像素数&lt;script type=&quot;math/tex&quot;&gt;n_x&lt;/script&gt;或者&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;如果按照位置来排呢？&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/1-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;需要在开始之前明确一些记号。&lt;/p&gt;

&lt;p&gt;我们在寻找解的时候的输入为&lt;script type=&quot;math/tex&quot;&gt;(x, y)&lt;/script&gt;，当然就是&lt;script type=&quot;math/tex&quot;&gt;(图片, 是否猫)&lt;/script&gt;的组合了。其中&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;是一个&lt;script type=&quot;math/tex&quot;&gt;n_x&lt;/script&gt;行的&lt;strong&gt;列向量&lt;/strong&gt;，即&lt;script type=&quot;math/tex&quot;&gt;x \in \mathbb{R}^{n_x}&lt;/script&gt;；而&lt;script type=&quot;math/tex&quot;&gt;y \in \{0, 1\}&lt;/script&gt;。当然这只是一个样本，而我们一般会有很多的&lt;strong&gt;训练样本&lt;/strong&gt;(training set)：&lt;script type=&quot;math/tex&quot;&gt;\{ (x^{(1)}, y^{(1)}), (x^{(2)}, y^{(2)}), ..., (x^{(m)}, y^{(m)}) \}&lt;/script&gt;。&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;即为训练样本的数量；当我们需要明确的时候我们会把训练样本数和&lt;strong&gt;检验样本&lt;/strong&gt;(test set)数写成&lt;script type=&quot;math/tex&quot;&gt;m_\mathrm{train}, m_\mathrm{test}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;这么写当然比较麻烦，所以我们有矩阵写法。首先将所有的&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;排成一行，就成了一个&lt;script type=&quot;math/tex&quot;&gt;n_x&lt;/script&gt;行&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;列的矩阵&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{X}&lt;/script&gt;。数学语言表达就是&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{X} \in \mathbb{R}^{n_x\times m}&lt;/script&gt;，python表达就是&lt;code class=&quot;highlighter-rouge&quot;&gt;X.shape = (nx, m)&lt;/code&gt;。把&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{X}&lt;/script&gt;转置也不是不行，不过会比较麻烦，就不用了。&lt;/p&gt;

&lt;p&gt;相应的所有的label也这么排，就成了一个一行&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;列的“矩阵”&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{Y} = [y^{(1)}, y^{(2)}, ..., y^{(m)}]&lt;/script&gt;；或者说&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{Y} \in \mathbb{R}^{1\times m}&lt;/script&gt;，&lt;code class=&quot;highlighter-rouge&quot;&gt;Y.shape = (1, m)&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;更多的记号可参阅课程给的pdf。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/1-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;逻辑回归-1&quot;&gt;逻辑回归&lt;/h4&gt;

&lt;p&gt;实际上逻辑回归是在二项分布之下的一个概念，是实现二项分布的一个方法。我们需要的是在上面的定义下，构造一个盒子，接收输入&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;, 并输出在输入&lt;script type=&quot;math/tex&quot;&gt;\mathbf{x}&lt;/script&gt;的情况下二项分布结果为1的概率&lt;script type=&quot;math/tex&quot;&gt;\hat{y} = P(y=1 \lvert \boldsymbol{x})&lt;/script&gt;。然后我们有相应的参数&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{w} \in \mathbb{R}^{n_x}, b \in \mathbb{R}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;构造输出&lt;script type=&quot;math/tex&quot;&gt;\hat{y}&lt;/script&gt;的第一反应应该是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\hat{y} = \boldsymbol{w}^\mathrm{T} \boldsymbol{x} + b&lt;/script&gt;

&lt;p&gt;这其实就是普通的线性回归。但是我们要求&lt;script type=&quot;math/tex&quot;&gt;\hat{y}&lt;/script&gt;是一个概率，取值在0到1之间，而线性回归不仅不能保证结果小于1还会出现负的结果，当然是不对的。&lt;/p&gt;

&lt;p&gt;那怎么办？很简单，给线性回归的结果套一个值域在0到1之间的函数不就行了呗。这种函数一般都跟&lt;script type=&quot;math/tex&quot;&gt;e&lt;/script&gt;指数有关，所以我们有sigmod函数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\sigma(z) = \frac{1}{1+e^{-z}}&lt;/script&gt;

&lt;p&gt;图像请看截图的左下角。&lt;/p&gt;

&lt;p&gt;有了sigmod函数之后，只要令&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\hat{y} = \sigma(\boldsymbol{w}^\mathrm{T} \boldsymbol{x} + b)&lt;/script&gt;

&lt;p&gt;就行了。加上了sigmod函数之后的回归就叫逻辑回归。有的方法把&lt;script type=&quot;math/tex&quot;&gt;b&lt;/script&gt;也放进&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{w}&lt;/script&gt;里面，不过这里不这么做。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/1-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;代价损失函数&quot;&gt;代价/损失函数&lt;/h4&gt;

&lt;p&gt;代价/损失函数就是用来训练上面提到的&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{w}, b&lt;/script&gt;的。这个函数越小，模型的效果越好（对于训练样本来说）。这里定义的损失函数只是对于一个训练样本来说的，而代价函数是对于整个训练样本集在某一堆参数下的评价。&lt;/p&gt;

&lt;p&gt;学过线性拟合的同学们马上又该反应过来，一个典型的代价函数就是&lt;script type=&quot;math/tex&quot;&gt;L(\hat{y}, y) = (\hat{y} - y)^2&lt;/script&gt;。但是这个函数的效果并不好，所以我们实际上用的是这个：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;L(\hat{y}, y) = -[y \ln{\hat{y}} + (1-y) \ln{(1-\hat{y})}]&lt;/script&gt;

&lt;p&gt;大致地说为什么代价函数的样子是这样的原因是，差值的平方会导致函数非凸，但是上面的定义加上sigmod函数会使得&lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;是个凸函数，没有局部极值。&lt;/p&gt;

&lt;p&gt;对应的代价函数我们选择这个：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
J(\boldsymbol{w}, b) &amp;= \frac{1}{m} \sum_{i=1}^{m} L(\hat{y}^{(i)}, y^{(i)}) \\
 &amp;= - \frac{1}{m} \sum_{i=1}^{m} [y \ln{\hat{y}} + (1-y) \ln{(1-\hat{y})}]
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;只要找到最小化&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{w}, b&lt;/script&gt;的&lt;script type=&quot;math/tex&quot;&gt;J&lt;/script&gt;，就行了。实际上逻辑回归就是一个小型的（可能还是最简单的）神经网络。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/1-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;如何训练参数&quot;&gt;如何训练参数？&lt;/h4&gt;

&lt;p&gt;最小化&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{w}, b&lt;/script&gt;就是在&lt;script type=&quot;math/tex&quot;&gt;J(\boldsymbol{w}, b)&lt;/script&gt;这个表面上（简单来说）迭代地找到这个函数的最小值以及对应的参数。又该反应过来我们需要用到导数来指导我们向哪里走了。具体来说，是计算这个：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
\boldsymbol{w} &amp;:= \boldsymbol{w} - \alpha \frac{\partial J}{\partial \boldsymbol{w}}\\
b &amp;:= b - \alpha \frac{\partial J}{\partial b}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;被称为学习速率，是人选的；而后面的俩偏导数是需要计算的，在python中会被命名为&lt;code class=&quot;highlighter-rouge&quot;&gt;dw, db&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/1-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;正反向传递&quot;&gt;正反向传递&lt;/h4&gt;

&lt;p&gt;具体请看截图。正向传递的意思是从具体参数计算代价函数值的过程（蓝色、从左到右），而反向传递指的是计算导数的过程（红色、从右到左）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/1-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;导数的具体计算&quot;&gt;导数的具体计算&lt;/h4&gt;

&lt;p&gt;我们举一个简单的例子：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
z &amp;= w_1 x_1 + w_2 x_2 + b \\
\hat{y} &amp;= \sigma(z) \\
L(\hat{y}, y) &amp;= -[y \ln{\hat{y}} + (1-y) \ln{(1-\hat{y})}] \\
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;自然地&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
\frac{dL}{d\hat{y}} &amp;= -\frac{y}{\hat{y}} + \frac{1-y}{1-\hat{y}} \\
\frac{d\hat{y}}{dz} &amp;= \hat{y} (1-\hat{y}) = \sigma (1-\sigma) = \hat{y} - y \\
\frac{dz}{dw_1} &amp;= x_1 \frac{d\hat{y}}{dz} \\
\frac{dz}{dw_2} &amp;= x_2 \frac{d\hat{y}}{dz} \\
\frac{dz}{db} &amp;= \frac{d\hat{y}}{dz} \\
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;在代码中我们基本上会用导数的分母作为变量名字。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/1-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;之后我们需要算的就是代价函数了。其实也没什么，就拿一个变量做代表吧：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\partial J}{\partial w_1} = \frac{1}{m} \sum_{i=1}^{m} \frac{L^{(i)}}{\partial w_1}&lt;/script&gt;

&lt;p&gt;具体的计算过程就是一个正向+反向传递的过程：&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 设置初值&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dw1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Forward propagation&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigmod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Backward propagation&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dw1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dw1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;w1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dw1&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;然后继续迭代。所以“正常”情况下要用两个循环嵌套，显然是不现实的，所以要用到python的向量来做。&lt;/p&gt;

&lt;h4 id=&quot;向量化&quot;&gt;向量化&lt;/h4&gt;

&lt;p&gt;当&lt;code class=&quot;highlighter-rouge&quot;&gt;w&lt;/code&gt;是一个列向量的时候，比如要算&lt;code class=&quot;highlighter-rouge&quot;&gt;z[i] = w.T * x[i] + b&lt;/code&gt;的时候，可以这么做：&lt;code class=&quot;highlighter-rouge&quot;&gt;np.dot(w,x)+b&lt;/code&gt;。高级一点的话直接和矩阵相乘：&lt;code class=&quot;highlighter-rouge&quot;&gt;np.dot(w,X)+b&lt;/code&gt;。
&lt;code class=&quot;highlighter-rouge&quot;&gt;dz[i] = a[i] - y[i]&lt;/code&gt;可以转为&lt;code class=&quot;highlighter-rouge&quot;&gt;dZ = A - Y&lt;/code&gt;；&lt;code class=&quot;highlighter-rouge&quot;&gt;dw1 += x1[i]dz[i]&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;dW = 1/m * X*dZ.T&lt;/code&gt;；&lt;code class=&quot;highlighter-rouge&quot;&gt;db += dz[i]&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;1/m * np.sum(dZ)&lt;/code&gt;。还要注意的一点是在&lt;code class=&quot;highlighter-rouge&quot;&gt;reshape&lt;/code&gt;的时候最好把行列都写全。&lt;/p&gt;

&lt;h3 id=&quot;浅神经网络&quot;&gt;浅神经网络&lt;/h3&gt;

&lt;p&gt;[1],[2]代表神经网络的层数；(i)代表某一个训练样本（都是上标）。下标不带任何括号，表示某一层中的第几个节点。当有两层的时候，刚开始的输入是&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;，但是之后的输入会变成了&lt;script type=&quot;math/tex&quot;&gt;a^{[i]}&lt;/script&gt;这样。&lt;/p&gt;

&lt;h4 id=&quot;神经网络的命名&quot;&gt;神经网络的命名&lt;/h4&gt;

&lt;p&gt;输入层、隐层、输出层。&lt;script type=&quot;math/tex&quot;&gt;a^{[0]} = x&lt;/script&gt;。在数层数的时候，不算输入层。每一层都有一套&lt;script type=&quot;math/tex&quot;&gt;w, b&lt;/script&gt;配套。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;每一个节点都有两步：线性回归以及丢进sigmod函数里面。所以都有两条公式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
  z_1^{[1]} &amp;= w_1^{[1]T}x + b_1^{[1]}, a_1^{[1]} = \sigma(z_1^{[1]}) \\
  z_2^{[1]} &amp;= w_2^{[1]T}x + b_2^{[1]}, a_2^{[1]} = \sigma(z_2^{[1]}) \\
  z_3^{[1]} &amp;= w_3^{[1]T}x + b_3^{[1]}, a_3^{[1]} = \sigma(z_3^{[1]}) \\
  z_4^{[1]} &amp;= w_4^{[1]T}x + b_4^{[1]}, a_4^{[1]} = \sigma(z_4^{[1]}) \\
  \vdots
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;能看到这些式子排得很整齐，那何不矩阵化了呢？&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;z^{[1]} =
  \begin{bmatrix}
    z_1^{[1]} \\ z_2^{[1]} \\ z_3^{[1]} \\ z_4^{[1]}
  \end{bmatrix}
  =
  \begin{bmatrix}
    \cdots w_1^{[1]T} \cdots \\ \cdots w_2^{[1]T} \cdots \\ \cdots w_3^{[1]T} \cdots \\ \cdots w_4^{[1]T} \cdots
  \end{bmatrix}
  \begin{bmatrix}
    x_1 \\ x_2 \\ x_3
  \end{bmatrix}
  +
  \begin{bmatrix}
    b_1^{[1]} \\ b_2^{[1]} \\ b_3^{[1]} \\ b_4^{[1]}
  \end{bmatrix}
  = W^{[1]} x + b^{[1]}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;W^{[i]}&lt;/script&gt;是一个&lt;script type=&quot;math/tex&quot;&gt;n^{[i]}&lt;/script&gt;（本层节点数）行&lt;script type=&quot;math/tex&quot;&gt;n^{[i-1]}&lt;/script&gt;（上层节点数）列的矩阵，也就是负责将上层节点的结果转成本层节点的结果。&lt;script type=&quot;math/tex&quot;&gt;b^{[i]}&lt;/script&gt;自然是&lt;script type=&quot;math/tex&quot;&gt;n^{[i]}&lt;/script&gt;行1列的向量了。最后再将结果各自丢进sigmod函数里面，不说了。&lt;/p&gt;

&lt;p&gt;如果写出个通式的话也行：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
   z^{[i]} &amp;=  W^{[i]} a^{[i-1]} + b^{[i]} \\
   a^{[i]} &amp;= \sigma(z^{[i]})
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;不过注意&lt;script type=&quot;math/tex&quot;&gt;a^{[0]}&lt;/script&gt;就是输入值，没有放入sigmod函数里面。同时矩阵&lt;script type=&quot;math/tex&quot;&gt;W^{[i]}&lt;/script&gt;是一个“行矩阵”，每一行是每一个节点的系数的转置&lt;script type=&quot;math/tex&quot;&gt;[\cdots w_i^{[1]T} \cdots]&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;对于整个训练样本&quot;&gt;对于整个训练样本&lt;/h4&gt;

&lt;p&gt;当然可以继续矩阵化啦。把整个训练样本的列向量&lt;script type=&quot;math/tex&quot;&gt;x,b&lt;/script&gt;排成一行（这也是惟一的排法了），结果&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;也这么做，然后大写，就变成了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
Z^{[1]} &amp;=
  \begin{bmatrix}
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
    z^{[1](1)} &amp; z^{[1](2)} &amp; \cdots &amp; z^{[1](m)} \\
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    \cdots w_1^{[1]T} \cdots \\ \cdots w_2^{[1]T} \cdots \\ \vdots \\ \cdots w_{[i]}^{[1]T} \cdots
  \end{bmatrix}
  \begin{bmatrix}
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
    x^{(1)} &amp; x^{(2)} &amp; \cdots &amp; x^{(m)} \\
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
  \end{bmatrix}
  +
  \begin{bmatrix}
    \vdots \\ b^{[1]} \\ \vdots \\
  \end{bmatrix} \\
  &amp;= W^{[1]} X + b^{[1]}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;或者对于某一层来说&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
Z^{[i]} &amp;=
  \begin{bmatrix}
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
    z^{[i](1)} &amp; z^{[i](2)} &amp; \cdots &amp; z^{[i](m)} \\
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    \cdots w_1^{[i]T} \cdots \\ \cdots w_2^{[i]T} \cdots \\ \vdots \\ \cdots w_{[i]}^{[i]T} \cdots
  \end{bmatrix}
  \begin{bmatrix}
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
    a^{[i](1)} &amp; a^{[i](2)} &amp; \cdots &amp; a^{[i](m)} \\
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
  \end{bmatrix}
  +
  \begin{bmatrix}
    \vdots \\ b^{[i]} \\ \vdots \\
  \end{bmatrix} \\
  &amp;= W^{[i]} X + b^{[i]}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;总结一下，&lt;script type=&quot;math/tex&quot;&gt;Z^{[i]}&lt;/script&gt;是一个&lt;script type=&quot;math/tex&quot;&gt;n^{[i]}&lt;/script&gt;行&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;列的矩阵，&lt;script type=&quot;math/tex&quot;&gt;W^{[i]}&lt;/script&gt;是一个&lt;script type=&quot;math/tex&quot;&gt;n^{[i]}&lt;/script&gt;行&lt;script type=&quot;math/tex&quot;&gt;n^{[i-1]}&lt;/script&gt;列的矩阵，&lt;script type=&quot;math/tex&quot;&gt;A^{[i]}&lt;/script&gt;是一个&lt;script type=&quot;math/tex&quot;&gt;n^{[i]}&lt;/script&gt;行&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;列的矩阵，&lt;script type=&quot;math/tex&quot;&gt;b^{[i]}&lt;/script&gt;本来应该也是一个&lt;script type=&quot;math/tex&quot;&gt;[i]&lt;/script&gt;行&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;列的矩阵（每列都是一样），但是在python里面，同行数的向量和矩阵相加时，向量会被自动展成相应的矩阵，所以也就不用写成大写的&lt;script type=&quot;math/tex&quot;&gt;B^{[i]}&lt;/script&gt;了。可以留意的是向量/矩阵的偏导数和它自己有相同的形状。&lt;/p&gt;

&lt;p&gt;通式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
   Z^{[i]} &amp;=  W^{[i]} A^{[i-1]} + b^{[i]} \\
   A^{[i]} &amp;= \sigma(Z^{[i]})
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;不同的activation-function&quot;&gt;不同的activation function&lt;/h4&gt;

&lt;p&gt;sigmod函数的问题是它恒为正，所以算出来的结果不会关于0对称。所以隐藏层一般用&lt;script type=&quot;math/tex&quot;&gt;\tanh(z)&lt;/script&gt;而不是sigmod，但是输出层还是用回sigmod。&lt;/p&gt;

&lt;p&gt;但是&lt;script type=&quot;math/tex&quot;&gt;\tanh(z)&lt;/script&gt;也还是有问题：当&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;很大的时候，斜率很小，所以会降低学习速率；所以也可以用RelU函数（折线），或者将RelU小于0的折线再改小一点。即使斜率为0实际上也还是可以的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;为什么activation-function不是线性的&quot;&gt;为什么activation function不是线性的？&lt;/h4&gt;

&lt;p&gt;也就是说为什么要给它套上一个奇怪的函数？&lt;/p&gt;

&lt;p&gt;线性的AF意味着从头到脚都是线性的，也就没有意义（人又不是线性思考的233）。例外是在回归里面，当输出不在0到1之间的时候，最后一层可以用线性的。但是其他层还是要用非线性的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;af的导数&quot;&gt;AF的导数&lt;/h4&gt;

&lt;p&gt;求就是了，又不是不会。按照链式反应（chain rule啦）来求就行了。按照之前的结论其实&lt;script type=&quot;math/tex&quot;&gt;\frac{dL}{da^{[2]}}&lt;/script&gt;不用求，有&lt;script type=&quot;math/tex&quot;&gt;\frac{dL}{dz^{[2]}} = a^{[2]} - y&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;完全向量化之后出现的&lt;script type=&quot;math/tex&quot;&gt;\frac{1}{m}&lt;/script&gt;以及求和是因为之前对某一个训练样本来说，只能计算损失函数；但是对于整个训练样本集来说，我们计算的是代价函数，而&lt;script type=&quot;math/tex&quot;&gt;J = \frac{1}{m}\sum L&lt;/script&gt;，所以多了点东西。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;随机初值&quot;&gt;随机初值&lt;/h4&gt;

&lt;p&gt;参数全为0的话，所有的节点都是一样（对称）的，就没用了。所以要随机取值。一般会将&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;取为很小的高斯随机数，但是&lt;script type=&quot;math/tex&quot;&gt;b&lt;/script&gt;没所谓。很小的高斯随机数是为了取到比较大的导数值，防止落到导数很靠近0的地方。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/2-11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;深神经网络&quot;&gt;深神经网络&lt;/h3&gt;

&lt;p&gt;多层的神经网络和2层的其实是一样的，只不过多了一堆循环而已。&lt;/p&gt;

&lt;h4 id=&quot;为什么要用深的神经网络&quot;&gt;为什么要用深的神经网络？&lt;/h4&gt;

&lt;p&gt;层数从小到大：简单元素 -&amp;gt; 复杂元素。所以我们需要比较多层，但是每层里面的节点不一定多。&lt;/p&gt;

&lt;p&gt;比单层的好用&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/3-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;正向传递&quot;&gt;正向传递&lt;/h4&gt;

&lt;p&gt;计算不同层数的时候可以用循环。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/3-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;反向传递&quot;&gt;反向传递&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/3-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;具体做法&quot;&gt;具体做法&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-DL-1/3-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;因为反向传递的时候有一个&lt;script type=&quot;math/tex&quot;&gt;g'^{[l]}(z^{[l]})&lt;/script&gt;，所以在正向传递的时候要将&lt;script type=&quot;math/tex&quot;&gt;z^{[l]}&lt;/script&gt;记录下来。&lt;/p&gt;

&lt;h4 id=&quot;参数和超参数&quot;&gt;参数和超参数&lt;/h4&gt;

&lt;p&gt;超参数：人为指定的参数&lt;/p&gt;

&lt;p&gt;看超参数和&lt;script type=&quot;math/tex&quot;&gt;J&lt;/script&gt;的关系（选多少的时候最小），是一个经验方法。最佳的超参数集可能会随着时间变化（电脑更新了）&lt;/p&gt;

&lt;p&gt;这次的笔记本还演示了如何载入另外一个笔记本的函数。&lt;/p&gt;
</description>
        <pubDate>Wed, 14 Mar 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/03/14/DL-1/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/03/14/DL-1/</guid>
        
        <category>learning</category>
        
        
      </item>
    
  </channel>
</rss>
