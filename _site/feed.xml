<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mingjie's Blog</title>
    <description>Write everything, think everything.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 23 Oct 2019 17:25:16 +0900</pubDate>
    <lastBuildDate>Wed, 23 Oct 2019 17:25:16 +0900</lastBuildDate>
    <generator>Jekyll v3.8.6</generator>
    
      <item>
        <title>PANDORA说明书</title>
        <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#section-9背景谱线不透明度&quot; id=&quot;markdown-toc-section-9背景谱线不透明度&quot;&gt;Section 9：背景谱线不透明度&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#section-18合成频率表&quot; id=&quot;markdown-toc-section-18合成频率表&quot;&gt;Section 18：合成频率表&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-9背景谱线不透明度&quot;&gt;Section 9：背景谱线不透明度&lt;/h2&gt;

&lt;p&gt;PANDORA在计算谱线源函数的时候需要知道bakcground opacity，或者说是background continuum。这应该指的是OASP中的连续吸收系数。这一节主要讲的是连续吸收系数中其他谱线的贡献以及计算方式。&lt;/p&gt;

&lt;p&gt;如果是同种元素的谱线，那么PANDORA中的”blended line”机制可以搞定；对于其他的谱线，一般PANDORA会考虑H，He-II，CO的谱线（可以在输出的ATMOSPHERE中进行确认）。&lt;/p&gt;

&lt;h2 id=&quot;section-18合成频率表&quot;&gt;Section 18：合成频率表&lt;/h2&gt;

&lt;p&gt;这其实就是合成光谱的频率点；PANDORA有内置的一个表，或者通过指定某些频率，我们可以控制合成光谱的采样点分布。这对于一些宽线（比如CaII H&amp;amp;K）有用。
&lt;code class=&quot;highlighter-rouge&quot;&gt;XISYM&lt;/code&gt;（长度为&lt;code class=&quot;highlighter-rouge&quot;&gt;KS&lt;/code&gt;）指定一个通用的轮廓，对所有线都生效；&lt;code class=&quot;highlighter-rouge&quot;&gt;XIBLU&lt;/code&gt;（长度&lt;code class=&quot;highlighter-rouge&quot;&gt;KB&lt;/code&gt;）指定蓝半边，&lt;/p&gt;
</description>
        <pubDate>Mon, 21 Oct 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/10/21/pandora-manual/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/10/21/pandora-manual/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>我所知道的关于系外行星红外氦线的一切</title>
        <description>&lt;p&gt;Salz+18：对HD189733在系外行星transit过程中的观测&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;1个木星质量的行星围绕着活跃的K dwarf&lt;/li&gt;
  &lt;li&gt;行星的信号遮挡可能不足以解释全部的吸收变化&lt;/li&gt;
  &lt;li&gt;中心线:蓝线线深比是2.8，和恒星大气模型不符；从这一点里面我们可以推断出行星大气的厚度以及柱密度&lt;/li&gt;
  &lt;li&gt;transit前后的信号（虽然这个星没有）可以表征行星的蒸发&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Points：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;因为He线在恒星表面是不均匀的，没有大气时行星挡住了吸收弱的部分的时候，总体吸收增强；反之变弱。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Questions：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;中心线:蓝线线深比有一个标准值吗？&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Tue, 01 Oct 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/10/01/he-exop-paper/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/10/01/he-exop-paper/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>我所知道的关于红外氦线的一切</title>
        <description>&lt;p&gt;直接上表格。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;论文&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;内容&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;结论&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;要点&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;我可以做的&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Zirin 1982&lt;br /&gt;底片&lt;br /&gt;0.8A&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 用&lt;strong&gt;底片&lt;/strong&gt;测量了455颗恒星（包括月亮）的氦线等值宽度(EW)以及半高全宽&lt;br /&gt;2. 有很多星有不止一次测量&lt;br /&gt; 3. 给出了表格&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. EW与软X射线辐射有正相关&lt;br /&gt;2. 周期短的双星EW稍微大一点&lt;br /&gt;3. O-A星EW很小&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 选源可能会偏向活跃的星&lt;br /&gt;2. 小于100mA的测量可能不准&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;不要了&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith 1983&lt;br /&gt;用Zirin 1982的数据&lt;br /&gt;无表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;比较了EW和X射线光度的相关性&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 矮星没有相关性，但是巨星有&lt;br /&gt;2. 巨星中的谱线形成EUV光子主导，矮星和碰撞激发评分秋色&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 形成机制：1)PR、2)CE、3)激发态He原子的向下扩散&lt;br /&gt;2. 耀斑和纤维状结构中一般为发射线&lt;br /&gt;3. 简介中提及了He线的形成位置&lt;br /&gt;4. Zirin 1982中的EW-X射线光度关系不好可能是因为将dwarf和giant混在一起了&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf的EW整体比giant大吗？这个问题可以确定形成机制&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;O’Brian+1986&lt;br /&gt;R=27000-54000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 测量了60颗F-K巨星的氦线&lt;br /&gt;2. 有很多星有不止一次测量&lt;br /&gt; 3. 给出了表格&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. EW结果和Zirin 1982的相似&lt;br /&gt;2. supergiant的谱线有时序变化&lt;br /&gt;3. CDL和两个线左右的恒星氢线表现不同&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 紫外发射线可以确定色球层模型&lt;br /&gt;2. 是在早上观测的(?)&lt;br /&gt;3. 列出了氦线附近的其他谱线特征，特别提到了10829.27的CaI线和10831.3的未知谱线&lt;br /&gt;4. K巨星的吸收很弱，Zirin 1982观测不到；有一部分的谱线形状改变很小（bet Gem type，短周期内），另一部分有很快的变化&lt;br /&gt;5. Zirin 1982小于100mA的不可用&lt;br /&gt; 6. spg的EW变化应该是由物质抛射引起的&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 我们观测到了氦线左边和右边的线，要确定左边的是不是氦线，右边的究竟是什么；计算EW的时候要考虑它们&lt;br /&gt;2. 这里面有bet Dra的光谱！和我们观测的一致但是没有解释&lt;br /&gt;3. 可以做He线的时序观测（已有光谱）&lt;br /&gt;4. 他们认为bet Gem type只在early K，这和我们的观测符合吗？&lt;br /&gt;5. 在我们的HR图上画coronal dividing line和另外的两条线（都有引用的）&lt;br /&gt;6. 回答P15、P16的两个问题&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Zarro+1986&lt;br /&gt;R=10000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;EW与X射线光度的关系&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. dwarf温度大于6000K的没有关系（可能是CE机制主导），小于的有关系（PR机制）&lt;br /&gt;2. giant和spg与Smith 1983一致，认为是PR主导&lt;br /&gt;3. PR机制导致线性关系，但是找到的是指数关系&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. dwarf 6000K对应着对流区由浅（高温）到深（低温）&lt;br /&gt;2. 线性和指数的关系可能是因为局部大气活动（可能可以用来做活动区大小的指示）&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;我们也做个这个吧&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Lambart 1987&lt;br /&gt;和O’Brian+1986设置一样&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;19个F-M星的氦线观测&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 和O’Brian+1986关于CDL的结论一致&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 模型EW太大的问题可以通过减少色球层高温部分来解决&lt;br /&gt;2. giant的变化应为活动区域的变化，spg的是物质抛射&lt;br /&gt;3. 对bet Dra有更多的描述，但是还是没有原因&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Dupree+1992&lt;br /&gt;R=18500&lt;br /&gt;无表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;在球状星团中通过氦线发现了一个星风速度很快的星&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氦线延展到了Si线处，意味着和物质的逃逸速度差不多&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;给出了一些色球层线的形成区域&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;这个结论可以仅仅通过He线的最短波长来确定么？&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Avrett+1994&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;色球层模型的事情，略&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Sasselov+1994&lt;br /&gt;R=28000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;造父变星中的He线&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. He线基本上是蓝移&lt;br /&gt;2. 速度移动比光球层星慢(phase lag)，幅度比光球层线大&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;造父变星一直都有光球层&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Sasselov+1994&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;造父变星中He线的形成&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 造父变星有一些好处：phase lag提供了谱线形成的位置；可以看看温度变化给He线造成的影响&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;比较Fig. 2和我们的PANDORA结果；模型部分值得细看&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Rueddi+1995&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;磁场的，略&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Andretta+1997&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;太阳光球层模型和He线&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;证明了主要是CE机制&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith+2004&lt;br /&gt;R=23600&lt;br /&gt;无表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;10个贫金属星的He导出的星风速度&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;有两个星风速度大于星团逃逸速度&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;T&amp;gt;4600, Mv&amp;gt;-1.5才有He线的吸收&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 我们可以证明或证伪这个要点&lt;br /&gt;2. 我们可以找他要这个表吗？&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Sanz-Forcada+2008&lt;br /&gt;R=170000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;He线和短波辐射的关系&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;RSCVn没有关系，giants有关系&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;短波数据来自Extreme Ultraviolet Explorer (MAST Archive)，X射线数据来自ROSAT all sky survey&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;从里面找短波数据；和Einstein data bank比哪个好？&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Dupree+2009&lt;br /&gt;R=23600&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;EW和各种恒星参数的关系（41颗贫金属场星giant）&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;很多星有快速的outflow&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;T&amp;gt;4500, Mv&amp;gt;-1.5才有He线的吸收&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;可以把这个数据库和我们的合在一起&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Dupree+2011&lt;br /&gt;R=50000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;12颗Omega Cen里面类似的恒星的EW和恒星参数的关系&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. profile算是bet Gem profile&lt;br /&gt;2. 它们分成了两拨，暗示可能是He enhance造成的&lt;br /&gt;3. 作者认为H alpha和Ca线弱所以vairation小&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;将它们和CDL作对比看看是不是稳定的&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Pasquini+2011&lt;br /&gt;无表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;对NGC2808两颗giant的详细模型模拟&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;其他色球层线很相似并且稳定，但是He线很不同&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 这俩星在CDL之下&lt;br /&gt;2. 这俩星的有效温度远低于4500K&lt;br /&gt;3. 作者认为它们的He线是PR主导的&lt;br /&gt;4. T&amp;gt;9000K的区域对He线的轮廓没有影响&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;要点4存疑，要看citation&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Takeda+2011&lt;br /&gt;R=20000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;33颗贫金属矮星的EW&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;绝大多数都有吸收，和金属丰度无关&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. 有短波辐射的来源（应该也是ROSAT）&lt;br /&gt;2. 因为是贫金属星所以自转不快，自转带来的活动性不强&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;看看EW和自转的关系是什么样子的&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith+2012&lt;br /&gt;R=25000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;23颗贫金属矮星的EW&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;绝大多数都有吸收，都不强&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Dupree+2013&lt;br /&gt;来自Dupree+2011&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;两颗有具体Y值的Omega Cen giants&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;重要但是很熟悉了&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith+2013&lt;br /&gt;R=23600&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;M13中7颗巨星的EW等&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;没有发现和Na丰度的关系&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;要细读，但是可能是因为有效温度太低了&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Navarrete+2015&lt;br /&gt;R=65000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Kapteyn Group中14颗恒星的EW&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;EW分布和Omega Cen不一样&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Strader+2015&lt;br /&gt;R=50000&lt;br /&gt;有表&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;M4中的16颗giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;没有找到和Na丰度有好的关系&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;T&amp;gt;4450才有He线的吸收&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;还没细看&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith 2016&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;基于以前的EW数据和活动性指标做对比&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1. Zarro+1986的误差在30mA&lt;br /&gt;2. 有很多的高能数据来源&lt;br /&gt;3. 对关系有比较详细的解读，有结果之后可以再来看&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;延长图2的观测到更高的Lx处，以及看看高温恒星的scatter&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;古代数据库&quot;&gt;古代数据库&lt;/h2&gt;

&lt;p&gt;Zirin 1982&lt;/p&gt;

&lt;h2 id=&quot;现代数据库&quot;&gt;现代数据库&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;名称&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;恒星类型&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;EW测量方法&lt;/th&gt;
      &lt;th&gt;数据表格&lt;/th&gt;
      &lt;th&gt;备注&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;O’Brian+1986&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;F-K giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;没讲，数据质量flag中有blend，猜测是直接积分&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Zarro+1986&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf, giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;by planimetry，猜测为积分&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt;dwarf部分归于Smith 2016&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Lambart 1987&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;没讲&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Sasselov+1994&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Cepheid&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;猜测为直接积分，作者认为telluric弱所以不用减去telluric&lt;/td&gt;
      &lt;td&gt;无&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Sanz-Forcada+2008&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;RSCVn, giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;直接积分然后减去blend的gaussian拟合&lt;/td&gt;
      &lt;td&gt;有，已入总表&lt;/td&gt;
      &lt;td&gt;dwarf部分归于Smith 2016&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Dupree+2009&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;IRAF splot然后测量；如果blend了就去除&lt;/td&gt;
      &lt;td&gt;有，已入总表&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Dupree+2011&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;没说，猜测同上&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Takeda+2011&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;用Gaussian去拟合He线&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt;归于Smith 2016&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith+2012&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;无blend则直接积分，有blend则分开所有成分&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt;归于Smith 2016&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith+2013&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;同 上，并且都给了表&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Navarrete+2015&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf, giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;splot以及deblend&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Strader+2015&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;splot&lt;/td&gt;
      &lt;td&gt;已入总表&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smith 2016&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td&gt;数据来自Zarro+1986, Sanz-Forcada+2008, Takeda+2011, Smith+2012&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;KOV sample&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf, giant, spg&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;APO sample&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;dwarf, giant&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;它们测量EW的方法可以直接比较吗？&lt;/p&gt;

&lt;h2 id=&quot;large-to-do-points&quot;&gt;Large To Do points&lt;/h2&gt;
&lt;p&gt;再后面的也没细看&lt;/p&gt;

&lt;p&gt;O’Brian+1986的分析很详细，而且有模型的构建过程，需要另开位置仔细阅读。&lt;/p&gt;

&lt;p&gt;星震学和He线的相关性&lt;/p&gt;

&lt;p&gt;这些恒星和Gaia的交叉&lt;/p&gt;
</description>
        <pubDate>Mon, 16 Sep 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/09/16/he-paper/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/09/16/he-paper/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>谱线是在哪里形成的？</title>
        <description>&lt;p&gt;题图Credit：Kravchenko+2018.&lt;/p&gt;

&lt;p&gt;谱线是在哪里形成的？搜了一些看了一些论文之后这个问题变成了谱线究竟是在哪里形成的？&lt;/p&gt;

&lt;p&gt;其实这不是一个很复杂的问题，不过不同人有不同的解决方式，所以哪种是最好的，以及在什么情况下适用是需要总结一下的。看完这篇之后很多论文就不用看了。&lt;/p&gt;

&lt;h2 id=&quot;我们要解决什么问题&quot;&gt;我们要解决什么问题？&lt;/h2&gt;

&lt;p&gt;这不是废话嘛，谱线在哪里形成的。那么这个问题应该如何放入在我们的恒星大气模型中呢？又回到干啥都能拿出来讲的这张图了：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-num-RT/01-rt-process.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;啊你看左边来的星光在中间被吸收和散射然后往右边射出，在这个过程中光的总量发生了变化，不就产生了吸收了么。所以将左边入射的星光看作外部光源、中间的管子看作恒星大气、右边出射的光看作我们观测到的光，那么谱线就是在这根管子里形成的。当然啦并不是管子的每一处都会形成谱线的，靠近内部的一侧（左侧）温度很高，这里辐射和吸收达到平衡，所以没有谱线形成（吃多少吐多少当然没有光强变化）；外部一侧（右侧）密度太低，吸收光的原子就很少了，自然也不属于谱线形成的区域。&lt;/p&gt;

&lt;p&gt;澄清以及延伸：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;星光怎么是外部光源：这里的模型是恒星的连续谱是从一个内部的球面发出来的，然后打到球面外面的大气层里面；这个模型肯定不怎么准确（并且不同的波长上连续谱的位置也不一样），但是理解来说够用了。&lt;/li&gt;
  &lt;li&gt;管子一定处于恒星大气中吗：不一定。最极端的例子是telluric线，它的连续谱是恒星，但是吸收（也就是形成）的区域是在地球大气上，一个天一个地。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;所以要解决这个问题，我们要找到一个东西，它以恒星大气的位置坐标（高度或者光深）为自变量，它的值代表着在这个地方上对某个量的贡献是多少。这其实就是找到一个对光深的积分，积分之后的值就是我们的目标参数。这就好办了。&lt;/p&gt;

&lt;h2 id=&quot;光强的贡献函数&quot;&gt;光强的贡献函数&lt;/h2&gt;

&lt;p&gt;正巧，我们在解辐射转移方程的时候有过这个东西。参考&lt;a href=&quot;https://mingjiejian.github.io/2017/12/27/OASP7/&quot;&gt;OASP7&lt;/a&gt;，我们有辐射转移方程:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dI_\nu}{d\tau_\nu} = -I_\nu + S_\nu&lt;/script&gt;

&lt;p&gt;以及&lt;script type=&quot;math/tex&quot;&gt;(7.8)&lt;/script&gt;&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu(0) = \int_0^{\infty} S_\nu e^{-\frac{\tau_\nu}{\mu}} \frac{d\tau_\nu}{\mu}&lt;/script&gt;

&lt;p&gt;这就可以了，&lt;script type=&quot;math/tex&quot;&gt;(7.8)&lt;/script&gt;是符合我们上一节对贡献函数的要求的，所以它在积分号和&lt;script type=&quot;math/tex&quot;&gt;d\tau_\nu&lt;/script&gt;之间的东西就是贡献函数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;C_I = \frac{1}{\mu} S_\nu e^{-\frac{\tau_\nu}{\mu}}&lt;/script&gt;

&lt;p&gt;它代表的是在&lt;script type=&quot;math/tex&quot;&gt;\tau_\nu&lt;/script&gt;处的辐射对光强的贡献；其实也很好理解，因为源函数就是发射相对于吸收的归一化量，在&lt;script type=&quot;math/tex&quot;&gt;\tau_\nu&lt;/script&gt;处的发射往外跑的时候被吸收，到最后打了个&lt;script type=&quot;math/tex&quot;&gt;\frac{1}{\mu} e^{-\frac{\tau_\nu}{\mu}}&lt;/script&gt;的折扣，就完了。&lt;/p&gt;

&lt;p&gt;再稍微强调一下，贡献函数的形式就和&lt;script type=&quot;math/tex&quot;&gt;C_I&lt;/script&gt;差不多，需要符合目标参数&lt;script type=&quot;math/tex&quot;&gt;q_\nu(0) = \int_0^{\infty} C_q \frac{d\tau_\nu}{\mu}&lt;/script&gt;的形式；而一旦有了目标参数的辐射转移方程&lt;script type=&quot;math/tex&quot;&gt;\frac{dq_\nu}{d\tau_\nu} = -q_\nu + S_\nu&lt;/script&gt;，我们就可以仿照光强的贡献函数写出相应的&lt;script type=&quot;math/tex&quot;&gt;C_q&lt;/script&gt;来了。当然仿照的过程中需要相应地改&lt;script type=&quot;math/tex&quot;&gt;\tau_\nu, S_\nu&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;例子：PANDORA或者MOOG&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;光强减少的贡献函数&quot;&gt;光强减少的贡献函数&lt;/h2&gt;

&lt;p&gt;上面光强的源函数只为我们计算谱线形成范围提供了一个范本，并没有给出最终的解决方案；因为光强的产生并不代表着谱线的形成。我们平常看到的谱线是吸收线，也就是说光强减少的贡献函数才和谱线形成区域相关联。那怎么办呢？&lt;a href=&quot;https://ui.adsabs.harvard.edu/abs/1986A%26A...163..135M/abstract&quot;&gt;Magain 1986&lt;/a&gt;给出了答案：对着上一节照板煮糊。&lt;/p&gt;

&lt;p&gt;我们现在关心的参量是光强的减少：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;R_I = \frac{I_c-I_t}{I_c}&lt;/script&gt;

&lt;p&gt;原文的&lt;script type=&quot;math/tex&quot;&gt;I_t&lt;/script&gt;用的是&lt;script type=&quot;math/tex&quot;&gt;I_l&lt;/script&gt;，不过为了统一我都用&lt;script type=&quot;math/tex&quot;&gt;I_t&lt;/script&gt;。顾名思义&lt;script type=&quot;math/tex&quot;&gt;I_c&lt;/script&gt;是谱线不存在时的光强，&lt;script type=&quot;math/tex&quot;&gt;I_t&lt;/script&gt;是谱线存在时的光强。用&lt;script type=&quot;math/tex&quot;&gt;I_t&lt;/script&gt;表示的好处在于这个量不单纯表示谱线吸收之后的光强，它是连续谱和谱线共同作用下的光强。不过看不懂不要紧，后面会把这个问题说清楚的。&lt;/p&gt;

&lt;p&gt;将&lt;script type=&quot;math/tex&quot;&gt;R_I&lt;/script&gt;对&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;求导，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dR_I}{dz} = \frac{I_t}{I_c^2} \frac{dI_t}{dz} - \frac{1}{I_c} \frac{dI_t}{dz}&lt;/script&gt;

&lt;p&gt;而对着&lt;script type=&quot;math/tex&quot;&gt;I_c, I_t&lt;/script&gt;可以分别写出各自的辐射转移方程：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}  
  \mu \frac{dI_t}{dz} &amp;= -\kappa_c \rho (I_c - S_c) \\
  \mu \frac{dI_c}{dz} &amp;= -(\kappa_c + \kappa_l) \rho (I_t - S_t) \\
  S_t &amp;= \frac{\kappa_c S_c + \kappa_l S_l}{\kappa_c + \kappa_l} \\
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;这里出现了下标为&lt;script type=&quot;math/tex&quot;&gt;l&lt;/script&gt;的量，不过是没有错的。把后面两条式子代进第一条里面去，可得：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}  
  \frac{\mu}{\rho} \frac{dR_I}{dz} &amp;= -\kappa_{R_I} (R_I - S_{R_I}) \\
  \kappa_{R_I} &amp;= \kappa_l + \kappa_c \frac{S_c}{I_c} \\
  S_{R_I} &amp;= \frac{1-\frac{S_l}{I_c}}{1+\frac{\kappa_c S_c}{\kappa_l I_c}} \\
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;然后就可以写出&lt;script type=&quot;math/tex&quot;&gt;R_I&lt;/script&gt;的表达式以及贡献函数了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;R_I(0) = \int_0^\infty \frac{1}{\mu} S_{R_I} e^{-\frac{\tau_{R_I}}{\mu}} d\tau_{R_I}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;C_{R_I} = \frac{1}{\mu} S_{R_I} e^{-\frac{\tau_{R_I}}{\mu}}&lt;/script&gt;

&lt;h2 id=&quot;流量减少的贡献函数&quot;&gt;流量减少的贡献函数？&lt;/h2&gt;

&lt;p&gt;我们还没完。光强的减少虽然是可观测量，但是那是太阳的可观测量；对于恒星来说，我们只能观测到流量。那流量减少的贡献函数可不可以通过类似的方法给出呢？不好说；&lt;a href=&quot;https://ui.adsabs.harvard.edu/abs/1992SoPh..138..411A/abstract&quot;&gt;Achmad 1991&lt;/a&gt;给出了一些讨论以及另一个解决方案。&lt;/p&gt;

&lt;p&gt;如果我们类似定义&lt;script type=&quot;math/tex&quot;&gt;R_F = 1- F_t / F_c&lt;/script&gt;的话，我们的确可以给出相应的&lt;script type=&quot;math/tex&quot;&gt;\kappa_{R_I}, S_{R_I}&lt;/script&gt;。但是它们不是唯一的，只要符合条件的&lt;script type=&quot;math/tex&quot;&gt;\kappa_{R_I}, S_{R_I}&lt;/script&gt;们都可以用；更要命的是不同&lt;script type=&quot;math/tex&quot;&gt;\kappa_{R_I}, S_{R_I}&lt;/script&gt;的贡献函数很不一样，有的在-1那有峰，有的在-2那。Magain 1986规定的是&lt;script type=&quot;math/tex&quot;&gt;S_R&lt;/script&gt;中不可以显含和总量有关（也就是带下标&lt;script type=&quot;math/tex&quot;&gt;t&lt;/script&gt;）的量；这个也能理解，不过在&lt;script type=&quot;math/tex&quot;&gt;R_F&lt;/script&gt;中就不好做了。&lt;/p&gt;

&lt;p&gt;那怎么办？数学走不通的这个时候就要回到我们的物理图景去找新的路子了。谱线是在第一节图中的管子里形成的，谱线形成的具体过程包括吸收和发射；我们想把谱线吸收+发射对连续谱的影响作为目标参量但是失败了，那么可不可以退而求其次，把谱线的吸收或者发射作为目标参量呢？吸收可能不好做，那谱线发射总可以吧？思路就是这样的了。恒星发出的流量如下：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\pi F_t(0) = \int I_t \cos{\theta} d\omega&lt;/script&gt;

&lt;p&gt;这当然没啥用处，又不是对光深积分；但是我们正好也有个光深积分积出来是流量的玩意儿：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
  F_t(0) &amp;= \int_0^\infty S_t(\tau_\nu) E_2(\tau_\nu) d\tau_\nu \\
  E_2(\tau_\nu) &amp;= \int_1^\infty \frac{e^{x\tau_\nu}}{x^2} dx \\
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;就是OASP7中&lt;script type=&quot;math/tex&quot;&gt;(7.15)&lt;/script&gt;的E积分。这就好了，我们可以马上高兴地写出&lt;script type=&quot;math/tex&quot;&gt;F_t&lt;/script&gt;的贡献函数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;C_{F_t} = S_t(\tau_\nu) E_2(\tau_\nu)&lt;/script&gt;

&lt;p&gt;不过是不是高兴得太早了一点？说好的谱线发射的流量呢？此时只需简单地将源函数&lt;script type=&quot;math/tex&quot;&gt;S_t&lt;/script&gt;拆成谱线的和连续谱的两部分：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_t = \frac{\sum j_i}{\kappa_t} = \frac{\kappa_l}{\kappa_t}S_l + \frac{\kappa_c}{\kappa_t}S_c&lt;/script&gt;

&lt;p&gt;就可以写出连续谱和谱线发射的贡献函数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{align}
  C_{F_l} = \frac{\kappa_l}{\kappa_t} S_l(\tau_\nu) E_2(\tau_\nu) \\
  C_{F_c} = \frac{\kappa_c}{\kappa_t} S_c(\tau_\nu) E_2(\tau_\nu) \\
\end{align}&lt;/script&gt;

&lt;p&gt;谱线的发射和谱线的吸收仍然不是同一个东西，但是只要我们认为它们发生在同一个地方就可以了。还是下一节会详细讨论这个问题。&lt;/p&gt;

&lt;p&gt;有了这三个贡献函数之后，我们就可以看一下它们的关系了。我们预期的是连续谱提供了光子给谱线吸收，所以谱线的吸收位置不能比连续谱的位置更靠里。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Achmad91-2.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Achmad 1991 图2&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;还是符合我们预期的；而强线因为吸收太多，基本上所有的流量都是从谱线那来的，就没有连续谱了。&lt;/p&gt;

&lt;p&gt;那这个贡献函数和Magain 1986的贡献函数一样吗？请看下图：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Achmad91-3.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Achmad 1991 图3&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;基本上是一样的。&lt;/p&gt;

&lt;h2 id=&quot;究竟哪些能用哪些不能用&quot;&gt;究竟哪些能用哪些不能用？&lt;/h2&gt;

&lt;p&gt;我们把这个问题说清楚吧；在前面我们稍微将某些量区别对待，有些是我们想要的有些则不能包含在参量内。那么究竟哪些是我们要留下的哪些不是呢？&lt;a href=&quot;https://ui.adsabs.harvard.edu/abs/1991SoPh..136..239G/abstract&quot;&gt;Gurtovenko+1991&lt;/a&gt;讨论了这个问题。&lt;/p&gt;

&lt;p&gt;我们将连续谱和谱线的过程拆开，如下图：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Gur91-1.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Gurtovenko+1991 图1&lt;/em&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;script type=&quot;math/tex&quot;&gt;I_c&lt;/script&gt;是连续谱的发射，代表着谱线不存在时的出射光强&lt;/li&gt;
  &lt;li&gt;&lt;script type=&quot;math/tex&quot;&gt;D_l^p&lt;/script&gt;是连续谱发射通过谱线区域时被谱线吸收的量（纯吸收，谱线的发射不计算在内）&lt;/li&gt;
  &lt;li&gt;&lt;script type=&quot;math/tex&quot;&gt;I_l^c&lt;/script&gt;是连续谱发射通过谱线区域时没有被吸收的量，也就是最终谱线轮廓处连续谱光强占的比例&lt;/li&gt;
  &lt;li&gt;&lt;script type=&quot;math/tex&quot;&gt;I_l^p&lt;/script&gt;是谱线发射光强占的比例（谱线发射在这里被count了）&lt;/li&gt;
  &lt;li&gt;&lt;script type=&quot;math/tex&quot;&gt;D_l = D_l^p - I_l^p&lt;/script&gt;是最终观测到的谱线总吸收&lt;/li&gt;
  &lt;li&gt;&lt;script type=&quot;math/tex&quot;&gt;I_l = I_l^c + I_l^p&lt;/script&gt;是最终观测到的谱线总发射光强&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;顺便，&lt;script type=&quot;math/tex&quot;&gt;D&lt;/script&gt;的意思是depression。然后我们可以写出这六个量的表达式和贡献函数了。顺便为了简化，这里只介绍solar disk center的情况，&lt;script type=&quot;math/tex&quot;&gt;\mu = 1&lt;/script&gt;。&lt;/p&gt;

&lt;h3 id=&quot;i_c&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;I_c&lt;/script&gt;&lt;/h3&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_c(0) = \int_0^{\infty} S_c e^{-\tau_c} d\tau_c&lt;/script&gt;

&lt;p&gt;抄OASP7就完了。&lt;/p&gt;

&lt;h3 id=&quot;d_lp&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;D_l^p&lt;/script&gt;&lt;/h3&gt;

&lt;p&gt;连续谱发射通过谱线区域时被谱线吸收的量就是&lt;script type=&quot;math/tex&quot;&gt;I_c&lt;/script&gt;在某一点&lt;script type=&quot;math/tex&quot;&gt;\tau_c&lt;/script&gt;处乘上该处的吸收系数&lt;script type=&quot;math/tex&quot;&gt;\kappa_l(\tau_c)&lt;/script&gt;再乘上这段的长度元&lt;script type=&quot;math/tex&quot;&gt;\Delta h(\tau_c)&lt;/script&gt;。但是这里有一个问题，&lt;script type=&quot;math/tex&quot;&gt;I_c&lt;/script&gt;是只考虑连续谱吸收发射是的光强，但是入射的时候因为&lt;script type=&quot;math/tex&quot;&gt;\tau_c&lt;/script&gt;前面有谱线和连续谱的吸收，这层上面的光强和吸收量都会被它之外的大气进行消光，所以要借用&lt;script type=&quot;math/tex&quot;&gt;I_c&lt;/script&gt;定义中的&lt;script type=&quot;math/tex&quot;&gt;e&lt;/script&gt;指数项，再乘上一个&lt;script type=&quot;math/tex&quot;&gt;e^{-(\tau_c+\tau_l)}&lt;/script&gt;，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D_l^p = \sum I_c(\tau_c) e^{-(\tau_c+\tau_l)} \kappa_l(\tau_c) \Delta h(\tau_c)&lt;/script&gt;

&lt;p&gt;将&lt;script type=&quot;math/tex&quot;&gt;I_c&lt;/script&gt;的定义代入并定义&lt;script type=&quot;math/tex&quot;&gt;\eta = \kappa_l / \kappa_c&lt;/script&gt;以及&lt;script type=&quot;math/tex&quot;&gt;\kappa_l(\tau_c) \Delta h(\tau_c) = \eta(\tau_c) \Delta\tau_c&lt;/script&gt;，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D_l^p = \int_0^\infty \left[ \int_{\tau_c}^\infty S_c(\tau_c) e^{-\tau_c} d\tau_c \right] e^{-\tau_l} \eta d\tau_c&lt;/script&gt;

&lt;h3 id=&quot;i_lp&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;I_l^p&lt;/script&gt;&lt;/h3&gt;

&lt;p&gt;谱线发射光强占的比例的定义和&lt;script type=&quot;math/tex&quot;&gt;D_l^p&lt;/script&gt;差不多，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_l^p = \sum e^{-(\tau_c+\tau_l)} \epsilon_l(\tau_c) \Delta h(\tau_c) = \sum S_l(\tau_c) e^{-(\tau_c+\tau_l)} \eta(\tau_c) \kappa_c(\tau_c) \Delta h(\tau_c)&lt;/script&gt;

&lt;p&gt;以防万一还是写明&lt;script type=&quot;math/tex&quot;&gt;\epsilon_l = S_l \kappa_l = S_l \kappa_c \eta&lt;/script&gt;。将&lt;script type=&quot;math/tex&quot;&gt;\Delta h(\tau_c)&lt;/script&gt;换成&lt;script type=&quot;math/tex&quot;&gt;\Delta \tau_c&lt;/script&gt;并改成积分号，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_l^p = \int_0^\infty S_l e^{-(\tau_c+\tau_l)} \eta d\tau_c&lt;/script&gt;

&lt;h3 id=&quot;d_l&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;D_l&lt;/script&gt;&lt;/h3&gt;

&lt;p&gt;上面已经写了&lt;script type=&quot;math/tex&quot;&gt;D_l = D_l^p - I_l^p&lt;/script&gt;，两式相减就完了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D_l = \int_0^\infty \left[ \int_{\tau_c}^\infty S_c(\tau_c) e^{-\tau_c} d\tau_c - S_l(\tau_c) e^{-\tau_c} \right] e^{-\tau_l} \eta d\tau_c&lt;/script&gt;

&lt;h3 id=&quot;i_lc&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;I_l^c&lt;/script&gt;&lt;/h3&gt;

&lt;p&gt;这玩意跟&lt;script type=&quot;math/tex&quot;&gt;I_l^p&lt;/script&gt;差不多，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_l^c = \sum e^{-(\tau_c+\tau_l)} \epsilon_c(\tau_c) \Delta h(\tau_c) = \sum S_c(\tau_c) e^{-(\tau_c+\tau_l)}  \kappa_c(\tau_c) \Delta h(\tau_c)&lt;/script&gt;

&lt;p&gt;所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_l^c = \int_0^\infty S_c e^{-(\tau_c+\tau_l)} d\tau_c&lt;/script&gt;

&lt;h3 id=&quot;i_l&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;I_l&lt;/script&gt;&lt;/h3&gt;

&lt;p&gt;由&lt;script type=&quot;math/tex&quot;&gt;I_l = I_l^c + I_l^p&lt;/script&gt;，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_l = \int_0^\infty (S_c + \eta S_l) e^{-(\tau_c+\tau_l)} d\tau_c&lt;/script&gt;

&lt;p&gt;它们的贡献函数就不单独列了。这些式子比较基础，即使是NLTE下也能使用；顺带一提这里的吸收/发射系数是包含了密度的，但是前面几节的没有。&lt;/p&gt;

&lt;p&gt;搞定了这些表达式我们就可以看看这六个贡献函数线具体长什么样子了，这里仅举两例：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Gur91-2.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Gurtovenko+1991 图2&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Gur91-4.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Gurtovenko+1991 图4&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;可以看到结论是类似的，连续谱在大气底层形成，然后在上部被谱线吸收；如果吸收不多那&lt;script type=&quot;math/tex&quot;&gt;CF(I_l)&lt;/script&gt;会有双峰，吸收很强的时候&lt;script type=&quot;math/tex&quot;&gt;CF(I_l)&lt;/script&gt;就和谱线的贡献函数一致了。从这里也可以看出想要讨论谱线的形成区域的话，我们应该选用和谱线的贡献函数（吸收/发射都可以，&lt;script type=&quot;math/tex&quot;&gt;D_l^p, I_l^p&lt;/script&gt;）或者总的吸收贡献函数&lt;script type=&quot;math/tex&quot;&gt;D_l&lt;/script&gt;（因为它只算了谱线的吸收）；连续谱的贡献函数当然只对连续谱有用，而最方便能得到的&lt;script type=&quot;math/tex&quot;&gt;I_l&lt;/script&gt;的贡献函数实际上受连续谱和谱线共同影响，是不能用的。&lt;/p&gt;

&lt;p&gt;这里有一个坑，就是每个式子最后的微分变量和画图的横坐标必须要完全一致。以&lt;script type=&quot;math/tex&quot;&gt;I_c(0) = \int_0^{\infty} S_c e^{-\tau_c} d\tau_c&lt;/script&gt;为例，如果横坐标为&lt;script type=&quot;math/tex&quot;&gt;\tau_c&lt;/script&gt;那么这条式子即为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_c(0) = \int_0^{\infty} S_c(\tau_c) e^{-\tau_c} d\tau_c&lt;/script&gt;

&lt;p&gt;可以直接进行计算；但是我们有的时候不知道&lt;script type=&quot;math/tex&quot;&gt;S_c(\tau_c)&lt;/script&gt;或者想用别的自变量，那么就需要换算了。以几何深度&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;为例（PANDORA里面用的），这时的式子实际上是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_c(0) = \int_0^{\infty} S_c(z) e^{-\tau_c(z)} d\tau_c(z)&lt;/script&gt;

&lt;p&gt;要记住&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;后面的微分变量必须和横坐标完全一致，所以这里需要用光深的定义&lt;script type=&quot;math/tex&quot;&gt;d\tau_c(z) = \kappa_c dz&lt;/script&gt;代到式子里面去，&lt;script type=&quot;math/tex&quot;&gt;S_c(z) e^{-\tau_c(z)} \kappa_c&lt;/script&gt;这个玩意儿才是贡献函数。&lt;/p&gt;

&lt;p&gt;再举一个例子（都是自己踩过的坑…），当我们用一个参考的光深的对数&lt;script type=&quot;math/tex&quot;&gt;\log{\tau_\mathrm{ref}}&lt;/script&gt;做横坐标的时候（这是MOOG用的），式子变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_c(0) = \int_0^{\infty} S_c(\tau_\mathrm{ref}) e^{-\tau_c(\tau_\mathrm{ref})} d\tau_c(\tau_\mathrm{ref})&lt;/script&gt;

&lt;p&gt;在这里我们要将&lt;script type=&quot;math/tex&quot;&gt;d\tau_c(\tau_\mathrm{ref})&lt;/script&gt;变成&lt;script type=&quot;math/tex&quot;&gt;d\log{\tau_\mathrm{ref}}&lt;/script&gt;，转换关系为&lt;script type=&quot;math/tex&quot;&gt;d\tau_c(\tau_\mathrm{ref}) = \ln{(10)} \tau_\mathrm{ref} \frac{\kappa_c}{\kappa_\mathrm{ref}} d \log{\tau_\mathrm{ref}}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;那有人可能会疑惑前面源函数和&lt;script type=&quot;math/tex&quot;&gt;e&lt;/script&gt;指数项需要把自变量换成对数的吗？其实不用直接换，因为我们之后会把横坐标取对数，这个时候就相当于把这两个项的自变量换成对数的了。&lt;/p&gt;

&lt;p&gt;总结一下就是积分变量的源函数一般可以随便换成横坐标的量，但是剩下的特别是后面的&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;要换过去，对数坐标的话还要加点东西。&lt;/p&gt;

&lt;p&gt;这里还留下了一个坑，Gurtovenko+1991光强到流量的转换没有做；如果巨星/超巨星的临边昏暗很小的话那没问题。我估计我就直接用上面的式子了。&lt;/p&gt;

&lt;h2 id=&quot;贡献函数和恒星参数的关系&quot;&gt;贡献函数和恒星参数的关系&lt;/h2&gt;

&lt;p&gt;我们重于定义好了贡献函数，可以看看它们和恒星参数的关系了。&lt;/p&gt;

&lt;h3 id=&quot;速度场&quot;&gt;速度场&lt;/h3&gt;

&lt;p&gt;这个其实挺复杂的。直接看图吧：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Albow96.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Albow+1996&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;可以看出线翼形成于大气更深处。加上整体速度场之后因为disk center的谱线偏离了静止波长，在静止波长处我们只能看到恒星边缘（只有切向速度）的大气的谱线；而恒星边缘的连续谱形成位置更高，所以静止波长处谱线的形成位置也被相应抬高了。&lt;/p&gt;

&lt;h3 id=&quot;激发能&quot;&gt;激发能&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Achmad92-2.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Achmad 1992 图2&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;很好理解，激发能越高谱线越需要高温激发，就越往大气内部跑。&lt;/p&gt;

&lt;h3 id=&quot;3d-nlte下&quot;&gt;3D-NLTE下&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-contri_func/Amarsi15-3.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Amarsi 2015 图3&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;这个就比较前沿了，感觉有得做。&lt;/p&gt;

&lt;h3 id=&quot;恒星大气切片&quot;&gt;恒星大气切片&lt;/h3&gt;

&lt;p&gt;这也是很好玩的，例子是&lt;a href=&quot;https://ui.adsabs.harvard.edu/abs/2018A%26A...610A..29K/abstract&quot;&gt;Kravchenko+2018&lt;/a&gt;。反正就是挑出在不同地方形成的谱线然后测它们的波长偏离，就可以得到不同地方的RV了，对Mira什么的有用。&lt;/p&gt;
</description>
        <pubDate>Sun, 04 Aug 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/08/04/contri_func/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/08/04/contri_func/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>利用星震学方法测量恒星的氦丰度</title>
        <description>&lt;p&gt;这里作为星震学测量氦丰度方法的补充说明，估计会比较散。主要是看Verma+19得出的问题以及查询得到的答案。&lt;/p&gt;

&lt;h2 id=&quot;原理&quot;&gt;原理&lt;/h2&gt;

&lt;p&gt;恒星内部的温度是越来越高的，而温度高到一定程度之后就会将原子电离；比如说氢原子会逐渐被剥成质子和电子，氦原子(HeI)会变成&lt;script type=&quot;math/tex&quot;&gt;\mathrm{He^+}&lt;/script&gt;(HeII)和&lt;script type=&quot;math/tex&quot;&gt;\mathrm{He^++}&lt;/script&gt;(HeIII)。原子电离情况和温度的关系请参照OASP1, Fig. 1.10。在这里我们主要讨论恒星内部的情况，Kippenhahn的恒星结构与演化给出了电离情况与压强的关系：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-astero-he/01-ionization.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Kippenhahn 恒星结构与演化 Fig. 14.1&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;有趣的是当HeIII开始出现的时候&lt;script type=&quot;math/tex&quot;&gt;\Delta_\mathrm{ab}&lt;/script&gt;出现了一个dip；这里的&lt;script type=&quot;math/tex&quot;&gt;\Delta_\mathrm{ab} = \frac{P\delta}{T\rho c_P}&lt;/script&gt;，而电离情况的变化改变了&lt;script type=&quot;math/tex&quot;&gt;P&lt;/script&gt;，使得&lt;script type=&quot;math/tex&quot;&gt;\Delta_\mathrm{ab}&lt;/script&gt;发生了变化。&lt;/p&gt;

&lt;p&gt;不过这里我们的重点不在&lt;script type=&quot;math/tex&quot;&gt;\Delta_\mathrm{ab}&lt;/script&gt;，而在绝热指数&lt;script type=&quot;math/tex&quot;&gt;\Gamma_1 = \left( \frac{\partial \ln{P}}{\partial \ln{\rho}} \right)_s&lt;/script&gt;上，它和&lt;script type=&quot;math/tex&quot;&gt;\Delta_\mathrm{ab}&lt;/script&gt;有类似的行为：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-astero-he/02-gamma1.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Basu+04 Fig. 1&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;这个dip的深度和氦丰度&lt;script type=&quot;math/tex&quot;&gt;Y&lt;/script&gt;是有关的，而且会对恒星的振动产生影响。具体的影响是这样的：原有的功率谱的峰的位置被稍微移动了一点，移动的频率&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\delta \nu_\mathrm{He} = A_\mathrm{He}\nu e^{-8\pi^2\Delta_\mathrm{He}^2\nu^2} \sin{(4\pi\tau_\mathrm{He}\nu + \psi_\mathrm{He})}&lt;/script&gt;

&lt;p&gt;其中&lt;script type=&quot;math/tex&quot;&gt;A_\mathrm{He}&lt;/script&gt;为&lt;script type=&quot;math/tex&quot;&gt;\Gamma_1&lt;/script&gt;峰的面积（和氦丰度有关）、&lt;script type=&quot;math/tex&quot;&gt;\Delta_\mathrm{He}&lt;/script&gt;为&lt;script type=&quot;math/tex&quot;&gt;\Gamma_1&lt;/script&gt;峰的宽度、&lt;script type=&quot;math/tex&quot;&gt;\tau_\mathrm{He} = \int_{r_m}^R \frac{1}{c} dr&lt;/script&gt;，为声学深度（&lt;script type=&quot;math/tex&quot;&gt;c&lt;/script&gt;为声速）。&lt;/p&gt;

&lt;p&gt;所以只要画出了频率的偏移和频率的关系，再对它进行拟合，就可以得出氦丰度和HeIII区域开始的深度。可以用直接的&lt;script type=&quot;math/tex&quot;&gt;\delta \nu_\mathrm{He}&lt;/script&gt;或者second difference frequencies&lt;script type=&quot;math/tex&quot;&gt;\delta^2 \nu_{n,l} = \nu_{n+1,l} - 2\nu_{n,l} + \nu_{n-1,l}&lt;/script&gt;进行拟合，结果相差不大。&lt;/p&gt;

&lt;p&gt;这两个频率差都会有一个长周期的量（大概是由其他原因引起的）、氦电离带来的项和对流层顶端带来的项，所以可以通过&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}
\delta^2 \nu_{n,l} &amp;= (a_1 + a_2\nu + \frac{a_3}{\nu^2}) + (b_1 + \frac{b_2}{\nu^2}) \sin{(4\pi\nu\tau_\mathrm{He}+ \phi_\mathrm{He})} + (c_1 + \frac{c_2}{\nu^2}) \sin{(4\pi\nu\tau_\mathrm{CZ}+ \phi_\mathrm{CZ})} \\
&amp;= (a_1 + a_2\nu + a_3\nu^2) + (b_1 + \frac{\sin^2{(2\pi\nu\beta)}}{\nu\beta}) \sin{(4\pi\nu\tau_\mathrm{He}+ \phi_\mathrm{He})} + (c_1 + + c_2\nu + c_3\nu^2) \sin{(4\pi\nu\tau_\mathrm{CZ}+ \phi_\mathrm{CZ})}
\end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;来拟合里面的各种系数。&lt;/p&gt;

&lt;h2 id=&quot;对模型的拟合&quot;&gt;对模型的拟合&lt;/h2&gt;

&lt;p&gt;最容易尝试的当然是造一个模型和星震数据然后拟合看看是什么样子的。&lt;/p&gt;

&lt;h3 id=&quot;dwarf拟合结果&quot;&gt;dwarf拟合结果&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-astero-he/03-dwarf.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Basu+04 Fig. 2&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;要注意的是恒星的密度（也就是&lt;script type=&quot;math/tex&quot;&gt;M/R^3&lt;/script&gt;）对振动频率有scale，平均large frequency seperation对&lt;script type=&quot;math/tex&quot;&gt;\delta^2 \nu_{n,l}&lt;/script&gt;的振幅有影响，需要改正（详见Basu+04, Section 2）。我们可以建立平均振幅(&lt;script type=&quot;math/tex&quot;&gt;% &lt;![CDATA[
&lt;A_\nu&gt; = \frac{\int_{\nu_1}^{\nu_2} A_\mathrm{He}\nu e^{-8\pi^2\Delta_\mathrm{He}^2\nu^2} d\nu}{\int_{\nu_1}^{\nu_2}dv} %]]&gt;&lt;/script&gt;)和&lt;script type=&quot;math/tex&quot;&gt;\tau_\mathrm{He}&lt;/script&gt;与&lt;script type=&quot;math/tex&quot;&gt;Y&lt;/script&gt;的关系：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-astero-he/04-Y-dwarf.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Basu+04 Fig. 3&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;这俩都和氦丰度以及恒星质量有关。加上之前和密度的scale关系，如果我们知道质量或者半径的其中一个，那么拟合会准确很多，因为我们可以通过星震学数据得到它们的比例。其他的参数对振幅影响不大。&lt;/p&gt;

&lt;h3 id=&quot;giant拟合结果&quot;&gt;giant拟合结果&lt;/h3&gt;

&lt;p&gt;巨星的拟合结果比矮星的要差，因为很多矮星的p模在巨星中是混合模，所以用不了，能拟合的点就少了：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-astero-he/05-giant.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Basu+04 Fig. 9&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;同时平均振幅还受金属丰度Z的影响很大。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-astero-he/06-Y-giant.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Basu+04 Fig. 10&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;对巨星数据的拟合verma19&quot;&gt;对巨星数据的拟合(Verma+19)&lt;/h2&gt;

&lt;p&gt;然后我们看看对数据的拟合是什么样子的。我们需要两个东西：类似于Basu+04 Fig. 10从模型中来的点以及关系、和实际测量的&lt;script type=&quot;math/tex&quot;&gt;% &lt;![CDATA[
&lt;A_\nu&gt; %]]&gt;&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;对于第一个，我们可以用不同的质量、氦丰度、金属丰度、对流长、diffusion等参数产生一系列模型，再通过别的信息或者星震学信息限制其他的参数以得到只随氦丰度变化的模型，然后建立关系。第二个就测就是了。&lt;/p&gt;

&lt;p&gt;结果证明，当质量小的时候测到的模数少，质量大的时候模的宽度太大，质量限制不好，所以只有1.0-1.3个太阳质量的星是不错的。同时对流是有必要的，但是大质量恒星的对流模型不好，所以它们的结果没有非对流模型好。大概就是质量适中的或者初始/表面氦丰度差小的可以用对流模型，其他的用非对流模型或者干脆别用比较好。模型的话还是用同一个模型去测同一个scale下的丰度比较好。&lt;/p&gt;

&lt;p&gt;Verma+19给出了38颗Kepler矮星的氦丰度。McKeever+19给出了大概20颗疏散星团巨星的氦丰度。&lt;/p&gt;
</description>
        <pubDate>Thu, 18 Jul 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/07/18/astero-he/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/07/18/astero-he/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>原子的光谱项</title>
        <description>&lt;p&gt;这玩意我从本科开始就没怎么搞懂（这数字哪来的？LPS这些又是什么鬼东西？）；还以为做光谱只需要用到别人做好的表格（拿来主义hhh），结果还是要搞懂。不然别人问起为什么这是三重态那是单重态我都说不出来。&lt;/p&gt;

&lt;h2 id=&quot;复习一下电子态&quot;&gt;复习一下：电子态&lt;/h2&gt;

&lt;p&gt;光谱项是描述原子的标识。而原子之间的区别实际上只在于电子所处的能级不同，所以光谱项说白了还是电子量子数的反映。&lt;/p&gt;

&lt;p&gt;我们只需要四个量子数来描述电子，&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{n}, \boldsymbol{l}, \boldsymbol{m}, \boldsymbol{s} \in \mathbb{Z}&lt;/script&gt;；主量子数、角量子数、磁量子数和自选量子数。&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{n} \in [0, ...]&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{l} \in [0, ..., \boldsymbol{n}-1]&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{m} \in [-\boldsymbol{l}, ..., \boldsymbol{l}]&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{s} = \pm \frac{1}{2}&lt;/script&gt;。一个&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{n}&lt;/script&gt;叫一个壳层，一个&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{l}&lt;/script&gt;叫一个轨道，一个壳层一共可以容纳&lt;script type=&quot;math/tex&quot;&gt;2n^2&lt;/script&gt;个电子。&lt;/p&gt;

&lt;p&gt;麻烦的事情来了：我们用不同（但是会重复！）的字母来表示轨道和壳层。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;主量子数&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{n}&lt;/script&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;1&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;2&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;3&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;4&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;5&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;6&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;7&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;壳层名称&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;K&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;L&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;M&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;N&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;O&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;P&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Q&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;角量子数&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{l}&lt;/script&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;0&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;1&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;2&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;3&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;4&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;5&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;6&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;轨道名称&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;s&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;p&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;d&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;f&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;g&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;h&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;i&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;轨道鸣名称的前几个还是有来头的，其他的我不知道是怎么来的；总之这些名字增加了记忆的难度，好在它们大小写不同以及后面只会用到轨道名称，所以记住spd是012就可以了。&lt;/p&gt;

&lt;h2 id=&quot;电子组态&quot;&gt;电子组态&lt;/h2&gt;

&lt;p&gt;原子里面可能不止有一个电子，那如何表示原子里面电子的状态呢？我们用电子组态来表示，也就是&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{n}&lt;/script&gt;加上轨道名称。&lt;/p&gt;

&lt;p&gt;比如说处于基态的氢原子电子为&lt;script type=&quot;math/tex&quot;&gt;1s&lt;/script&gt;，被激发的氦原子可以为&lt;script type=&quot;math/tex&quot;&gt;1s3p&lt;/script&gt;，某个处于激发态的氧原子电子组态为&lt;script type=&quot;math/tex&quot;&gt;2s^22p^4&lt;/script&gt;；平方意味着有多少个电子处于这个态。我们能看出来电子组态只用了电子前两个量子数（我也不知道为什么不全部指明），所以一个电子组态有不止一种可能；比如&lt;script type=&quot;math/tex&quot;&gt;sp^2&lt;/script&gt;有15种可能。这些可能性由泡利不相容原理，能量最低原则和Hund定则决定（所以不是20个）。&lt;/p&gt;

&lt;h2 id=&quot;原子光谱项&quot;&gt;原子光谱项&lt;/h2&gt;

&lt;p&gt;只考虑LS耦合（因为研究的原子比较轻，原子序数小于40；如果重的话就要用jj耦合了），这个时候的好量子数是总轨道角动量&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{L} = \sum{\boldsymbol{l}}_i&lt;/script&gt;、总自旋角动量&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{S} = \sum{\boldsymbol{s}}_i&lt;/script&gt;和总角动量&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{J} = \boldsymbol{L} + \boldsymbol{S}&lt;/script&gt;。
所以只要给定了原子中每个电子的&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{l}, \boldsymbol{s}&lt;/script&gt;，就可以将这三个值定下来了。
前面两个都好说，&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{S}&lt;/script&gt;的取值为&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{J} \in [\boldsymbol{L}+\boldsymbol{S}, ..., |\boldsymbol{L}-\boldsymbol{S}|]&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;有了这三个角动量量子数之后，我们就可以可以区分不同的原子状态了；定义如下的光谱支项：&lt;/p&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;^{2\boldsymbol{S}+1}L_\boldsymbol{J}&lt;/script&gt;,  &lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{n} ^{2\boldsymbol{S}+1}L_\boldsymbol{J}&lt;/script&gt;, &lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{n} \boldsymbol{l}^x&lt;/script&gt; &lt;script type=&quot;math/tex&quot;&gt;^{2\boldsymbol{S}+1}L_\boldsymbol{J}&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;三种写法都有，信息量依次增大；当然只有后两种才能完全区分光谱项。因为在原子物理里面多数时候是讨论原子最外层电子的激发，还有一种写法是只写出被激发电子的电子态。把&lt;script type=&quot;math/tex&quot;&gt;\boldsymbol{J}&lt;/script&gt;省略掉的话就是光谱项了（求你写全好不好）。
这里的&lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;是角动量量子数&lt;strong&gt;对应的轨道名称&lt;/strong&gt;，也就是前面第二个表格的名称&lt;strong&gt;的大写&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;实际上光谱项就是我们在能级图上看到的一条条横线，也是我们这么大费周章搞出这个东西的原因。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.mdpi.com/atoms/atoms-04-00026/article_deploy/html/images/atoms-04-00026-g001.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;credit:&lt;a href=&quot;https://www.mdpi.com/2218-2004/4/4/26/htm&quot;&gt;here&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;就我关心的He &lt;script type=&quot;math/tex&quot;&gt;2^3\mathrm{S} \rightarrow 2^3\mathrm{P}&lt;/script&gt;跃迁来说，&lt;script type=&quot;math/tex&quot;&gt;2^3\mathrm{S}&lt;/script&gt;的三个量子数分别为0, 1, 0，所以只有一个态（单重态），但是&lt;script type=&quot;math/tex&quot;&gt;2^3\mathrm{P}&lt;/script&gt;可以有三个，&lt;script type=&quot;math/tex&quot;&gt;2^3\mathrm{P}_0, 2^3\mathrm{P}_1, 2^3\mathrm{P}_2&lt;/script&gt;，所以这个跃迁有三条靠得很近的线。&lt;/p&gt;

&lt;p&gt;至于它们具体怎么分布，那就不是我的事情了；找到了一个不错的网站，可以查询很多原子的能级分布，&lt;a href=&quot;https://physics.nist.gov/PhysRefData/Handbook/element_name.htm&quot;&gt;在这里&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ref&quot;&gt;Ref&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;http://www.astro.sunysb.edu/fwalter/AST341/qn.html&lt;/li&gt;
  &lt;li&gt;https://www.nist.gov/pml/handbook-basic-atomic-spectroscopic-data&lt;/li&gt;
  &lt;li&gt;https://www.gemini.edu/sciops/instruments/nearir-resources/&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 19 Jun 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/06/19/spec-term/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/06/19/spec-term/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>快过程和慢过程</title>
        <description>&lt;h2 id=&quot;先来复习一下&quot;&gt;先来复习一下&lt;/h2&gt;

&lt;h3 id=&quot;alpha衰变&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;衰变&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-sr-process/01-Alpha_Decay.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;原子喷出一个&lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;粒子（或者说氦原子核）；质量数-4，原子序数-2。基本上只会在比较重的原子里面发生，由核力和电磁力主导。在恒星核合成中比较少见，因为需要重的原子。&lt;/p&gt;

&lt;h3 id=&quot;beta衰变&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-sr-process/02-Beta-minus_Decay.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;原子里面的某一个中子喷出一个电子，自己变成质子；原子质量数不变，原子序数+1，原子变得更稳定(&lt;script type=&quot;math/tex&quot;&gt;\beta^-&lt;/script&gt;衰变)。可以有反过程，原子里面的某一个质子喷出一个反电子，自己变成中子(&lt;script type=&quot;math/tex&quot;&gt;\beta^+&lt;/script&gt;衰变)。原子吸收一个电子使得里面的质子变成中子有的时候也包含在&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变里面。&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变在之后的r和s过程中充当很重要的角色。&lt;/p&gt;

&lt;h3 id=&quot;gamma衰变&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\gamma&lt;/script&gt;衰变&lt;/h3&gt;

&lt;p&gt;就是普通的电子能级跃迁而已，不说了。&lt;/p&gt;

&lt;h2 id=&quot;然后来学习一下&quot;&gt;然后来学习一下&lt;/h2&gt;

&lt;h3 id=&quot;核素图&quot;&gt;核素图&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://blog.sdss.org/wp-content/uploads/2017/01/periodic_table.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;元素周期表上只列出了同种类的原子；它通过横向和纵向两个方向表征元素化学性质的变化；但是它并不能标示出全部的原子（质子数、中子数不同的原子），所以我们需要如下的核素图：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/Table_isotopes_en.svg/800px-Table_isotopes_en.svg.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;核素图以质子数为横轴，中子数为纵轴，元素周期表上的稳定元素一般在图中的黑色线上；图中竖线表示同一种元素的同位素。由此我们可以将所有可能形成的原子都标示在这张图上。&lt;/p&gt;

&lt;h4 id=&quot;beta稳定等高线&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;稳定等高线&lt;/h4&gt;

&lt;p&gt;核素图中的核素大多数都不是稳定的；越靠近核素分布的中央它们的结合能越高，所以图中中央的黑色阶梯状分布核素就是稳定核素。其他所有的核素都会以各种方式向稳定核素衰变，这些各种方式（从图上能看出来）主要就是&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变，所以这条线也叫做&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;稳定等高线。顺便一提等高线的左上方为丰中子核素，右下方为丰质子核素。&lt;/p&gt;

&lt;h4 id=&quot;原子核滴线nuclear-drip-line&quot;&gt;原子核滴线(Nuclear drip line)&lt;/h4&gt;

&lt;p&gt;并不是任意的质子-中子数组合都能形成核素的；上面说的核素虽然不稳定，但还能存在一会；而核素图上白色的地方则根本不能形成核素；这个白色区域和有色区域的交界线就叫做原子核滴线（鬼知道这个名字是怎么滴出来的…）。丰质子一侧的滴线称为质子滴线，丰中子一侧的滴线称为中子滴线。&lt;/p&gt;

&lt;h2 id=&quot;正文元素是怎么来的&quot;&gt;正文：元素是怎么来的？&lt;/h2&gt;

&lt;p&gt;大爆炸来的呗。乔治·伽莫夫就是这么想的。虽然他提出了大爆炸理论，但是他当时认为现在宇宙中所有的元素都是大爆炸时候的核反应产生的。然后被汉斯·贝特等人提出的质子-质子链和碳氮氧循环抽了一巴掌：氦也可以在恒星内部合成，恒星内部核聚变最重可以形成到铁。那其他元素还是大爆炸的残留呗？又被&lt;a href=&quot;https://en.wikipedia.org/wiki/B2FH_paper&quot;&gt;B2FH理论&lt;/a&gt;抽了一巴掌：比铁重的元素还是在恒星里面合成的！&lt;/p&gt;

&lt;p&gt;那这些元素是怎么样合成的呢？&lt;/p&gt;

&lt;h3 id=&quot;r过程&quot;&gt;R过程&lt;/h3&gt;

&lt;p&gt;恒星总是会挂的；恒星挂掉的时候一般都会将里面合成的元素像三蹦子的排气管一样嘣出来（超新星爆发）。元素之间肯定会有碰撞，但是大家都是电中性的，里面又有电子又有核，不太容易凑到一起形成更重的元素；但是中子单纯地不带电（而且不大），可以方便地跑到原子核上和原子核纠缠在一起。正好超新星爆发的时候会在短时间内产生大量的中子流，正好让原子核吃个够。所以原子核在大量中子轰击下变成新元素的过程就是R（快）过程了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/7/7c/Fig3_nuclear_chart.jpg/1920px-Fig3_nuclear_chart.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如上图，原子核在短时间内接收了大量中子，会在核素图上向右移动（横纵轴反了）；但是它不能产生不稳定元素，所以只能沿着中子滴线走：往右几步，向上挪；再往右几步，又向上挪。在中子数达到50, 82, 186时因为中子壳层闭合，核素和中子的碰撞截面变小，所以主要发生&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变而不是接收中子。而因为中子很多，所以R过程最终形成的核素的原子序数会比较大（也就是比较重了）。当然了这个过程不是无限的，我认为主要是因为超新星爆发的时间很短，中子流很快就扩散到了宇宙空间，所以R过程只能在很短的时间内发生。&lt;/p&gt;

&lt;p&gt;说白了R过程就是原子核被中子轰得一脸蒙蔽，还来不及&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变下一个就来了所以越吃越胖的故事。当然不能无限吃胖，太重了会有&lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;衰变将中子和质子数降下来的。&lt;/p&gt;

&lt;h3 id=&quot;s过程&quot;&gt;S过程&lt;/h3&gt;

&lt;p&gt;反过来说，如果中子密度比较低，原子核反应过来了，吃一个中子&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变一下，不就是S（慢）过程了嘛。&lt;/p&gt;

&lt;p&gt;具体来说就是原子核接收了一个中子之后停了下来，如果稳定就继续吃瓜等下一个中子，如果不稳定就&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;衰变到稳定，然后吃瓜。这样使得生成的核素更容易达到最终的稳定态（核素图中的黑色元素），所以S过程生成的元素质量没有R过程的那么大。&lt;/p&gt;

&lt;p&gt;那哪里才有这些稀疏中子流让S过程发生呢？答案在渐进巨星支(AGB)里。AGB星可以提供中子源：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{^{13}_6C + ^4_2He \rightarrow ^{16}_{8}O + n}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{^{22}_{10}Ne + ^4_2He \rightarrow ^{25}_{12}Mg + n}&lt;/script&gt;

&lt;p&gt;然后核素就可以快乐地像下图一样奔跑了：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/S-process-elem-Ag-to-Sb.svg/800px-S-process-elem-Ag-to-Sb.svg.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/S-R-processes-atomic-mass-201-to-210.svg/500px-S-R-processes-atomic-mass-201-to-210.svg.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;这里的浅绿色箭头和深绿色箭头各是什么衰变呢？&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;还是因为S过程太慢，到达铋(83)之后会短暂生成钋(84)，但是钋接收中子之后会回到铅(82)，然后生成铋，如此循环。&lt;/p&gt;

&lt;h3 id=&quot;谁多谁少&quot;&gt;谁多谁少？&lt;/h3&gt;

&lt;p&gt;前面的元素周期表已经给出了模型的预测值：Dying low-mass stars的是S过程，其他的出除去Big bang fusion, cosmic ray fission和human synthesis剩下的都是R过程元素。另外其实还有P（质子）过程和Rp（快质子捕获）过程，对某些核素素也有贡献，但是不在本文范围内就略过了，&lt;/p&gt;

&lt;h2 id=&quot;这俩过程有什么用&quot;&gt;这俩过程有什么用？&lt;/h2&gt;

&lt;p&gt;这两个过程为银河系考古学提供了更多的选择；我们不仅仅可以选择铁元素丰度来表征不同population的恒星，也可以选择更重的元素。如果某个地方R过程元素特别高，我们可以猜测那里之前可能有过很多的超新星爆发，也就是很久以前有大量的恒星形成；如果银河系中心到边缘的S过程元素逐渐减少，那么……我还没有好的结论。这些元素也可以被用到河外星系的观测里面。&lt;/p&gt;

&lt;h2 id=&quot;refs&quot;&gt;Refs&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/S-process&quot;&gt;s过程&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/R-process&quot;&gt;r过程&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Mon, 10 Jun 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/06/10/sr-process/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/06/10/sr-process/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>PANDORA使用记录</title>
        <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#fortran-编译器选择&quot; id=&quot;markdown-toc-fortran-编译器选择&quot;&gt;Fortran 编译器选择&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#安装perl&quot; id=&quot;markdown-toc-安装perl&quot;&gt;安装Perl&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#文件准备&quot; id=&quot;markdown-toc-文件准备&quot;&gt;文件准备&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#格式大坑&quot; id=&quot;markdown-toc-格式大坑&quot;&gt;格式大坑&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#元素数据输入wup-section-10&quot; id=&quot;markdown-toc-元素数据输入wup-section-10&quot;&gt;元素数据输入(WUP Section 10)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#原子结构文件以及原子数密度&quot; id=&quot;markdown-toc-原子结构文件以及原子数密度&quot;&gt;原子结构文件以及原子数密度&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#一般信息&quot; id=&quot;markdown-toc-一般信息&quot;&gt;一般信息&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#原子能级&quot; id=&quot;markdown-toc-原子能级&quot;&gt;原子能级&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#能级之间的跃迁&quot; id=&quot;markdown-toc-能级之间的跃迁&quot;&gt;能级之间的跃迁&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#致宽与mass-motion&quot; id=&quot;markdown-toc-致宽与mass-motion&quot;&gt;致宽与mass motion&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#输入参数介绍&quot; id=&quot;markdown-toc-输入参数介绍&quot;&gt;输入参数介绍&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#选项选择&quot; id=&quot;markdown-toc-选项选择&quot;&gt;选项选择&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#需要注意的选项&quot; id=&quot;markdown-toc-需要注意的选项&quot;&gt;需要注意的选项&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#计算氢时需要注意的选项&quot; id=&quot;markdown-toc-计算氢时需要注意的选项&quot;&gt;计算氢时需要注意的选项&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#计算氦时需要注意的选项&quot; id=&quot;markdown-toc-计算氦时需要注意的选项&quot;&gt;计算氦时需要注意的选项&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#其他需要注意的选项&quot; id=&quot;markdown-toc-其他需要注意的选项&quot;&gt;其他需要注意的选项&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#pandora运行种类&quot; id=&quot;markdown-toc-pandora运行种类&quot;&gt;PANDORA运行种类&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#平面平行层大气与球面大气&quot; id=&quot;markdown-toc-平面平行层大气与球面大气&quot;&gt;平面平行层大气与球面大气&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#运行&quot; id=&quot;markdown-toc-运行&quot;&gt;运行&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#输出&quot; id=&quot;markdown-toc-输出&quot;&gt;输出&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#输出文件里面的坑&quot; id=&quot;markdown-toc-输出文件里面的坑&quot;&gt;输出文件里面的坑&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#错误处理&quot; id=&quot;markdown-toc-错误处理&quot;&gt;错误处理&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#迭代中的错误处理&quot; id=&quot;markdown-toc-迭代中的错误处理&quot;&gt;迭代中的错误处理&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#其他错误处理&quot; id=&quot;markdown-toc-其他错误处理&quot;&gt;其他错误处理&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#输出结果阅读理解&quot; id=&quot;markdown-toc-输出结果阅读理解&quot;&gt;输出结果阅读理解&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#options&quot; id=&quot;markdown-toc-options&quot;&gt;OPTIONS&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#tables&quot; id=&quot;markdown-toc-tables&quot;&gt;TABLES&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#iterates&quot; id=&quot;markdown-toc-iterates&quot;&gt;ITERATES&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#示例文件&quot; id=&quot;markdown-toc-示例文件&quot;&gt;示例文件&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#示例一&quot; id=&quot;markdown-toc-示例一&quot;&gt;示例一&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#示例二&quot; id=&quot;markdown-toc-示例二&quot;&gt;示例二&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#示例三&quot; id=&quot;markdown-toc-示例三&quot;&gt;示例三&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#示例四&quot; id=&quot;markdown-toc-示例四&quot;&gt;示例四&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#示例六&quot; id=&quot;markdown-toc-示例六&quot;&gt;示例六&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#需要留意的参数们&quot; id=&quot;markdown-toc-需要留意的参数们&quot;&gt;需要留意的参数们&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;fortran-编译器选择&quot;&gt;Fortran 编译器选择&lt;/h2&gt;

&lt;p&gt;可以从pgfortran、ifort和pgf77中选一个。我选的是ifort；关于ifort的安装可以参照&lt;a href=&quot;https://www.jianshu.com/p/c6fec68966f7&quot;&gt;这里&lt;/a&gt;。实际上安装的是Intel® Parallel Studio XE Cluster Edition for Linux*里面的Fortran编译器。装之前或者之后记得将这些32位的包装上：&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;ia32-libs
apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;libstdc++5
apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;lib32stdc++6
apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;libc6-dev-i386
apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;gcc-multilib
apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;g++-multilib
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;要不然一会PANDORA是装不上的hhh。&lt;/p&gt;

&lt;p&gt;会有&lt;code class=&quot;highlighter-rouge&quot;&gt;Unsupported OS&lt;/code&gt;的提示，跳过即可。
如果位置不够的话可以将其他不需要的软件包取消掉，和Fortran有关的只有3个G左右的东西。&lt;/p&gt;

&lt;h2 id=&quot;安装perl&quot;&gt;安装Perl&lt;/h2&gt;

&lt;p&gt;这个算是半必须的，在后面更新文件的时候作者写了个方便的perl脚本来更新，所以不装的话就得手动了。Ubuntu的具体安装方法参见&lt;a href=&quot;https://blog.csdn.net/JohnwayChan/article/details/79066960&quot;&gt;这里&lt;/a&gt;。&lt;/p&gt;

&lt;h2 id=&quot;文件准备&quot;&gt;文件准备&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;文件分为9个部分，其中6个是有内容的，三个是单纯用来分割的(GO部分)&lt;/li&gt;
  &lt;li&gt;可以将输入放在别的文件里面，用&lt;code class=&quot;highlighter-rouge&quot;&gt;USE (ATOM/MODEL/RESTART/INPUT/GENERAL)&lt;/code&gt;跑到对应文件(&lt;code class=&quot;highlighter-rouge&quot;&gt;.atm&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;.mod&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;)那里去读取；在对应文件中使用&lt;code class=&quot;highlighter-rouge&quot;&gt;USE (INPUT)&lt;/code&gt;退回到主控制文件；下一次对于该辅助文件的的读取将会在该位置继续进行。如果定义了&lt;code class=&quot;highlighter-rouge&quot;&gt;FILE ( 0 FILESPEC )&lt;/code&gt;（wup105页），则&lt;code class=&quot;highlighter-rouge&quot;&gt;USE (GENERAL)&lt;/code&gt;会去那个文件那里读。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;除了这几个部分之外，我们还有几个Group（组）：&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;恒星大气模型&lt;/li&gt;
  &lt;li&gt;原子/离子模型&lt;/li&gt;
  &lt;li&gt;能级/跃迁相关的重启数据&lt;/li&gt;
  &lt;li&gt;与运行相关的数字和控制选项&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;第1、第2组数据必须提供；从0开始的运行的话第3组可以不提供；第4组基本上不用提供。&lt;/p&gt;

&lt;h3 id=&quot;格式大坑&quot;&gt;格式大坑&lt;/h3&gt;

&lt;p&gt;在写&lt;code class=&quot;highlighter-rouge&quot;&gt;Z&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;TE&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;NH&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;NE&lt;/code&gt;等比较大的表格的时候需要按如下格式写：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Z  ( &amp;gt;
-8.53000000E+05 -6.53000000E+05 -4.66000000E+05 -2.25000000E+05  0.00000000E+00
) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;不可以写成一行！虽然我也不知道为什么但是写成一行的话log文件会报类似这样的错：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 2019-Jun-20 20:18:24  #                Read input, part 2              
 Current contents of the caller stack:
   1 YARTY                           
   2  TRENT                           
   3   TAY                             
   4    BUSY                            
   5     NADINE                          
   6      VANILLA                         
   7       MOCHA                           
   8        BASIL                           
   9         ARRAN                           
  10          ABORT                           
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后aaa文件的&lt;code class=&quot;highlighter-rouge&quot;&gt;INPUT NOTES&lt;/code&gt;会有这样的错误提示：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; Error reading FLTPT array: Z       

 List of valid control fields:

              R         r         I         i         S         s         M         m         F         f
       )       

 Current input field: &quot;Z       &quot;



         10        20        30        40        50        60        70        80
 ....-....+....-....+....-....+....-....+....-....+....-....+....-....+....-....+
 TE (  &amp;gt;                                                                         
   *

 Unrecognizable control field. See list above.               
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;并在&lt;code class=&quot;highlighter-rouge&quot;&gt;CONSTRAIN&lt;/code&gt;之后停下来。&lt;/p&gt;

&lt;h3 id=&quot;元素数据输入wup-section-10&quot;&gt;元素数据输入(WUP Section 10)&lt;/h3&gt;

&lt;p&gt;需要有元素才能计算电子密度等量。程序中有一个&lt;code class=&quot;highlighter-rouge&quot;&gt;NMT&lt;/code&gt;行（就是有多少种元素，默认为38）9列的一个表。9列的内容分别为：元素符号(M)、原子序数(atno)、相对氢的丰度(AB)，电离能(CHI)，配分方程U-I和U-II(UI, UII)，以氢为12的对数丰度(LAB)，对数丰度的默认值(DEF)，表示默认值ref的整数(k)。当然并不是所有的内容都要手动指明。&lt;/p&gt;

&lt;p&gt;和默认值不一样的数据需要手动输入；如果是默认表里没有的元素需要用&lt;code class=&quot;highlighter-rouge&quot;&gt;NEWELE&lt;/code&gt;命令：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NEWELE ( j M atno AB CHI UI UII LAB DEF k )&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;这里的&lt;code class=&quot;highlighter-rouge&quot;&gt;j&lt;/code&gt;代表着程序内建表的第j行，我们可以通过不同的j将表中的某一行覆盖掉。。&lt;/p&gt;

&lt;p&gt;如果是更改某个已有元素的丰度，则可以用&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT&lt;/code&gt; 命令：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT ( M I1 I2 ... In )&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;其中M当然是要改变的元素符号了，而后面的I是成对出现的，第一个I指名要改变的数字名称（ATNO, AB, CHI, UI, UII, LAB），第二个I指名要改成的数字。举个例子，&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT ( FE AB 3.5E-5 CHI 7.87 UI 24 )&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;会将铁元素的丰度改为0.000035，电离能改为7.87，配分函数U-I改为24。如果有离子的话（比如HeI和HeII）记得一起都改，要不然程序会报错。&lt;/p&gt;

&lt;p&gt;在选择上，可以用&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT&lt;/code&gt;的就不要用&lt;code class=&quot;highlighter-rouge&quot;&gt;NEWELE&lt;/code&gt;了。&lt;/p&gt;

&lt;p&gt;元素表可以被增减；比如&lt;code class=&quot;highlighter-rouge&quot;&gt;NMT ( 5 )&lt;/code&gt;只取元素表的前5个，&lt;code class=&quot;highlighter-rouge&quot;&gt;NMT ( 39 )&lt;/code&gt;取整个元素表并且最后一行全为0。注意&lt;code class=&quot;highlighter-rouge&quot;&gt;NMT&lt;/code&gt;不能大于50。如果不改变元素表行数的话可以省略这个语句。&lt;code class=&quot;highlighter-rouge&quot;&gt;NMT&lt;/code&gt;语句要在part B，&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;NEWELE&lt;/code&gt;要在part D。&lt;/p&gt;

&lt;p&gt;如果要新加元素，建议用&lt;code class=&quot;highlighter-rouge&quot;&gt;NMT ( 39 )&lt;/code&gt;加一行，再用&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT&lt;/code&gt;语句加元素。只要表里没有&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT&lt;/code&gt;中的元素并且有空行，程序就会添加新的元素；否则程序会停止。&lt;/p&gt;

&lt;p&gt;默认的元素为原子序数1-32, 37-40, 56加上&lt;script type=&quot;math/tex&quot;&gt;\mathrm{H_2}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;在这里我们有两个丰度：AB和LAB。在计算上AB优先于LAB，即只要AB不为0，LAB就会跟据AB的值改变（不管有没有被指定）；只有当AB为0时AB才会根据LAB的值被算出来。同时如果AB小于0，则将AB和LAB都设为0。总之就是不要同时指定AB和LAB就好了。&lt;/p&gt;

&lt;p&gt;参数&lt;code class=&quot;highlighter-rouge&quot;&gt;FABD&lt;/code&gt;可以将除氢氦外所有元素的AB同时扩大FABD倍。&lt;/p&gt;

&lt;p&gt;最终AB=0的元素将被排除。&lt;/p&gt;

&lt;h3 id=&quot;原子结构文件以及原子数密度&quot;&gt;原子结构文件以及原子数密度&lt;/h3&gt;

&lt;p&gt;只需要提供主运行原子的原子结构文件，可以在&lt;code class=&quot;highlighter-rouge&quot;&gt;atom/&lt;/code&gt;文件夹里面找，或者自己写。原子数密度也是需要的，而且和主运行原子不同，我们考虑多少原子就要多少原子的数密度；这个可以由从0开始的PANDORA计算得出。&lt;/p&gt;

&lt;h4 id=&quot;一般信息&quot;&gt;一般信息&lt;/h4&gt;

&lt;p&gt;原子结构文件包含：原子的能级、连续谱、能级的性质、原子能级之间的跃迁性质以及原子能级-连续谱之间的跃迁性质。&lt;/p&gt;

&lt;h5 id=&quot;原子能级&quot;&gt;原子能级&lt;/h5&gt;

&lt;p&gt;原子能级的数量为&lt;code class=&quot;highlighter-rouge&quot;&gt;NL&lt;/code&gt;，必须大于等于2。能级的量子数&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;l&lt;/script&gt;在&lt;code class=&quot;highlighter-rouge&quot;&gt;NLPAIR&lt;/code&gt;中指定（这意味着&lt;code class=&quot;highlighter-rouge&quot;&gt;NLPAIR&lt;/code&gt;的长度为&lt;script type=&quot;math/tex&quot;&gt;\mathrm{NL}\times 2&lt;/script&gt;）。某能级的角量子数&lt;script type=&quot;math/tex&quot;&gt;l_i&lt;/script&gt;可以为-1，这个时候这个能级代表着将主量子数为&lt;script type=&quot;math/tex&quot;&gt;n_i&lt;/script&gt;的所有能级合并在一起的一个合成能级；此时&lt;script type=&quot;math/tex&quot;&gt;n_i&lt;/script&gt;必须大于0。氢原子的默认能级就是&lt;script type=&quot;math/tex&quot;&gt;n_i = i, l_i = -1&lt;/script&gt;。在具体的各个原子能级文件中应该都细化了&lt;script type=&quot;math/tex&quot;&gt;l&lt;/script&gt;值。&lt;/p&gt;

&lt;p&gt;实际运行下来的感觉是，&lt;code class=&quot;highlighter-rouge&quot;&gt;NLPAIR&lt;/code&gt;中的数字应该只起到标示的作用，&lt;code class=&quot;highlighter-rouge&quot;&gt;/atom&lt;/code&gt;里面的&lt;code class=&quot;highlighter-rouge&quot;&gt;NLPAIR&lt;/code&gt;基本上都和内置的能级没有关系；实际上还是按照内置的能级来填写各个参数的。&lt;code class=&quot;highlighter-rouge&quot;&gt;RUNTOPOP&lt;/code&gt;标明了设定能级和内置能级的对应关系，写出来的12345是内置能级名称，这个数组的位置（坑）是设定能级的名称。&lt;/p&gt;

&lt;p&gt;在多重线的情况下，只需指定其中一条，然后在后面用blend line等参数分裂成几条即可：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LDL 4 2 ( 3 ) &amp;gt;
DDL 4 2 ( -1.249 -.0898 0. ) &amp;gt;
CDL 4 2 ( .1111 .3333 .5556 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果碰撞电离系数&lt;code class=&quot;highlighter-rouge&quot;&gt;CI&lt;/code&gt;为默认的话，需要指定每个能级的电子数（这是啥？）&lt;code class=&quot;highlighter-rouge&quot;&gt;QNL&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NU&lt;/code&gt;指定了每个能级的能量，以频率&lt;script type=&quot;math/tex&quot;&gt;10^15 \mathrm{Hz}&lt;/script&gt;作为单位。能量的0点在第一个输入的能级&lt;script type=&quot;math/tex&quot;&gt;\mathrm{NU}^1&lt;/script&gt;处。类似地，&lt;code class=&quot;highlighter-rouge&quot;&gt;NUK&lt;/code&gt;是联系普的能量。&lt;/p&gt;

&lt;p&gt;其他需要的参数为：&lt;code class=&quot;highlighter-rouge&quot;&gt;P&lt;/code&gt;，统计权重；&lt;code class=&quot;highlighter-rouge&quot;&gt;CP&lt;/code&gt;：光致电离截面；&lt;code class=&quot;highlighter-rouge&quot;&gt;ELSYM&lt;/code&gt;，元素符号；以及&lt;code class=&quot;highlighter-rouge&quot;&gt;IONSTAGE&lt;/code&gt;，目标原子电离能级（比如目标是HeI那就是1）。&lt;/p&gt;

&lt;h5 id=&quot;能级之间的跃迁&quot;&gt;能级之间的跃迁&lt;/h5&gt;

&lt;h3 id=&quot;致宽与mass-motion&quot;&gt;致宽与mass motion&lt;/h3&gt;

&lt;h2 id=&quot;输入参数介绍&quot;&gt;输入参数介绍&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;XI&lt;/code&gt;：输出光谱的数据点位置，数值代表距离线心的频率。这玩意必须从0开始，单调递增，以此表示半个轮廓的采样。如果不是默认的话它的长度必须由&lt;code class=&quot;highlighter-rouge&quot;&gt;KS&lt;/code&gt;指定。&lt;/p&gt;

&lt;h2 id=&quot;选项选择&quot;&gt;选项选择&lt;/h2&gt;

&lt;p&gt;这里先仅介绍&lt;code class=&quot;highlighter-rouge&quot;&gt;CALCULATION&lt;/code&gt;部分的选项、它们的默认值以及建议开启的情况。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Name&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;default&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Description&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Comment&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;346 ALLCICE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compute complete set of CI and CE samples.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;由程序控制吧；有的时候没有出现&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;219 AMDIFF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Include ambipolar diffusion.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;在计算氢/氦时建议开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;272 AMDN1&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use “special N1-calculation” for ambipolar diffusion, (used only if AMDIFF=ON) (NOT to be turned off).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;只有当&lt;code class=&quot;highlighter-rouge&quot;&gt;AMDIFF&lt;/code&gt;开启时才有用，永不关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;303 AVCON&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate the average of the continuum intensities I/Hz.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;307 AVELOP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use Averaged Line Opacity.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;245 BDCALC&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Departure Coefficients calculated from all level equations, rather than from the continuum equation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;在计算氢/氦时建议开启。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;161 BEDIT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit calculated departure coefficients, to prevent negative CSF values.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;271 BSMOOTH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Do sequential smoothing of departure coefficients.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;在计算氢时建议开启。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;133 CALCOOL &lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate net cooling rates.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;我认为对计算结果无影响。有需要看数据时建议开启。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;231 CALHEAT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate net heating rates.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;我认为对计算结果无影响。有需要看数据时建议开启。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;328 CEFACTS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use and update CE-enhancement factors when possible and needed.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;330 CHEXLO&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use lower-level charge exchange.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;333 CHEXLOL&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use LTE hydrogen number densities in lower-level charge exchange calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;331 CHEXUP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use upper-level charge exchange.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;339 CLNORM&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compute H Lyman lines normalizing factors (see also option ULNORM).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;305 COCLIPSE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Do Continuum Eclipse calculations for CO-lines wavelengths.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;84 COLTEMP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Color Temperatures.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;80 CONFLUX&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Continuum Flux.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;有需要时开启。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;225 COOLCO&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate CO-lines cooling rate.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;194 COOLCOM&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Composite Lines cooling rate (only if only one band).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;140 COOLINT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate integrated net cooling and heating rates.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;196 COOLXRAY&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate X-rays cooling rate.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;184 CPSW&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Adjust total Hydrogen density to give constant pressure, (used only if HSE=OFF).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;46 CSF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use computed Continuum Source Function when calculating Line Source function.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;166 CSFB&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;In line source function calculation: set BC = min(CSF, B), (if =OFF then BC = CSF); (used only if CSF=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;14 CSWITCH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*OFF&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use level-1 TR in calculation of Stimulated Emission factors for BC; (if =OFF then use TE).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;233 DOION&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Do all the normal calculations related to the ion-of-the-run.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;266 DSMOOTH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Do sequential smoothing in diffusion calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;与diffsuion有关，在计算氢/氦时开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;212 DUSTEMP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate new Type-2 Dust Temperature table; (used only if DUSTYPE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;99 DUSTYPE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use Type-2 method to calculate dust opacity.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;6 ECLIPSE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Continuum Eclipse Intensity (for negative “Additional Wavelengths” only).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;不明，可能需要和WAVES配合使用；一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;208 EMERBACK&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Intensity and Flux emerging from back face of finite atmosphere.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;对氦线可能有用，不过与外部光源不一样；demo中没有开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;55 EMERINT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate emergent continuous intensities.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氢氦时开启，应该对计算贡献函数有用&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;38 ENHANCE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use R**2 enhancement factor in the calculation of emergent intensities; (will be switched OFF if SPHERE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;71 ENL&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit negative values out of EP1, by interpolation using neighboring values.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;72 ENL2&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit negative values out of EP1, by shifting the whole set of values.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;122 EPSNEDC&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit out negative values of “Lyman” EP1, when the “CHAIN” method (i.e. METEP=3) is used.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;185 EPSW&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Replace any Source Function Epsilons less than -0.9999 by -0.9999.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;169 EXPAND&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;This run is for an expanding atmosphere.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;重要；大气有运动的时候需要打开&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;178 FELE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate rates due to fast electrons.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;存疑；一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;177 FELEC&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use results of fast electrons calculation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;存疑；一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;49 FINITE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;In this calculation the medium is of finite extent.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;335 FLWBROAD&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compute flow-broadened profiles.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;60 GDS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use geometrical dilution terms; (will be switched OFF if SPHERE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;244 GNVCALC&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Determine the diffusion term GNV-1 from the non-local N-1 calculation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;332 GTNSMTH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smooth STIM when calculating GTN(u,l).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;275 GTNSTIM&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use departure coefficients, instead of number densities, in STIM for GTN(u,l).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;273 HBROAD&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;In a Hydrogen run, include collisional broadening for transitions above level 5.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;281 HEABD&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate depth dependence of helium abundance (used only if AMDIFF=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭，但可能有用&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;230 HENORM&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Renormalize helium number densities in the diffusion calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;存疑；默认即可？&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;68 HMS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate a non-LTE H- source function.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氢时可开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;16 HSE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate hydrostatic equilibrium; (will be switched OFF if SPHERE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氢时可开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;270 HSEV&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Include expansion velocity in the hydrostatic equilibrium equation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;61 ILRT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Incident Line Radiation term, (used only if INCIDNT=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;78 INBED&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit negative values out of initial values of BD-ratios, (used only if RHOFUDGE=OFF).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;51 INCIDNT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*OFF&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;The external radiation field is incident upon the back face of the finite medium; (unless INCIFRONT=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;加外部光源的时候有用，一般和INCIFRNT一起&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;141 INCIFRNT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Radiation incident upon the front face of the medium, finite or semi-infinite (used only if INCIDNT=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;加外部光源的时候有用&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;312 IRHWED&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit input values of RHOWT.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;237 JBDNC&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Bypass the comparative calculation of b-ratios that are not used.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;9 LIGHT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Line spectra.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;313 LINECOMP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compare results from line source function and composite line calculations (see also LINECDMP).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;33 LTE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate LTE line intensity and flux profiles.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭；可能在计算光球层线的时候有用？&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;13 LYMAN&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Calculate Level-N-to-Continuum (“Lyman”) transfer.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;存疑；氢时可开启？&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;54 MONOTAU&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Force the calculated TAU values to increase monotonically.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;306 NEDIT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit number densities (for positive source functions).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;56 NESWICH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compute NE in detail, (if OFF then set NE = NP).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;35 NHADJ&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Adjust recomputed total hydrogen density so that TAU5000 = 1 at Z = 0, (used only if HSE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启；重要，确定了Z与&lt;script type=&quot;math/tex&quot;&gt;\tau&lt;/script&gt;的关系&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;319 NRSMOOTH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smooth the nl/n1 ratios in the diffusion calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;262 OPANEG&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit negative line opacity only to keep total opacity positive.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;344 OPTHINL&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use the optically-thin-limit approximation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;135 ORT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;The internal radiation travels in the outward direction only.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;165 PARTVAR&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Let Partition Functions vary with depth.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;5 PHASE2&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Spectrum calculations, and spectrum summary analyses.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;158 POPBSW&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Set higher departure coefficients of population ions equal to highest computed non-LTE values.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;337 PRDMETH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use the Hubeny-Lites, instead of the Kneer-Heasley, formulation for PRD.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;79 PTN&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit negative values out of integrands used to compute TAU.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;168 QSFEDIT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit QSF (i.e. P.R.D. modified source function).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;50 REFLECT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*OFF&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;The finite medium is symmetric about the last specified depth, (used only if FINITE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;150 RHEDIT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit calculated net radiative bracket.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氢氦时开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;106 RHOFUDGE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Fudge RHO values as necessary, to obtain acceptable values from the BD-ratio calculation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;204 RHOWOPT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use “Artificial TAU” in RHO/W calculation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;334 RKINCR&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Enhance RK artificially (factors RKMULT).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;147 RSMOOTH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Do sequential smoothing of RHO values.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氢氦时开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;62 RSQUARE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Let the Dilution Factor vary with depth.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;263 SDIRECT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Replace negative line source function values in “DIRECT” calculations by interpolated values.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;149 SEDIT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Edit calculated line source function.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;145 SEDITIF&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Remove negatives from frequency-dependent line source functions used for intensity and flux profiles.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;83 SLYR&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Smooth out the computed “Lyman” RK1 values.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;氢氦时关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;172 SNUSHFT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apply frequency shift to P.R.D. Snu used in emergent line profile calculation.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;31 SPHERE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use spherical coordinates for source function calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;重要；控制模型几何性质&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;156 SPHETAU&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compute TAU(ray) by quadratic integration, (if =OFF then use trapezoidal rule); (used only if SPHERE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;8 SPHOUT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use spherical coordinates to calculate Line and Continuum fluxes; (will be switched ON if SPHERE=ON).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;会随着SPHERE开关，不用自己控制&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;310 SSMOOTH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Do sequential smoothing for S-from-number densities.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;存疑；多数时候关闭？&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;304 STKWATT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Attenuate Hydrogen Stark components outside the Doppler core at each depth.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;存疑；默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;163 TANG&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Include the ray tangent to each depth in angle integrations for spherical coordinates, (used only if NTAN=1).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;299 TRUECONT&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compute line-free continuum as needed for exhibiting residual line profiles.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;340 ULNORM&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use H Lyman lines normalizing factors (see also option CLNORM).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认开启&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;154 USENCJ&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Compute Jnu directly, rather than from source function.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;53 USETRIN&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use the specified input values of TR to calculate RK and RL.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;取决于具体情况；一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;321 USETSM&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Eliminate TAU less than TSM from emergent intensity and from continuum JNU calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;221 VELGRAD&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Include velocity gradient terms in statistical equilibrium calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;265 VELS&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use calculated diffusion velocity in source function calculations.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;214 VESCAPE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use Voigt expression for the escape probability.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;173 VSWITCH&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use two broadening velocities, (if =OFF then use a single broadening velocity).&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;124 WATESTE&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use logarithmic style of weighting for “Lyman” EP1,EP2.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认打开&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;123 WATESTR&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*on&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Use logarithmic style of weighting for RHO.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;默认打开&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;326 ZCOMP&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;*off&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;When mass is prescribed, adjust Z so that computed mass matches input mass table.&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;一般关闭&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;需要注意的选项&quot;&gt;需要注意的选项&lt;/h3&gt;

&lt;h4 id=&quot;计算氢时需要注意的选项&quot;&gt;计算氢时需要注意的选项&lt;/h4&gt;

&lt;p&gt;开：&lt;code class=&quot;highlighter-rouge&quot;&gt;AMDIFF, BDCALC, BSMOOTH, DSMOOTH, EMERINT, HMS, HSE (SPHERE打开时关闭), RHEDIT, RSMOOTH&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;关：&lt;code class=&quot;highlighter-rouge&quot;&gt;SLYR&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;打开&lt;code class=&quot;highlighter-rouge&quot;&gt;AMDIFF, HSE&lt;/code&gt;时可能需要指定其他参数，否则会报错；&lt;code class=&quot;highlighter-rouge&quot;&gt;BDCALC, EMERINT, RHEDIT&lt;/code&gt;打开之后谱线形状不错；所有带&lt;code class=&quot;highlighter-rouge&quot;&gt;SMOOTH&lt;/code&gt;的参数打开之后会报错。&lt;/p&gt;

&lt;h4 id=&quot;计算氦时需要注意的选项&quot;&gt;计算氦时需要注意的选项&lt;/h4&gt;

&lt;p&gt;开：&lt;code class=&quot;highlighter-rouge&quot;&gt;AMDIFF, BDCALC, DSMOOTH, EMERINT, RHEDIT, RSMOOTH&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;关：&lt;code class=&quot;highlighter-rouge&quot;&gt;SLYR&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;实验证明球面下打开以及关闭上述选项对He 10830线没有影响。&lt;/p&gt;

&lt;h4 id=&quot;其他需要注意的选项&quot;&gt;其他需要注意的选项&lt;/h4&gt;

&lt;p&gt;CONFLUX：有需要时开启。
EXPAND：大气速度
INCIDNT, INCIFRNT：外部光源
SPHERE：平面平行层或球面
RHEDIT：打开它的话需要指定另外的变量，暂不知道&lt;/p&gt;

&lt;h2 id=&quot;pandora运行种类&quot;&gt;PANDORA运行种类&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;氢的占据数更新&lt;/li&gt;
  &lt;li&gt;除了氢外的其他占据数更新&lt;/li&gt;
  &lt;li&gt;一般运行（应该是输出谱线的）&lt;/li&gt;
  &lt;li&gt;无离子运行&lt;/li&gt;
  &lt;li&gt;仅连续谱运行&lt;/li&gt;
  &lt;li&gt;仅输入运行&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;第1、2和第3种的区别在于，在计算谱线和连续谱吸收的时候，我们需要各个元素原子(H, HeI, HeII, CI, SiI, AlI, MgI, FeI, NaI, CaI, OI)以位置/深度为自变量的数密度以及偏离系数。这两者可以为默认的LTE/LTE计算出来的值或者是输入量。而在每次运行结束后，程序会提供对应本次运行主元素（比如SiI）的新的数密度以及偏离系数，而它们可以在下次中用作输入参数。所以当&lt;code class=&quot;highlighter-rouge&quot;&gt;POPUP&lt;/code&gt;打开时，PANDORA会将这些结果写到restart文件里面，这对应一次更新运行；而当&lt;code class=&quot;highlighter-rouge&quot;&gt;POPUP&lt;/code&gt;关闭时则为一般运行。这些数据可以通过&lt;code class=&quot;highlighter-rouge&quot;&gt;SILPRNT&lt;/code&gt;打印出来。参数&lt;code class=&quot;highlighter-rouge&quot;&gt;RUNTOPOP&lt;/code&gt;比较重要，它应该指定了用哪些参数。&lt;/p&gt;

&lt;p&gt;第1种(?)无离子运行意味着PANDORA只将氢作为运行对象。这个时候会重新计算&lt;code class=&quot;highlighter-rouge&quot;&gt;Z&lt;/code&gt;（几何深度）、&lt;code class=&quot;highlighter-rouge&quot;&gt;NH&lt;/code&gt;（总的氢原子数密度）、&lt;code class=&quot;highlighter-rouge&quot;&gt;NE&lt;/code&gt;（电子数密度）等；这些基本上是之后的运行所需要的。其他种类的运行并不会重新计算这些东西。&lt;/p&gt;

&lt;p&gt;第5种仅连续谱运行和实际情况相去甚远。第4种运行做的事情比第5种多，但是性质类似。&lt;/p&gt;

&lt;p&gt;第6种单纯检查输入参数是否足够以及正确。检查完，输出Phase0部分，就停下了。&lt;/p&gt;

&lt;p&gt;有几个参数控制程序为哪一种运行：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;JSTCN&lt;/code&gt;控制是否进行“连续谱运行”：&amp;gt;0为连续谱运行，=0不是；具体数字可以控制输入参数，请参阅wup的86页。&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;JSTIN&lt;/code&gt;控制是否进行“仅输入运行”：&amp;gt;0为仅输入运行，=0不是&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NOION&lt;/code&gt;控制是否进行“无离子运行”：=1为无离子运行，=0不是&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;JSTCN&lt;/code&gt;与&lt;code class=&quot;highlighter-rouge&quot;&gt;JSTIN&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;JSTCN&lt;/code&gt;与&lt;code class=&quot;highlighter-rouge&quot;&gt;NOION&lt;/code&gt;不可同时大于0&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;另外的运行选项：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ISCRS&lt;/code&gt;：如果打开则占用很多内存&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;这里提到的所有选项都为数字(&lt;code class=&quot;highlighter-rouge&quot;&gt;JSTCN&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;JSTIN&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;NOION&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ISCRS&lt;/code&gt;)，后边三个也可以分别用&lt;code class=&quot;highlighter-rouge&quot;&gt;JSTIN&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;DOION&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ISCRS&lt;/code&gt;选项来控制。&lt;/p&gt;

&lt;h2 id=&quot;平面平行层大气与球面大气&quot;&gt;平面平行层大气与球面大气&lt;/h2&gt;

&lt;p&gt;如果用球面大气的话需要打开&lt;code class=&quot;highlighter-rouge&quot;&gt;DO ( SPHERE )&lt;/code&gt;，并且需要指定&lt;code class=&quot;highlighter-rouge&quot;&gt;R1N&lt;/code&gt;.暂时不知道为什么要加上R1N.&lt;/p&gt;

&lt;h2 id=&quot;运行&quot;&gt;运行&lt;/h2&gt;

&lt;p&gt;把所有文件准备好之后，在同一个目录下运行&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/pandora&lt;/code&gt;就可以了；当然后面要加上一些参数，比如：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/pandora [options] &amp;lt;atm-model-name&amp;gt; &amp;lt;atom-name&amp;gt; &amp;lt;atom-n-levels&amp;gt; &amp;lt;run-id&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    -inp   &amp;lt;input-dir&amp;gt;,       def.: .
    -out   &amp;lt;output-dir&amp;gt;,      def.: .
    -io    &amp;lt;dir&amp;gt;, equivalent to -inp &amp;lt;dir&amp;gt; -out &amp;lt;dir&amp;gt;
    -stats &amp;lt;stats-dir&amp;gt;,       def.: stats
    -atoms &amp;lt;atoms-dir&amp;gt;,       def.: atoms
    -opac  &amp;lt;opacities-dir&amp;gt;,   def.: opacities
    -bin   &amp;lt;executable-dir&amp;gt;,  def.: bin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/pandora -io 2/ -atoms 2/ demo2 h    l3 001 &amp;gt;&amp;amp; 2/demo2.log&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-io&lt;/code&gt;指定文件所在的位置，&lt;code class=&quot;highlighter-rouge&quot;&gt;-atmos&lt;/code&gt;指定原子模型文件所在的位置。后面接着的是主控制文件的名称(&lt;code class=&quot;highlighter-rouge&quot;&gt;demo1&lt;/code&gt;)，pandora会在&lt;code class=&quot;highlighter-rouge&quot;&gt;-io&lt;/code&gt;文件夹里面寻找&lt;code class=&quot;highlighter-rouge&quot;&gt;demo1.dat&lt;/code&gt;。之后是本次运行的原子名称，虽然这里没有(&lt;code class=&quot;highlighter-rouge&quot;&gt;none&lt;/code&gt;)但是一般可以是氢(&lt;code class=&quot;highlighter-rouge&quot;&gt;h&lt;/code&gt;)、氦原子(&lt;code class=&quot;highlighter-rouge&quot;&gt;he1&lt;/code&gt;)、硅(&lt;code class=&quot;highlighter-rouge&quot;&gt;si&lt;/code&gt;)等；为了避免理解偏差我建议通通写明运行原子名称。再后面是本次运行的原子的模型，为&lt;code class=&quot;highlighter-rouge&quot;&gt;l&lt;/code&gt;加上能级数，如&lt;code class=&quot;highlighter-rouge&quot;&gt;l15&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;l13&lt;/code&gt;等等，具体可查阅&lt;code class=&quot;highlighter-rouge&quot;&gt;atoms/&lt;/code&gt;里面的文件名；要注意原子结构文件名是&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;atom-name&amp;gt;&amp;lt;atom-n-levels&amp;gt;&lt;/code&gt;，在写命令的时候要对应。再接着是本次运行的名字，如果不想每次重新运行都删文件的话改这个数字（或者字母）就可以了。最后将运行情况输出到指定的&lt;code class=&quot;highlighter-rouge&quot;&gt;.log&lt;/code&gt;文件里。&lt;/p&gt;

&lt;p&gt;这部分wup里面没有明确说出来，但是我觉得应该是这样的。&lt;/p&gt;

&lt;p&gt;另外在准备文件里面也要写明本次运行的原子名称：比如&lt;code class=&quot;highlighter-rouge&quot;&gt;NAME ( HYDROGEN )&lt;/code&gt;这样。&lt;/p&gt;

&lt;h2 id=&quot;输出&quot;&gt;输出&lt;/h2&gt;

&lt;p&gt;主要的输出结果在&lt;code class=&quot;highlighter-rouge&quot;&gt;.aaa&lt;/code&gt;文件里面。但是它太大了（如果输出多的话），所以一般会有&lt;code class=&quot;highlighter-rouge&quot;&gt;.aix&lt;/code&gt;文件作为它的目录。只要是目录里面有的部分都可以用&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/extract 'XXX' SPh.aaa.001 SPh.out.001&lt;/code&gt;来提取，使得世界更美好。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;输出提取&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/extract 'LINE (5/1)' SPh.aaa.001 SPh.line_5-1.out.001&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;PANDORA有自带的输出部分提取程序（作者也知道输出文件巨长…..），看了上面的例子就懂了。提取的部分名称可以到&lt;code class=&quot;highlighter-rouge&quot;&gt;.aix&lt;/code&gt;文件里面去看，它相当于一个目录。&lt;code class=&quot;highlighter-rouge&quot;&gt;.aix&lt;/code&gt;文件的第一列是一个各个部分的唯一标识码（如&lt;code class=&quot;highlighter-rouge&quot;&gt;PSN144705&lt;/code&gt;），可以通过这个码来提取各个部分。&lt;/p&gt;

&lt;h3 id=&quot;输出文件里面的坑&quot;&gt;输出文件里面的坑&lt;/h3&gt;

&lt;p&gt;这里会记录得比较散。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;LINE (X/Y)&lt;/code&gt;中的&lt;code class=&quot;highlighter-rouge&quot;&gt;KPC&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;KL&lt;/code&gt;（还有其他的吸收系数）都是已经乘上了密度的&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;错误处理&quot;&gt;错误处理&lt;/h2&gt;

&lt;p&gt;我不会告诉你我是突然间顿悟这个东西的…..&lt;/p&gt;

&lt;p&gt;还记得在格式大坑里面我提到的log文件中报的错误么？从1到10有一堆不明所以的名字。那其实是用来在aaa文件里面定位错误的，在&lt;code class=&quot;highlighter-rouge&quot;&gt;ABORT&lt;/code&gt;上一行的名字就是aaa文件中报错的地方，复制然后到aaa文件中去找就好了。&lt;/p&gt;

&lt;h3 id=&quot;迭代中的错误处理&quot;&gt;迭代中的错误处理&lt;/h3&gt;

&lt;p&gt;如果pandora能够运行，但是跑着跑着停了，在terminal中&lt;code class=&quot;highlighter-rouge&quot;&gt;ABORT: run stopped because of an error.&lt;/code&gt;以及在aaa文件中的ITERATION后面有一大堆这样的错误：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$%&amp;amp;:     MOTOR               Message
-------------------------------------------------------------------------------------------------------------------------------

Matrix inversion failed:                     Script-M matrix for CSF, lambda =  1.250000000000E+02 (SUB  0, OVR  1)          

%&amp;amp;$:     MOTOR               End of Output                                     ................................................
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;就意味着有某个或者某些需要指定的变量未指定，需要看看是哪个；具体是哪个我也不知道hhhh。&lt;/p&gt;

&lt;h3 id=&quot;其他错误处理&quot;&gt;其他错误处理&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Error in LUCK : trying to Open/formatted for read on unit   8; IOSTAT =        29&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;这个具体是指没有找到&lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;文件，加上就好了；其他的话去说明文档里面看看&lt;code class=&quot;highlighter-rouge&quot;&gt;unit&lt;/code&gt;对应的文件，检查一下有没有。&lt;/p&gt;

&lt;h2 id=&quot;输出结果阅读理解&quot;&gt;输出结果阅读理解&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/lookat.x&lt;/code&gt;提供了一个在命令行里面阅读的程序，里面有解释；不过这都是老黄历的东西了，还是用extract出来用编辑器看方便。&lt;/p&gt;

&lt;p&gt;这里就顺着&lt;code class=&quot;highlighter-rouge&quot;&gt;.aix&lt;/code&gt;文件提供的目录去看看输出文件&lt;code class=&quot;highlighter-rouge&quot;&gt;.aaa&lt;/code&gt;里面有些什么东西，哪些东西比较重要。&lt;/p&gt;

&lt;h3 id=&quot;options&quot;&gt;OPTIONS&lt;/h3&gt;

&lt;p&gt;顾名思义就是控制程序的所有选项（看这个长度我觉得可以认为是所有的），分为&lt;code class=&quot;highlighter-rouge&quot;&gt;PRINTOUT&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;CALCULATION&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;MISCELLNEOUS&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;TEST/DEBUG&lt;/code&gt;。所有的选项名称都和wup里面的选项名称对应，输出中也包含了选项的开关以及解释。&lt;/p&gt;

&lt;h3 id=&quot;tables&quot;&gt;TABLES&lt;/h3&gt;

&lt;p&gt;这里主要是谱线计算的一些事先算好的表格，有用信息似乎不多。&lt;/p&gt;

&lt;h3 id=&quot;iterates&quot;&gt;ITERATES&lt;/h3&gt;

&lt;p&gt;呈现的是各个参数（不是全部）各次迭代除以最后一次的比例。&lt;/p&gt;

&lt;h2 id=&quot;示例文件&quot;&gt;示例文件&lt;/h2&gt;

&lt;p&gt;这里给出了7个示例，前4个有详细说明。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;示例一是单文件作为输入的第1种运行（氢的占据数更新）&lt;/li&gt;
  &lt;li&gt;示例二和示例一是一样的，只不过用了多个输入文件&lt;/li&gt;
  &lt;li&gt;示例三是示例二的重启运行&lt;/li&gt;
  &lt;li&gt;示例四是从0开始的第3种运行&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;示例一&quot;&gt;示例一&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/pandora -io 1/ -atoms 1/ demo1 none '' 001 &amp;gt;&amp;amp; 1/demo1.log&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;有几个地方是需要看看运行效果的：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;“Plot of log10s of ST…“中&lt;script type=&quot;math/tex&quot;&gt;S(n)&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;S&lt;/script&gt;应该要接近&lt;/li&gt;
  &lt;li&gt;在RHO AND RBD中的”Consistency CHECKS”的数字如果接近1，则说明可以（但是不代表迭代完成了）&lt;/li&gt;
  &lt;li&gt;LEVEL 1 TO K中RK-1的”Old/New”数字应该靠近1&lt;/li&gt;
  &lt;li&gt;最后的”Iterative Ratio”不应该有大的波动&lt;/li&gt;
  &lt;li&gt;NE不应该有大的波动（在哪里？）&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.atm&lt;/code&gt;文件和主控制文件必须分开，这里只是简单地将主控制文件复制了一份。&lt;/p&gt;

&lt;h3 id=&quot;示例二&quot;&gt;示例二&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/pandora -io 2/ -atoms 2/ demo2 h    l3 001 &amp;gt;&amp;amp; 2/demo2.log&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;之前说了示例二和示例一是完全一样的，只是将文件分开了，那么为什么命令也不一样了呢？实际上有本质区别的只有&lt;code class=&quot;highlighter-rouge&quot;&gt;h&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;l3&lt;/code&gt;两个地方,&lt;code class=&quot;highlighter-rouge&quot;&gt;l3&lt;/code&gt;指明了原子结构文件的文件名为&lt;code class=&quot;highlighter-rouge&quot;&gt;hl3.atm&lt;/code&gt;，而&lt;code class=&quot;highlighter-rouge&quot;&gt;h&lt;/code&gt;指明了主控制文件的文件名为&lt;code class=&quot;highlighter-rouge&quot;&gt;demo2h.dat&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.dat&lt;/code&gt;文件可以分为&lt;code class=&quot;highlighter-rouge&quot;&gt;.mod&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;.atm&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;.dat&lt;/code&gt;文件，对应wup361页示例一中提到四个Group。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.atm&lt;/code&gt;：原子/离子的模型数据&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.mod&lt;/code&gt;：大气模型的数据&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;：&lt;code class=&quot;highlighter-rouge&quot;&gt;.rst&lt;/code&gt;文件提供的数据以及Lyman计算&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.dat&lt;/code&gt;：文件头、控制选项、文件结构(&lt;code class=&quot;highlighter-rouge&quot;&gt;GO&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;具体内容其实没什么所谓，是用&lt;code class=&quot;highlighter-rouge&quot;&gt;USE&lt;/code&gt;语句控制的。不过这么划分对批处理有好处。&lt;/p&gt;

&lt;h3 id=&quot;示例三&quot;&gt;示例三&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/pandora -io 3/ -atoms 3/ demo3 h    l3 001 &amp;gt;&amp;amp; 3/demo3.log&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;示例三是示例二的重启运行（人类的本质是复读机，对吧）。这个时候示例二中提到的&lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;文件实际上就是输出的&lt;code class=&quot;highlighter-rouge&quot;&gt;.rst&lt;/code&gt;文件。如果不改名字的话，可以先将旧的&lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;文件删掉，再将&lt;code class=&quot;highlighter-rouge&quot;&gt;.rst&lt;/code&gt;改成&lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;。其次是恒星大气模型中从0(或LDR)开始计算的一些值：&lt;code class=&quot;highlighter-rouge&quot;&gt;NE&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;NP&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;HN 1&lt;/code&gt;, …, &lt;code class=&quot;highlighter-rouge&quot;&gt;HN 15&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;BDH 1&lt;/code&gt;, …, &lt;code class=&quot;highlighter-rouge&quot;&gt;BDH 15&lt;/code&gt;现在是从&lt;code class=&quot;highlighter-rouge&quot;&gt;.pop&lt;/code&gt;文件中复制过来的。&lt;code class=&quot;highlighter-rouge&quot;&gt;.msc&lt;/code&gt;中也会有一些更新了的参数，比如说&lt;code class=&quot;highlighter-rouge&quot;&gt;FNRMLA&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;FNRMLB&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;示例二中的&lt;code class=&quot;highlighter-rouge&quot;&gt;hl2.atm&lt;/code&gt;可以直接拿到示例三中使用（我估计以后我也是这么做），但是作者这里还加了点东西。有一些东西是&lt;code class=&quot;highlighter-rouge&quot;&gt;atom/&lt;/code&gt;的文件里面没有的，所以还是要具体看看加了什么。&lt;/p&gt;

&lt;p&gt;示例三的&lt;code class=&quot;highlighter-rouge&quot;&gt;.dat&lt;/code&gt;也被改变了。&lt;/p&gt;

&lt;h3 id=&quot;示例四&quot;&gt;示例四&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bin/pandora -io 4/ -atoms 4/ demo4 mg2  l2 001 &amp;gt;&amp;amp; 4/demo4.log&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;这是一个Mg-II的从0开始的运行；&lt;code class=&quot;highlighter-rouge&quot;&gt;.atm&lt;/code&gt;里面是Mg的一个二能级模型，用的是PRD。但是PRD参数并不储存在&lt;code class=&quot;highlighter-rouge&quot;&gt;.atm&lt;/code&gt;里面（因为RD信息和原子模型没有关系）。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;GMMA&lt;/code&gt;似乎是PRD的一个好坏目标？越接近-1越好的样子。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.mod&lt;/code&gt;文件里面包含了H, He-I, He-II, C-I, Si-I的密度信息(&lt;code class=&quot;highlighter-rouge&quot;&gt;XXK&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;XXN&lt;/code&gt;等)；这些是之前占据数更新运行的结果。&lt;/p&gt;

&lt;p&gt;重启这个示例的运行也是很简单的，删掉&lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;文件，将&lt;code class=&quot;highlighter-rouge&quot;&gt;.rst&lt;/code&gt;改成&lt;code class=&quot;highlighter-rouge&quot;&gt;.res&lt;/code&gt;；同理将&lt;code class=&quot;highlighter-rouge&quot;&gt;.jnr&lt;/code&gt;改成&lt;code class=&quot;highlighter-rouge&quot;&gt;.jnu&lt;/code&gt;，把&lt;code class=&quot;highlighter-rouge&quot;&gt;.dat&lt;/code&gt;文件里面该改的改掉。注意&lt;code class=&quot;highlighter-rouge&quot;&gt;JNUNC&lt;/code&gt;需要大于0。&lt;/p&gt;

&lt;h3 id=&quot;示例六&quot;&gt;示例六&lt;/h3&gt;

&lt;p&gt;示例六是一个很重要的例子。这里面的模型实际上就是Dupree+2013中的巨星模型。由于它比较重要，在这里我们逐行解释模型和输入文件的意思。&lt;/p&gt;

&lt;p&gt;我们要解决的问题：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;为什么简单模型里面提高TR温度会使得H-alpha线变成发射而Dupree+13中的不会？是因为有些选项不是默认了吗？&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;我们从leidh.dat以及leid.mod开始。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; LEID       MODEL LEID   5 L H        ITER 07-17     13-Oct-24
&amp;gt;  ---------1------------1------------1------------1------------1
&amp;gt;
USE ( MODEL ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;一开始我们就从leid.dat跳到了leid.mod中，读取leid.mod中的行直到遇上&lt;code class=&quot;highlighter-rouge&quot;&gt;USE ( INPUT ) &amp;gt; &lt;/code&gt;。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt;
&amp;gt;   M O D E L   LEID
&amp;gt;
omit ( AVELOP ) &amp;gt;
OMIT ( AVOPRNT ) &amp;gt;
omit ( INCIDNT ) &amp;gt;
do ( INCIFRNT ) &amp;gt;
DO   ( INTEDIT ) &amp;gt;
omit ( VTV ) &amp;gt;
omit ( SPHERE ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AVELOP&lt;/code&gt;默认是关闭的，这里写不写都可以。&lt;code class=&quot;highlighter-rouge&quot;&gt;INCIDNT&lt;/code&gt;也应该关闭，除非我们明确有额外的光源从高处照下来。&lt;code class=&quot;highlighter-rouge&quot;&gt;INCIFRNT&lt;/code&gt;虽然开启，但是因为&lt;code class=&quot;highlighter-rouge&quot;&gt;INCIDNT&lt;/code&gt;所以应该是没用的（需要确认）。&lt;code class=&quot;highlighter-rouge&quot;&gt;INTEDIT&lt;/code&gt;应该会改变了输入的温度，但是我觉得不需要开。&lt;code class=&quot;highlighter-rouge&quot;&gt;VTV&lt;/code&gt;会使得&lt;code class=&quot;highlighter-rouge&quot;&gt;VT&lt;/code&gt;(turbulent pressure velocity)和&lt;code class=&quot;highlighter-rouge&quot;&gt;V&lt;/code&gt;(broadening velocity=microturbulent velocity)相等，默认是开启的。不知道为什么要关闭。&lt;code class=&quot;highlighter-rouge&quot;&gt;SPHERE&lt;/code&gt;是最奇怪的一点，论文里面说是球面的，但是这里却关闭了。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;NKA (  9 ) &amp;gt;
NVH ( 23 ) &amp;gt; number of HNDV, VNH values
NGM (  0 ) &amp;gt;
NCQ (  5 ) &amp;gt;
INK (  6 ) &amp;gt; number of XINK, FINK values
LLY (  0 ) &amp;gt;
&amp;gt;
NAB   ( 1 ) &amp;gt; length of BANDL (number of bands)
BANDL ( 3000. )  BANDU ( 8000. ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NKA&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;ZALBK&lt;/code&gt;的长度，默认为2；&lt;code class=&quot;highlighter-rouge&quot;&gt;ZALBK&lt;/code&gt;是背景谱线不透明度的散射反照律常数。不知道为什么后面没有指定这个值。&lt;code class=&quot;highlighter-rouge&quot;&gt;NVH&lt;/code&gt;指定的是前多少个&lt;code class=&quot;highlighter-rouge&quot;&gt;V&lt;/code&gt;的值是从太阳里面来的。&lt;code class=&quot;highlighter-rouge&quot;&gt;NGM&lt;/code&gt;操作和&lt;code class=&quot;highlighter-rouge&quot;&gt;NVH&lt;/code&gt;一致，控制的是G multiplier的值，不要指定为好。&lt;code class=&quot;highlighter-rouge&quot;&gt;NCQ&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;INK&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;LLY&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;NAB&lt;/code&gt;同理。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;N   ( 72 ) &amp;gt;
&amp;gt;
NLH (  15 ) &amp;gt;
NLZ (  13 ) &amp;gt;
NZ2 (  8 ) &amp;gt;
&amp;gt; NLC (  0 ) &amp;gt;
&amp;gt; NLS (  0 ) &amp;gt;
&amp;gt; NAL (  0 ) &amp;gt;
&amp;gt; NMG (  0 ) &amp;gt;
&amp;gt; NFE (  0 ) &amp;gt;
NNA (  8 ) &amp;gt;
&amp;gt; NCA (  8 ) &amp;gt;
&amp;gt; NLO (  14 ) &amp;gt;
&amp;gt; NO2 (  0 ) &amp;gt;
&amp;gt; NO3 (  0 ) &amp;gt;
&amp;gt; NLU (  0 ) &amp;gt;
&amp;gt;
USE ( INPUT ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这一堆&lt;code class=&quot;highlighter-rouge&quot;&gt;NXX&lt;/code&gt;说明的是输入文件中元素能级population被指定的数量，比如&lt;code class=&quot;highlighter-rouge&quot;&gt;NLZ ( 13 )&lt;/code&gt;指的是He-I有13个能级的population被指定，后面肯定有&lt;code class=&quot;highlighter-rouge&quot;&gt;HEN 1-13&lt;/code&gt;这堆东西。&lt;/p&gt;

&lt;p&gt;然后我们就回到leid.dat里面了。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt;
USE ( ATOM ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;使用默认的原子能级数据，不多说了。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;K      ( 55 ) &amp;gt;
kmmax  ( 700 ) &amp;gt;
&amp;gt; kstmax (  35 ) &amp;gt;
NWV ( 11 ) &amp;gt;
&amp;gt; nvx ( 1 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;K&lt;/code&gt;就是&lt;code class=&quot;highlighter-rouge&quot;&gt;KS&lt;/code&gt;，&lt;code class=&quot;highlighter-rouge&quot;&gt;XISYM&lt;/code&gt;的长度；这个玩意儿决定了合成光谱覆盖的长度；这个设置意味着合成光谱还是挺宽的。&lt;code class=&quot;highlighter-rouge&quot;&gt;kmmax&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;XIFUL&lt;/code&gt;的长度限制，防止占用内存太大，我觉得可以不设定。&lt;code class=&quot;highlighter-rouge&quot;&gt;kstmax&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;kst&lt;/code&gt;的最大值，&lt;code class=&quot;highlighter-rouge&quot;&gt;kst&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;XISYMT&lt;/code&gt;的长度。&lt;code class=&quot;highlighter-rouge&quot;&gt;NWV&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;WAVES&lt;/code&gt;的长度，&lt;code class=&quot;highlighter-rouge&quot;&gt;WAVES&lt;/code&gt;是连续谱计算的额外的波长点，设定之后会在输出里面多出一个&lt;code class=&quot;highlighter-rouge&quot;&gt;XX.XX  NANOM&lt;/code&gt;的章节，&lt;code class=&quot;highlighter-rouge&quot;&gt;XX&lt;/code&gt;是设定的波长。&lt;strong&gt;这个设定非常有用，这一节提供了不透明度、光深、连续谱源函数、吸收源函数等对计算形成位置很有用的信息（特别是线翼的形成位置）&lt;/strong&gt;。&lt;code class=&quot;highlighter-rouge&quot;&gt;NVX&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;VX&lt;/code&gt;表格的数量，&lt;code class=&quot;highlighter-rouge&quot;&gt;VX&lt;/code&gt;设定了计算谱线时候大气额外的膨胀速度；&lt;code class=&quot;highlighter-rouge&quot;&gt;VXS&lt;/code&gt;是计算源函数时候的膨胀速度，它比&lt;code class=&quot;highlighter-rouge&quot;&gt;VX&lt;/code&gt;更基本。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;L   ( 6 ) &amp;gt; length of MU (not needed when sphere=on)
LF  ( 6 )  &amp;gt; length of MUF (not needed when sphere=on)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这俩是视线方向的位置（&lt;code class=&quot;highlighter-rouge&quot;&gt;MU&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;MUF&lt;/code&gt;）的数量，&lt;code class=&quot;highlighter-rouge&quot;&gt;MU&lt;/code&gt;为1是圆面中心，越小越往边缘走。在&lt;code class=&quot;highlighter-rouge&quot;&gt;SPHERE&lt;/code&gt;打开之后不用管。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;do ( addcopr ) &amp;gt;
do ( adn1dmp ) &amp;gt;
omit ( all ) &amp;gt;
omit ( bdprnt ) &amp;gt;
omit ( bdgraf ) &amp;gt;
omit ( bdqprdt ) &amp;gt;
omit ( cijprnt ) &amp;gt;
omit ( comprk ) &amp;gt;
do ( conflux ) &amp;gt;
omit ( didhc ) &amp;gt;
do ( dpdwprnt ) &amp;gt;
do ( elecprnt ) &amp;gt;
do ( emigraf ) &amp;gt;
DO ( EMIPRNT ) &amp;gt;
do ( emisum ) &amp;gt;
do ( EPCOMP ) &amp;gt;
omit ( every ) &amp;gt;
omit ( fdbcopr ) &amp;gt;
omit ( flwbroad ) &amp;gt;
DO ( HELPRNT HEL2PRNT ) &amp;gt;
DO ( HMS ) &amp;gt;
omit ( indprnt ) &amp;gt;
do ( komprnt ) &amp;gt;
omit ( lbdprnt ) &amp;gt;
omit ( linecopr ) &amp;gt;
omit ( LSFGRAF ) &amp;gt;
omit ( LSFPRNT ) &amp;gt;
omit ( LYMAN ) &amp;gt;
DO ( OPAPRNT ) &amp;gt;
omit ( origin ) &amp;gt;
omit ( orshort ) &amp;gt;
do ( phase2 ) &amp;gt;
omit ( PIJPRNT ) &amp;gt;
omit ( prdprnt ) &amp;gt;
omit ( procprnt ) &amp;gt;
DO ( PROSAV ) &amp;gt;
omit ( rateall ) &amp;gt;
omit ( ratecopr ) &amp;gt;
omit ( RATEFULL ) &amp;gt;
OMIT ( RATEGRAF ) &amp;gt;
do ( rateprnt ) &amp;gt;
omit ( ratesumm ) &amp;gt;
do ( rhbprdt ) &amp;gt;
do ( RIJPRNT ) &amp;gt;
omit ( sebug ) &amp;gt;
omit ( secomp ) &amp;gt;
do ( seprnt ) &amp;gt;
do ( SPECSAV ) &amp;gt;
do ( stimprnt ) &amp;gt;
do ( tauprnt ) &amp;gt;
OMIT ( TEGRAF ) &amp;gt;
omit ( waveprnt ) &amp;gt;
omit ( wtabprnt ) &amp;gt;
DO ( ZPRNT ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;omit ( amdiff ) &amp;gt; -
do ( bdcalc ) &amp;gt; *
do ( bsmooth ) &amp;gt; *
omit ( calcool ) &amp;gt; -
omit ( cefacts ) &amp;gt; -
omit ( clnorm ) &amp;gt; *
omit ( diffana ) &amp;gt; *
do ( dsmooth ) &amp;gt; *
do ( emerint ) &amp;gt; -
omit ( expand ) &amp;gt; -
omit ( henorm ) &amp;gt; *
do ( HSE ) &amp;gt; *
omit ( nedit ) &amp;gt; -
do ( prdmeth ) &amp;gt; -
do ( rhedit ) &amp;gt; *
do ( rsmooth  ) &amp;gt; *
omit ( sedit ) &amp;gt; *
OMIT ( SLYR ) &amp;gt; *
omit ( sphere ) &amp;gt; **
omit ( SSMOOTH ) &amp;gt; -
omit ( ulnorm ) &amp;gt; *
omit ( zcomp ) &amp;gt; -
&amp;gt;
GO &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这里的各种选项我把它们分成了输出组和计算组，输出组（第一组）应该对结果没有影响，计算组（第二组）后面如果带减号则和默认一致，星号则和默认不同。
有个特点是和Lyman有关的基本上都是关闭的，这可能是导致Lyman线Ratio错误的原因，但是我们这里不关心它们。另外是一些细致的计算和smooth被打开了。
打开以及关闭&lt;code class=&quot;highlighter-rouge&quot;&gt;SPHERE&lt;/code&gt;对结果稍有影响（废话），但是是一致的。到这里B部分结束。&lt;/p&gt;

&lt;p&gt;我尝试了将和默认一致的选项全部删去时结果是不是一样的。结果是一样的（那你这个模型还写这么多！）&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt;
&amp;gt; jstin ( 1 ) &amp;gt;
&amp;gt;
USE ( MODEL ) &amp;gt;
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jstin&lt;/code&gt;控制是否仅进行输入运行，1为仅输入运行但是这里被注释掉了。然后我们继续跑到模型文件里面。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt;
&amp;gt;   M O D E L   LEID
&amp;gt;
MODLAB ( LEID ) &amp;gt;
&amp;gt;
ELEMENT ( HE LAB 11.3 ) &amp;gt; was 10.60, 11.22, 10.923, 10.85, 10.75, 11.3, 11.1
ELEMENT ( HE2 LAB 11.3 ) &amp;gt; was 10.60, 11.22, 10.923, 10.85, 10.75, 11.3, 11.1
ELEMENT ( LI LAB 1.1 ) &amp;gt;
ELEMENT ( BE LAB -1.01 ) &amp;gt;
ELEMENT ( B LAB .51 ) &amp;gt;
ELEMENT ( C LAB 5.82 ) &amp;gt;
ELEMENT ( N LAB 7.76 ) &amp;gt;
ELEMENT ( O LAB 7.219 ) &amp;gt;
ELEMENT ( O2 LAB 7.219 ) &amp;gt;
ELEMENT ( O3 LAB 7.219 ) &amp;gt;
ELEMENT ( F LAB 2.37 ) &amp;gt;
ELEMENT ( NE LAB 6.14 ) &amp;gt;
ELEMENT ( NA LAB 3.91 ) &amp;gt;
ELEMENT ( MG LAB 5.6 ) &amp;gt;
ELEMENT ( AL LAB 3.18 ) &amp;gt;
ELEMENT ( SI LAB 5.77 ) &amp;gt;
ELEMENT ( P LAB 3.22 ) &amp;gt;
ELEMENT ( S LAB 5.33 ) &amp;gt;
ELEMENT ( CL LAB 3.31 ) &amp;gt;
ELEMENT ( AR LAB 4.61 ) &amp;gt;
ELEMENT ( K LAB 3.13 ) &amp;gt;
ELEMENT ( CA LAB 4.76 ) &amp;gt;
ELEMENT ( SC LAB .69 ) &amp;gt;
ELEMENT ( TI LAB 2.65 ) &amp;gt;
ELEMENT ( V LAB 1.56 ) &amp;gt;
ELEMENT ( CR LAB 3.52 ) &amp;gt;
ELEMENT ( MN LAB 2.74 ) &amp;gt;
ELEMENT ( FE LAB 5.73 ) &amp;gt;
ELEMENT ( CO LAB 2.48 ) &amp;gt;
ELEMENT ( NI LAB 3.88 ) &amp;gt;
ELEMENT ( CU LAB 2.0 ) &amp;gt;
ELEMENT ( ZN LAB 2.26 ) &amp;gt;
ELEMENT ( GA LAB .85 ) &amp;gt;
ELEMENT ( GE LAB 1.46 ) &amp;gt;
ELEMENT ( RB LAB 2.68 ) &amp;gt;
ELEMENT ( SR LAB .79 ) &amp;gt;
ELEMENT ( Y LAB -.41 ) &amp;gt;
ELEMENT ( ZR LAB -.25 ) &amp;gt;
ELEMENT ( BA LAB -.20 ) &amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MODLAB&lt;/code&gt;定义了这个大气模型的名字，你喜欢的话叫村花也没人会抗议的。后面的一堆&lt;code class=&quot;highlighter-rouge&quot;&gt;ELEMENT&lt;/code&gt;请参阅前面章节。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;KURIN ( 6 ) &amp;gt;  
&amp;gt;
NABS ( 22 23 39 42 43 44 45 ) &amp;gt;
&amp;gt;      
ndwm ( 36 ) &amp;gt;
KOELS ( 0 ) &amp;gt;
&amp;gt;
HNDV ( &amp;gt;
1.E+05 3.E05 1.E+06 3.E+06 1.E+07 3.E+07 1.E+08 3.E+08 1.E+09 3.E+09 &amp;gt;
1.E+10 3.E+10 1.E+11 3.E+11 1.E+12 3.E+12 1.E+13 3.E+13 1.E+14 3.E+14 &amp;gt;
1.E+15 3.E+15 1.E+16 &amp;gt;
) &amp;gt;
VNH ( &amp;gt;
30. 30. 29.5 26. 27. 25. 23.7 22.5  21. 5.3 &amp;gt;
5.3 5.3 5.3 5.3 5.3 5.3 5.3 5.3 5.3 5.3 &amp;gt;
5.3 5. 5. ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;KURIN&lt;/code&gt;指定程序使用Kurucz中的谱线不透明度中的哪个。它们被储存在了&lt;code class=&quot;highlighter-rouge&quot;&gt;opacities/statistical.dat&lt;/code&gt;中，&lt;strong&gt;需要换不同的值去测试有什么影响&lt;/strong&gt;。[尝试从6换到了1，没有影响。]
&lt;code class=&quot;highlighter-rouge&quot;&gt;NABS&lt;/code&gt;可以删除背景不透明度中包含的absorber/emitter，数字可以在输出的ATMOSPHERE中的’List of potential contributors to “continuum” or “background” absorbtion and emission’部分查到。&lt;strong&gt;注释掉它的话H-alpha和H-beta线就变成了发射线，所以应该是其中的某个东西发射了。&lt;/strong&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;ndwm&lt;/code&gt;指明了多普勒致宽的基准位置，可能是没有致宽和有致宽之间的那几个点。在这里它和默认值是一样的。
&lt;code class=&quot;highlighter-rouge&quot;&gt;KOELS&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;ORIGIN&lt;/code&gt;（光强形成位置）中每条线的输出开关，打开之后可能输出更多的东西。
&lt;code class=&quot;highlighter-rouge&quot;&gt;HNDV&lt;/code&gt;是与&lt;code class=&quot;highlighter-rouge&quot;&gt;VNH&lt;/code&gt;对应的氢密度表格，&lt;code class=&quot;highlighter-rouge&quot;&gt;VNH&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;V&lt;/code&gt;的标准表格，&lt;code class=&quot;highlighter-rouge&quot;&gt;V&lt;/code&gt;是致宽速度，也就是文章中的turbulent。这是因为turbulent或者说&lt;code class=&quot;highlighter-rouge&quot;&gt;V&lt;/code&gt;并不需要和Z
&lt;code class=&quot;highlighter-rouge&quot;&gt;Z&lt;/code&gt;一样，可以短一点，这个时候&lt;code class=&quot;highlighter-rouge&quot;&gt;HNDV&lt;/code&gt;就起到一个定位的作用了。&lt;strong&gt;需要改变V的取值看看谱线宽度怎么变化&lt;/strong&gt;。[将V全部改成0之后发现线翼稍微窄了一点，线心深了一点，和预期类似；但是幅度不大，可能因为是在高处才有大的速度。结论是影响不大。]&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; IRTIS ( 1 ) &amp;gt; default = 2, which uses log(FINK)
&amp;gt; XINK ( 9.5 10. 500. 501. ) &amp;gt;
&amp;gt; XINK ( 5.94 5.95 9.83 9.84 ) &amp;gt;
&amp;gt; FINK ( M 1.E-15 0. 0. 0. 0. ) &amp;gt;
XINK ( 5.948 5.949 7.48 7.51 13.16 13.17 ) &amp;gt;
FINK ( M 5.E-11 0. 3. 3. 0. 0. 0. ) &amp;gt;
IRTIS ( 1 ) &amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这堆命令控制的是入射的辐射（可能是在模型之外入射的辐射？）。&lt;code class=&quot;highlighter-rouge&quot;&gt;XINK&lt;/code&gt;指定入射光的频率，&lt;code class=&quot;highlighter-rouge&quot;&gt;FINK&lt;/code&gt;指定入射光的强度，&lt;code class=&quot;highlighter-rouge&quot;&gt;IRTIS&lt;/code&gt;控制&lt;code class=&quot;highlighter-rouge&quot;&gt;XINK&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;FINK&lt;/code&gt;的内插/外推方式，究竟是在&lt;code class=&quot;highlighter-rouge&quot;&gt;XINK&lt;/code&gt;中线性还是&lt;code class=&quot;highlighter-rouge&quot;&gt;log(XINK)&lt;/code&gt;中线性这样。上面使用的是默认的设置。&lt;strong&gt;需要注释掉看看有什么变化&lt;/strong&gt;。[全部改成0之后谱线似乎没什么很大的改变，应该可以保持默认。]&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&amp;gt; R1N ( 1.39E7 ) &amp;gt; = 20 solar radii
&amp;gt; R1N ( 2.09E7 ) &amp;gt; = 30 solar radii
R1N ( 5.88E7 ) &amp;gt; = 84 solar radii
FABD ( 1. ) &amp;gt;
CLOGG ( 1.74 ) &amp;gt;
WZM ( .8 ) &amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;R1N&lt;/code&gt;的字面意思是距光源的距离，实际上基本上是作为恒星半径使用。大概是把色球层开始的地方作为一个恒星半径。[改变R1N的值对最后的谱线轮廓影响不大。]
&lt;code class=&quot;highlighter-rouge&quot;&gt;FABD&lt;/code&gt;是元素丰度的乘数，所有的元素丰度都会乘上这个值，默认是1（奇怪的乘数真多啊）。
&lt;code class=&quot;highlighter-rouge&quot;&gt;CLOGG&lt;/code&gt;是&lt;script type=&quot;math/tex&quot;&gt;\log{\mathrm{surface gravity}}&lt;/script&gt;，就是平常的logg。不指定的话就会用&lt;code class=&quot;highlighter-rouge&quot;&gt;CGR&lt;/code&gt;，和太阳的logg比值。&lt;strong&gt;所以之前我一直用的是太阳的logg值……&lt;/strong&gt;[但是将&lt;code class=&quot;highlighter-rouge&quot;&gt;CLOGG&lt;/code&gt;增加到2.74谱线也没什么变化？为什么？]
&lt;code class=&quot;highlighter-rouge&quot;&gt;WZM&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;Z&lt;/code&gt;的权重，默认是0.8。当我们要求&lt;code class=&quot;highlighter-rouge&quot;&gt;Z&lt;/code&gt;表要和别的表相匹配的时候（MASS什么的）它会参与计算。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Z                 ( &amp;gt;
-1.34498000E+07 -1.21944000E+07 -1.12022000E+07 -1.02707000E+07 -9.37975000E+06
...
 2.62733008E+04  2.90250000E+04
) &amp;gt;
TE                ( &amp;gt;
 1.32412000E+05  1.22873000E+05  1.14001000E+05  1.05571000E+05  9.73640000E+04
...
 9.06100000E+03  9.29800000E+03
) &amp;gt;
&amp;gt; UPDATE
&amp;gt; LEID       MODEL LEID   5 L H        ITER 52-62     13-Mar-21                 
NE                ( &amp;gt;
 1.15703990E+04  1.93011710E+04  3.01664670E+04  4.74718253E+04  7.59880490E+04
 ...
 7.09270054E+14  8.86317471E+14  ) &amp;gt;                                            
&amp;gt; LEID       MODEL LEID   5 L H        ITER 52-62     13-Mar-21                 
ZME               ( &amp;gt;
 1.11121707E-04  1.11121707E-04  1.11121707E-04  1.11121707E-04  1.11121707E-04
 ...
 7.81938802E-06  9.47751718E-06  ) &amp;gt;                                            
&amp;gt; LEID       MODEL LEID   5 L H        ITER 52-62     13-Mar-21                 
NC                ( &amp;gt;
 2.17200027E+04  3.62503735E+04  5.67030110E+04  8.93539750E+04  1.43384253E+05
 ...
 1.41854011E+15  1.77263494E+15  ) &amp;gt;                                            
&amp;gt; LEID       MODEL LEID   5 L H        ITER 52-62     13-Mar-21                 
BDHM              ( &amp;gt;
 4.49889182E+03  3.97155540E+03  3.54675044E+03  3.15856061E+03  2.79582013E+03
 ...
 1.00172011E+00  1.00163211E+00  ) &amp;gt;                                          
&amp;gt; LEID       MODEL LEID   5 L H        ITER 32-39     12-Aug-06                 
NH                ( &amp;gt;
 8.70412526E+03  1.45353581E+04  2.27573370E+04  3.59175776E+04  5.77983267E+04
 ...
 9.55204350E+15  9.40788717E+15  ) &amp;gt;   
 USE ( INPUT ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这堆就是正常操作了，模型中最重要的温度密度等参数。要留意除了&lt;code class=&quot;highlighter-rouge&quot;&gt;Z&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;TE&lt;/code&gt;之外其他都是经过更新的，以及&lt;code class=&quot;highlighter-rouge&quot;&gt;NC&lt;/code&gt;在手册上标的是在H部分，但是这里是在D部分，所以实际上可能是需要在D部分的。这些读完之后又回到了主控制文件。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lwnt ( 10 ) &amp;gt;   for KOMPRNT
&amp;gt;
&amp;gt; idfsw ( 1 ) &amp;gt;   for dI/dh at every line wavelength
&amp;gt;
iwsmd ( 1 ) &amp;gt;
ibnview ( 50 ) &amp;gt;
iprdd ( 10 )  iprdf ( 20 ) &amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;LWNT&lt;/code&gt;是控制&lt;code class=&quot;highlighter-rouge&quot;&gt;KOMPRNT&lt;/code&gt;里面输出的命令，控制输出（谁的？）不透明度的波长间隔，默认是1。
&lt;code class=&quot;highlighter-rouge&quot;&gt;idfsw&lt;/code&gt;就和注释说的一样，控制输出&lt;code class=&quot;highlighter-rouge&quot;&gt;dI/dh&lt;/code&gt;。
&lt;code class=&quot;highlighter-rouge&quot;&gt;IWSMD&lt;/code&gt;应该是控制WAVE SUM输出的内容。
&lt;code class=&quot;highlighter-rouge&quot;&gt;ibnview&lt;/code&gt;是决定用哪个depth index去呈现BD和ND计算的值。
&lt;code class=&quot;highlighter-rouge&quot;&gt;IPRDD&lt;/code&gt;控制输出PRD结果的depth index间隔，比如每隔10个；默认是1。
&lt;code class=&quot;highlighter-rouge&quot;&gt;IPRDF&lt;/code&gt;控制输出PRD结果的频率间隔，比如每隔20个；默认是1。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ZXMIN ( 40. )  MNG1 ( 77 ) &amp;gt;   MN1 ( 38 )  &amp;gt;
kdiag ( 5 )  kdifd1 ( 2 )  kdamp ( 0 )  n1nup ( 1 )  mdfg ( 0 )  &amp;gt;
kdifgs ( 2 )  ipdij ( 0 )  nefdf ( 2 )  kbnds ( 0 )  kb1ws ( 2 )  &amp;gt;
kb1wa ( 52 )  kb1wb ( 54 )  ldfd1 ( 1 )  &amp;gt;
&amp;gt;
KOOLSUM ( 5 ) &amp;gt;
&amp;gt;
USE ( ATOM ) &amp;gt;
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ZXMIN&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;MNG1&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;MN1&lt;/code&gt;是双极扩散的计算数值，不知道为什么这里要指定（因为&lt;code class=&quot;highlighter-rouge&quot;&gt;amdiff&lt;/code&gt;没有打开）。
下面三行的东西应该都是扩散的计算细节，&lt;strong&gt;之后整体注释掉看看有没有很大的变化&lt;/strong&gt;。[没有任何变化，应该是因为双击扩散没有打开。]
&lt;code class=&quot;highlighter-rouge&quot;&gt;KOOLSUM&lt;/code&gt;控制哪些成分在计算Total Cooling Rate中被加进了Total Hydrogen里面；具体见Note*41。&lt;strong&gt;也需要改变它的值看看有没有变化&lt;/strong&gt;[没有任何变化]&lt;/p&gt;

&lt;p&gt;然后又跑到ATOM里面去了，这就不说了，继续看主控制文件的内容。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt;
cimethod ( -clark shah johnson onthefly ) &amp;gt;
cemethod ( -scholz pb -aggrwl johnson onthefly ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CIMETHOD&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;CEMETHOD&lt;/code&gt;是计算CI的方法选择器，分别接受&lt;code class=&quot;highlighter-rouge&quot;&gt;CLARK, AR, VORONOV, JOHNSON, VS, SHAH, ONTHEFLY&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;SEATON, VREGE, SCHOLZ, PB, VS, JOHNSON, AGGRWL, ONTHEFLY&lt;/code&gt;这些参数。想打开的话将参数放到括号里面即可，关闭的话在前面加个减号（注意它们有默认打开的参数）。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CSDW ( 1. )  FSTKM ( 1. )  ISTARK ( 89 ) &amp;gt;
IHSSW ( 1 )  &amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这些参数和Stark致宽有关，都是默认值。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;jedit ( 1 )  jnedp ( 1 )  &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这两个和N-editing有关，暂时不知道是什么意思。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LSFPRINT  2  1 ( 1 )  LSFFDB  2  1 ( 1 )  PROF  2  1 ( 1 ) &amp;gt;
LSFPRINT  3  1 ( 1 )  LSFFDB  3  1 ( 1 )  PROF  3  1 ( 1 ) &amp;gt;
LSFPRINT  3  2 ( 1 )  lsffdb  3  2 ( 1 )  prof  3  2 ( 1 ) &amp;gt;
LSFPRINT  4  2 ( 1 )  lsffdb  4  2 ( 1 )  prof  4  2 ( 1 ) &amp;gt;
LSFPRINT  5  2 ( 1 )  lsffdb  5  2 ( 1 )  prof  5  2 ( 1 ) &amp;gt;
&amp;gt;
LSFTYP  4  2 ( 1 ) &amp;gt;
LSFTYP  4  3 ( 1 ) &amp;gt;
LSFTYP  5  2 ( 1 ) &amp;gt;
LSFTYP  5  3 ( 1 ) &amp;gt;
LSFTYP  5  4 ( 1 ) &amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;LSFPRINT&lt;/code&gt;控制输出的line source function详细程度，默认是1；&lt;code class=&quot;highlighter-rouge&quot;&gt;LSFFDB&lt;/code&gt;是LSF背景选择，用1应该好一点。&lt;code class=&quot;highlighter-rouge&quot;&gt;PROF&lt;/code&gt;就不用说了，有它才有谱线出来。
&lt;code class=&quot;highlighter-rouge&quot;&gt;LSFTYP&lt;/code&gt;是解LSF方法的选择器，一般是1（参见Note*48）。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;KRATE  3  2 ( 2 ) &amp;gt;
KRATE  4  2 ( 2 ) &amp;gt;
KRATE  4  3 ( 2 ) &amp;gt;
KRATE  5  2 ( 2 ) &amp;gt;
KRATE  5  3 ( 2 ) &amp;gt;
KRATE  5  4 ( 2 ) &amp;gt;
&amp;gt;
BLCSW  2 1 ( 15 )  BLCSW  3 1 ( 15 )  BLCSW  3 2 ( 15 ) &amp;gt;
&amp;gt;
USE ( RESTART ) &amp;gt;
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;KRATE&lt;/code&gt;控制统计平衡方程里面某些项的建立。1是从密度计算，2是从Jbar计算（可能2比较好？）
&lt;code class=&quot;highlighter-rouge&quot;&gt;BLCSW&lt;/code&gt;是damping constent选择器，决定有无辐射, van der Waals, Stark, resonance, ion collision致宽。&lt;strong&gt;应该是重要的参数&lt;/strong&gt;[改变的话对线心轮廓有比较大的影响。]&lt;/p&gt;

&lt;p&gt;然后RESTART文件里面有一大堆参数，需要参考restart过程从rst文件中搞过来。&lt;/p&gt;

&lt;p&gt;继续看主控制文件。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;metse 2 1 ( 1 ) &amp;gt;
metse 3 1 ( 0 ) &amp;gt;
metse 3 2 ( 1 ) &amp;gt;
metse 4 1 ( 0 ) &amp;gt;
metse 4 2 ( 1 ) &amp;gt;
metse 4 3 ( 1 ) &amp;gt;
metse 5 1 ( 0 ) &amp;gt;
metse 5 2 ( 1 ) &amp;gt;
metse 5 3 ( 1 ) &amp;gt;
metse 5 4 ( 1 ) &amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;metse&lt;/code&gt;决定了怎么去计算统计平衡方程。输出的LINE (U/L)中有推荐方法，可以去那里看。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smooth 2 1 ( IFS 25 ILS 40 WSM .5 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;RHO的平滑方法。&lt;code class=&quot;highlighter-rouge&quot;&gt;WSM&lt;/code&gt;是平滑强度，其他两个控制平滑的范围。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;IOMX ( 11 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;迭代的次数。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bdopt ( bdr )  rhopt ( rhos ) &amp;gt;
wrmn ( 0.4 )  wrmx ( 0.9 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bdopt&lt;/code&gt;是选择计算b-ratio的方法，在输出文件的RHO AND RBD中有讲。&lt;code class=&quot;highlighter-rouge&quot;&gt;rhopt&lt;/code&gt;类似。&lt;strong&gt;可能要调试一下&lt;/strong&gt;。[谱线整体稍微变浅了一丢丢。]
&lt;code class=&quot;highlighter-rouge&quot;&gt;wrmn&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;wrmx&lt;/code&gt;是调整RHO的权重的系数，不知道有什么用（Note*131）&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;TMS ( 1.E+10 ) &amp;gt;  quadratic for larger tau
TLARGE ( 500. )  TSMALL ( 1.E-10 )  &amp;gt;
TSM ( 1.E-10 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;不知道，&lt;strong&gt;调试吧&lt;/strong&gt;。[谱线整体稍微变浅了一丢丢。]&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; WAVES ( 1025.6 150.0 60.0 ) &amp;gt;
&amp;gt; WAVES ( 911.7 ) &amp;gt;
WAVES ( 227.5 227.9 399. 399.2 400.6 400.8 503.8 504.1 &amp;gt;
911.75 5000.0 6565. ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;额外算的连续谱不透明度。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; NABS moved to .mod file
&amp;gt;
CWJ ( 0.4 ) CWR ( .05 ) &amp;gt;
HSEC ( .9 )  HEL ( .9 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;不知道，&lt;strong&gt;调试吧&lt;/strong&gt;。[没有区别]&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;WEP ( .9 ) &amp;gt;
LMT ( 5. )  LMF ( 0. )  LME ( .001 ) &amp;gt;
WSM ( .3 )  INFSM ( 60 )  INLSM ( 70 ) &amp;gt;
LMB ( 500. ) &amp;gt;
&amp;gt; YL ( -3. )  YLYM ( F -3. ) &amp;gt; ***************omit when lyman=off
&amp;gt; EXLYM ( 1.E6 )  TGLYM ( 1.E6 ) &amp;gt; ***********omit when lyman=off
&amp;gt; METEP ( 1 ) &amp;gt; method in LYMAN
&amp;gt; kxlym ( 0 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;有关Lyman线的东西，&lt;strong&gt;调试&lt;/strong&gt;。[没有区别，和预期一样]&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POPUP ( HYDROGEN ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;需要更新的元素&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;WPOP ( .9 ) &amp;gt;
WBD ( .9 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;数密度和departure coefficient更新权重。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;NDW ( 60 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;ND&lt;/code&gt;差不多的玩意儿。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;WZM ( 0. ) &amp;gt; weight for newly calculated Z
FZLIM ( 1.1 ) &amp;gt;  Z from MASS limiting parameter
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;如注释所说。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; CVW 3 2 ( .0 ) &amp;gt;
&amp;gt; CSK 3 2 ( .0 ) &amp;gt;
&amp;gt; CRS 3 2 ( .0 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;van de Waals, Stark, resonance致宽宽度。Section 19。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; XI ( 0. 0.1 0.2  0.3  0.4 0.5 &amp;gt;
...
&amp;gt; 48. 48.5 49. 49.5 50. ) &amp;gt;
XI ( 0. .1 .2 .3 .4 .5 .6 .7 .8 .9 1. 1.1 1.2 1.3 1.4 1.5 &amp;gt;
     1.6 1.7 1.8 1.9 2. 2.2 2.4 2.6 2.8 3. 3.2 &amp;gt;
     3.4 3.6 3.8 4. 4.25 4.5 4.75 5. 5.25 5.5 5.75 &amp;gt;
     6. 7. 8. 9. 10. 11. 12. 14. 16. 18. 20. &amp;gt;
     25. 30. 35. 40. 45. 50. &amp;gt;
) &amp;gt;
&amp;gt; KST    2 1 ( 44 ) &amp;gt;
&amp;gt; XISYMT 2 1 ( 0. .2 .4 .6 .8 1. 1.2 1.4 1.6 1.8 2. 2.2 2.4 2.6 2.6 2.8 &amp;gt;
&amp;gt;             3.6 4. 4.5 5. 6. 8. 10. 12. 15. 20. 30. 40. 60. &amp;gt;
&amp;gt;             80. 100. 150. 200. 250. 300. 350. 400. 450. 500. &amp;gt;
&amp;gt;             550. 600. 650. 700. 750. 800. ) &amp;gt;
&amp;gt;
&amp;gt; KST    3 1 ( 33 ) &amp;gt;
&amp;gt; XISYMT 3 1 ( 0. .2 .4 .6 .8 1. 1.3 1.6 2. 2.5 3. 3.5 4. 4.5 5. 6. &amp;gt;
&amp;gt;             8. 10. 12. 15. 20. 30. 40. 60. 80. 100. 120. 140. &amp;gt;
&amp;gt;             180. 230. 280. 350. 400. ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;谱线覆盖的频率点/单条谱线覆盖的频率点。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;JNUNC ( 1 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;如果有&lt;code class=&quot;highlighter-rouge&quot;&gt;JNU&lt;/code&gt;的话，&lt;code class=&quot;highlighter-rouge&quot;&gt;JNUNC&lt;/code&gt;设为1可以读入&lt;code class=&quot;highlighter-rouge&quot;&gt;JNU&lt;/code&gt;。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;idex ( 50 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;控制输出的东西。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; SCH 2 1 ( 1 )  GMMA 2 1 ( -0.99 )  XC 2 1 ( 2. )  XR 2 1 ( 0.005 ) &amp;gt;
&amp;gt; SCH 3 1 ( 1 )  GMMA 3 1 ( -0.99 )  XC 3 1 ( 2. )  XR 3 1 ( 0.010 ) &amp;gt;
&amp;gt; drlim ( 0.005 ) &amp;gt;
&amp;gt;
&amp;gt; YFLUX ( .1 ) &amp;gt;
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;被注释了，先不管。应该是PRD的东西。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;VXS              ( &amp;gt;
 1.00000000E+02  1.00000000E+02  1.00000000E+02  1.00000000E+02  1.00000000E+02
 1.00000000E+02  1.00000000E+02  1.00000000E+02  1.00000000E+02  1.00000000E+02
 1.00000000E+02  1.00000000E+02  9.95000000E+01  9.80000000E+01  9.60000000E+01
 9.30000000E+01  8.90000000E+01  8.20000000E+01  7.50000000E+01  6.70000000E+01
 6.00000000E+01  5.40000000E+01  4.95000000E+01  4.60000000E+01  4.30000000E+01
 4.00000000E+01  3.70000000E+01  3.40000000E+01  3.10000000E+01  2.70000000E+01
 2.25000000E+01  1.80000000E+01  1.20000000E+01  0.60000000E+01  0.00000000E+00
 0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
 0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
 0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
 0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
 0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
 0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
 0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
 0.00000000E+00  0.00000000E+00
) &amp;gt;
GO &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;turbulence速度。part D结束。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; cvx ( 20. ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;见Section 16.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;MUF ( 1.0 .9 .7 .5 .3 .1 ) &amp;gt;
MU ( 1.0 .9 .7 .5 .3 .1 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;视线方向指定。开了SPHERE就没有用了。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lpmlr ( 1 ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;mass loss rate输出的开关。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CORMIN ( 6500. ) &amp;gt;
CORMAX ( 6700. ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ORIGINS和CONTRIBUTORS的输出控制。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cvxf ( 300. )  wfb ( 0. )  fbvmx ( 100. )  &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;flow broadening的东西，&lt;strong&gt;调试&lt;/strong&gt;。[没有变化]&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GO &amp;gt;
&amp;gt;
USE ( MODEL ) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;结束了！&lt;/p&gt;

&lt;h4 id=&quot;需要留意的参数们&quot;&gt;需要留意的参数们&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NABS&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;这个会对谱线轮廓产生巨大变化，而且暂无对应关系，需要问Dupree。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;V&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;V的重要性应该不用说了，反正是需要考虑以及修改的。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CLOGG&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;R1N&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;我还以为logg可以通过具体的高度密度安排来体现，结果也是需要指定的。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;KRATE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;改变这个会对线心部分的轮廓有比较大的影响.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;XINK&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;FINK&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;这俩倒是对结果没什么很大的影响，不过我还没测试将&lt;code class=&quot;highlighter-rouge&quot;&gt;FINK&lt;/code&gt;调到一个很高的值会怎么样，以及对于He线来说有了高温层之后还需不需要外加的辐射。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;BLCSW&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;改变的话对线心轮廓有比较大的影响。&lt;/p&gt;
</description>
        <pubDate>Fri, 12 Apr 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/04/12/pandora/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/04/12/pandora/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>逃离东京的24小时</title>
        <description>&lt;h2 id=&quot;缘起&quot;&gt;缘起&lt;/h2&gt;

&lt;p&gt;我印象中最早说起去看星星是在地铁解谜人齐之后，大家高兴地说着去看星星吧，就有了这个想法。当然实际上组织的时候大家都各种有事情、回家什么的（虽然是预料之中），结果群里7个人最后只去了4个。&lt;/p&gt;

&lt;h2 id=&quot;哪里&quot;&gt;哪里？&lt;/h2&gt;

&lt;p&gt;去哪里看？这是个大问题。当然网络上有很多很多的地点可供选择，我主要参考的是&lt;a href=&quot;&quot;&gt;这个网站&lt;/a&gt;。虽然它题目说的是做巴士或者火车可以去到的观星地，但是还有一些是只有开车才能去（或者就是在高速公路路边）的地方。地点是不少的，但是考虑到距离东京的远近、星空质量的好坏（以及某位蓝担的想法），我们还是选了阿智村。&lt;/p&gt;

&lt;p&gt;阿智村是距离东京约200公里的一个小村子，被誉为“日本一の星空”。它就在中央自動車道的旁边，而且大约十公里外有昼神温泉，算是一个既有一点点基本生活设施又没有什么光污染的村子。&lt;/p&gt;

&lt;h2 id=&quot;冷&quot;&gt;冷&lt;/h2&gt;

&lt;p&gt;冬天的日本乡下巨冷，更何况是晚上。所以两件（以及以上）的保暖衣、羽绒服以及暖贴是很有必要的。暖贴还得在出发之前贴好，否则就热不起来了。&lt;/p&gt;

&lt;h2 id=&quot;怎么去&quot;&gt;怎么去？&lt;/h2&gt;

&lt;p&gt;在公路旁边意味着很可能可以坐巴士去，事实上也是这样的：从东京站或者新宿站出发，乘坐JRバス的中央ライナーなごや号巴士，到中央道昼神温泉站下车即可（昼神温泉站实际上在阿智村里，离昼神温泉还有一段距离）。每天从东京出发有三趟车，早上8点、中午12点以及下午4点各一趟。因为车程大约4个小时，所以选择中午出发的那一趟是比较合适的。我们这次是因为某（预备硕士）师妹要答辩，所以选了下午4点的大巴，下车的时候已经是9点多了。&lt;/p&gt;

&lt;p&gt;巴士在到达昼神温泉之前会在三鹰附近停三个站，然后继续将近两个多小时的车程。过了三鹰附近的最后一个站之后还会在服务区休息两次。在快到站的时候会有报站，那个时候记得按下车铃，否则是可能会飞站的。下车之后就会惊喜地发现：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/01.jpg&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;被丢到荒郊野岭啦~ credit:HMX&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;住哪&quot;&gt;住哪？&lt;/h2&gt;

&lt;p&gt;阿智村村里其实没有什么宾馆，只有一家我们住的民宿，みんなのいえ。多数的住宿都在昼神温泉那（盛惠一万日元/晚）。虽说昼神温泉旁边有个专门观星的公园，但是我们到那已经是9点了而且冬天好像不是每天都有星空Tour（倒是有一堆室内的玩意儿），还是住一晚3000日元的みんなのいえ比较好。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/02.jpg&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;其实就是穷&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;みんなのいえ从车站走十来分钟就到了，房东是个很亲切的日本人，会要求你提前告诉她到达时间然后在房子里迎接。这家是个Airbnb页面上附有注册号码的正规民宿，所以需要登记护照或者在留卡号（一个人的就行）。我估计Airbnb上的回复是房东用谷歌翻译看懂的，因为房东基本不会讲英语，看到我们都会日语之后超放心(……)。房间应该有4张床，所以4个人出行的话大概率会分到同一间房里面。同时房东似乎不会在Airbnb页面上开放床位，所以想订房的时候可以先问问房东还有没有空位，有的话她会开放的。&lt;/p&gt;

&lt;p&gt;其实也可以提前告诉房东我们的目的是去看星，这样她可以推荐一些地方以及做好夜不归宿的准备。&lt;/p&gt;

&lt;h2 id=&quot;在哪看&quot;&gt;在哪看？&lt;/h2&gt;

&lt;p&gt;房东给我们推荐的是一个公园，走路大概二十分钟。我们没走那么远，在半路上的一个小岔路上就停下来了。实际上一下车的时候就可以看到很多的星了，这个小岔路稍微算开阔一点，而且对面有一盏设计感不错的灯可以造景，可以拍合照什么的。这个时间晚上10点左右北斗七星正好在这个路灯上方，组合起来还是很有意思的。&lt;/p&gt;

&lt;h2 id=&quot;show-time&quot;&gt;Show Time&lt;/h2&gt;

&lt;p&gt;好了我这个没有单反也没有微单的人就可以退场了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/03.jpg&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;credit: HMX&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/04.jpg&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;credit: Rainy&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;观星之后&quot;&gt;观星之后&lt;/h2&gt;

&lt;p&gt;第一件事当然是饿了！好在民宿出门左转那有一家24小时的罗森，那里基本上什么都有。当然可以坐的位置是没有的（就算有晚上也不会让你坐），所以买完东西之后就回民宿吧。&lt;/p&gt;

&lt;p&gt;房东会给留门或者告诉我们密码锁的密码，不过无论如何在回到民宿之后都要保持安静然后把门锁上，悄悄地回到房间里面睡觉。洗澡房晚上10点之后就不许用了，所以可以在之前洗完或者第二天再洗。记得把贴着的暖贴取下来。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/05.jpg&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;ゆうめし。credit: Rainy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/06.jpg&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;合照 credit: XT&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;番外1满蒙博物馆&quot;&gt;番外1：满蒙博物馆&lt;/h2&gt;

&lt;p&gt;第二天早上吃早饭的时候和房东聊起来（我负责点头表示赞同），房东推荐了附近的满蒙博物馆。我倒是之前就看到了房东的推荐，但是担心是左翼的东西就没敢说，结果房东说这是记录日本做过的坏事的地方，而且可以开车送我们过去，然后就高兴地答应了。&lt;/p&gt;

&lt;p&gt;博物馆其实主要讲的是日本占领了东三省之后将大量日本人迁到东北（满洲国）的事情，并且将着重点放在了这些移民的悲惨生活上。讲解员得知我们是中国人之后还给我们放了中文的介绍视频，看了二十分钟（大概）。这个博物馆建在阿智村的原因大概是当时长野县的移民是数量最大的，而现在的很多日本人（甚至是讲解员）都渐渐地不知道这段历史了。不过毕竟是在小村子里，来参观的人多数还是老年人，或许以后日本人就真的不知道这段历史的这些细节了吧。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/07.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;番外2房东的facebook&quot;&gt;番外2：房东的Facebook&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-achi/08.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;哈哈哈哈哈。&lt;/p&gt;
</description>
        <pubDate>Tue, 29 Jan 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/01/29/achi/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/01/29/achi/</guid>
        
        <category>hanging-around</category>
        
        
      </item>
    
      <item>
        <title>TOPCAT大型星表筛选交叉方法</title>
        <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#星团证认m4&quot; id=&quot;markdown-toc-星团证认m4&quot;&gt;星团证认：M4&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#一获取m4附近的gaia数据&quot; id=&quot;markdown-toc-一获取m4附近的gaia数据&quot;&gt;一、获取M4附近的Gaia数据&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#二通过自行挑出星团成员&quot; id=&quot;markdown-toc-二通过自行挑出星团成员&quot;&gt;二、通过自行挑出星团成员&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#三验证成员星&quot; id=&quot;markdown-toc-三验证成员星&quot;&gt;三、验证成员星&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#四确定m4的视差&quot; id=&quot;markdown-toc-四确定m4的视差&quot;&gt;四、确定M4的视差&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#相空间的星团证认毕星团&quot; id=&quot;markdown-toc-相空间的星团证认毕星团&quot;&gt;相空间的星团证认：毕星团&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#获取太阳附近的gaia数据&quot; id=&quot;markdown-toc-获取太阳附近的gaia数据&quot;&gt;获取太阳附近的Gaia数据&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#tap教程&quot; id=&quot;markdown-toc-tap教程&quot;&gt;TAP教程&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#下载整个星表&quot; id=&quot;markdown-toc-下载整个星表&quot;&gt;下载整个星表&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#选择星表的前n行select&quot; id=&quot;markdown-toc-选择星表的前n行select&quot;&gt;选择星表的前n行：SELECT&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#排序order-by&quot; id=&quot;markdown-toc-排序order-by&quot;&gt;排序：ORDER BY&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#表达式的一些内容&quot; id=&quot;markdown-toc-表达式的一些内容&quot;&gt;表达式的一些内容&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#有条件选择where&quot; id=&quot;markdown-toc-有条件选择where&quot;&gt;有条件选择：WHERE&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#交叉证认join&quot; id=&quot;markdown-toc-交叉证认join&quot;&gt;交叉证认：JOIN&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#更复杂的交叉证认join-on&quot; id=&quot;markdown-toc-更复杂的交叉证认join-on&quot;&gt;更复杂的交叉证认：JOIN ON&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#令人头大的交叉证认基于位置&quot; id=&quot;markdown-toc-令人头大的交叉证认基于位置&quot;&gt;令人头大的交叉证认：基于位置&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#俄罗斯套娃查询中的查询&quot; id=&quot;markdown-toc-俄罗斯套娃查询中的查询&quot;&gt;俄罗斯套娃：查询中的查询&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#topcat使用的某些tips&quot; id=&quot;markdown-toc-topcat使用的某些tips&quot;&gt;TOPCAT使用的某些tips&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#表格&quot; id=&quot;markdown-toc-表格&quot;&gt;表格&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;TOPCAT是个神器。师兄说的好，要是把它用6了，编程工作减少一半。它在星表读入输出、交叉、画图中具有的非常多的功能使得我们可以方便地获取数据、进行初步处理并查看某些参数的分布。这里通过两个有关Gaia的教程（&lt;a href=&quot;https://github.com/mbtaylor/tctuto/releases/download/asterics-vo-school-4/tctuto.pdf&quot;&gt;1&lt;/a&gt;、&lt;a href=&quot;http://docs.g-vo.org/adql-gaia/html/&quot;&gt;2&lt;/a&gt;）介绍一下如何获取像Gaia DR2这样的星表。这里默认读者已经有TOPCAT的基本使用经验。&lt;/p&gt;

&lt;h2 id=&quot;星团证认m4&quot;&gt;星团证认：M4&lt;/h2&gt;

&lt;h3 id=&quot;一获取m4附近的gaia数据&quot;&gt;一、获取M4附近的Gaia数据&lt;/h3&gt;

&lt;p&gt;这里我们将会用到Cone Search。这是专用于获取某个坐标附近一定角距离的程序。如果想获取多个坐标附近的源的话，用Multicone就可以了（当然得准备一个位置和搜索半径的表）。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;打开VO|Cone Search&lt;br /&gt;
&lt;img src=&quot;/img/in-post/post-topcat/1.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;在&lt;strong&gt;Keyword&lt;/strong&gt;中输入&lt;code class=&quot;highlighter-rouge&quot;&gt;gaia dr2&lt;/code&gt;并点击&lt;strong&gt;Find Service&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&quot;/img/in-post/post-topcat/2.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;在搜索结果中选择&lt;code class=&quot;highlighter-rouge&quot;&gt;ARI-Gaia&lt;/code&gt;并在下面的&lt;strong&gt;Object Name&lt;/strong&gt;中输入&lt;code class=&quot;highlighter-rouge&quot;&gt;M4&lt;/code&gt;并点击&lt;strong&gt;Resove&lt;/strong&gt;，在&lt;strong&gt;Radius&lt;/strong&gt;中填入&lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;(degree)
&lt;img src=&quot;/img/in-post/post-topcat/3.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;点击&lt;strong&gt;OK&lt;/strong&gt;并等待一会，TOPCAT就会将我们要的星表准备好了，44662个源&lt;/li&gt;
  &lt;li&gt;回到主界面点击&lt;code class=&quot;highlighter-rouge&quot;&gt;Sky Plot&lt;/code&gt;，看一下这个星表的空间分布
&lt;img src=&quot;/img/in-post/post-topcat/4.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;你看这个Gaia它又大又圆&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;至于实际上应该选择哪个星表，我的建议是在TAP窗口中搜索并看看星表的各种参数以及列名再确定。&lt;/p&gt;

&lt;h3 id=&quot;二通过自行挑出星团成员&quot;&gt;二、通过自行挑出星团成员&lt;/h3&gt;

&lt;p&gt;这样下下来的星表包含了M3的成员星以及非常多的前景场星，而且它们混在了一起，所以我们需要通过星团成员星有相似的移动速度这个条件来将成员星挑出来。要注意这个方法只是为了演示，因为M4的自行非常大所以才能这样做，其他的星团基本上不行。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;回到主界面点击&lt;code class=&quot;highlighter-rouge&quot;&gt;Plane Plot&lt;/code&gt;，并将x与y轴设为&lt;code class=&quot;highlighter-rouge&quot;&gt;pmra&lt;/code&gt;与&lt;code class=&quot;highlighter-rouge&quot;&gt;pmdec&lt;/code&gt;
&lt;img src=&quot;/img/in-post/post-topcat/5.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;场星一般都是太阳附近的恒星，所以它们相对太阳应该没有整体的运动。所以中心不在(0,0)的那坨星就是星团的成员星了；将他们框起来并命名为&lt;code class=&quot;highlighter-rouge&quot;&gt;comoving&lt;/code&gt;
&lt;img src=&quot;/img/in-post/post-topcat/6.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;三验证成员星&quot;&gt;三、验证成员星&lt;/h3&gt;

&lt;p&gt;这里我们将成员星与非成员星的自行画出来看一下。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;打开&lt;strong&gt;Row Subset&lt;/strong&gt;，选中&lt;strong&gt;comoving&lt;/strong&gt;，然后点击创建互补subset的按钮，瞬间就多了个&lt;strong&gt;not_comoving&lt;/strong&gt;
&lt;img src=&quot;/img/in-post/post-topcat/7.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;打开&lt;strong&gt;SKy Plot&lt;/strong&gt;，将&lt;strong&gt;subsets&lt;/strong&gt;选为&lt;strong&gt;comoving&lt;/strong&gt;与&lt;strong&gt;NOT_comoving&lt;/strong&gt;并换一下位置
&lt;img src=&quot;/img/in-post/post-topcat/8.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;在&lt;strong&gt;Frame&lt;/strong&gt;中加入&lt;strong&gt;Sky Vector&lt;/strong&gt;，然后将&lt;strong&gt;Delta Longitude&lt;/strong&gt;设为&lt;code class=&quot;highlighter-rouge&quot;&gt;pmra&lt;/code&gt;以及&lt;em&gt;*Delta Latitude设为&lt;code class=&quot;highlighter-rouge&quot;&gt;pmdec&lt;/code&gt;，你就会发现
&lt;img src=&quot;/img/in-post/post-topcat/9.png&quot; alt=&quot;&quot; /&gt;
*好多头发！&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;将&lt;strong&gt;Scale&lt;/strong&gt;调小，就可以看到两个subset不同的自行规律了
&lt;img src=&quot;/img/in-post/post-topcat/10.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;四确定m4的视差&quot;&gt;四、确定M4的视差&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;打开上述两个subset的&lt;strong&gt;Histogram Plot&lt;/strong&gt;，x轴设为&lt;code class=&quot;highlighter-rouge&quot;&gt;parallax&lt;/code&gt;
&lt;img src=&quot;/img/in-post/post-topcat/11.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;在&lt;strong&gt;Forms&lt;/strong&gt;中添加&lt;strong&gt;Add Gaussian&lt;/strong&gt;，就可以看到这两个subset的视差平均值了
&lt;img src=&quot;/img/in-post/post-topcat/12.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/img/in-post/post-topcat/13.png&quot; alt=&quot;&quot; /&gt;
&lt;script type=&quot;math/tex&quot;&gt;d_{\mathrm{M4}} = 1000 / \mathrm{Mean} = 2000 pc&lt;/script&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;要注意的是因为Gaia的视差误差不小（特别对于远的恒星来说），所以直接计算视差的倒数作为距离是不合适的。这里可以这样做是因为我们有很多恒星在同一个距离上。&lt;/p&gt;

&lt;h2 id=&quot;相空间的星团证认毕星团&quot;&gt;相空间的星团证认：毕星团&lt;/h2&gt;

&lt;p&gt;这个例子使用相空间（3维速度空间）的密度来找星团。&lt;/p&gt;

&lt;h3 id=&quot;获取太阳附近的gaia数据&quot;&gt;获取太阳附近的Gaia数据&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;打开TAP窗口，搜索&lt;code class=&quot;highlighter-rouge&quot;&gt;gaia&lt;/code&gt;并选择&lt;strong&gt;GAIA&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;选择&lt;code class=&quot;highlighter-rouge&quot;&gt;gaiadr2_gata_source&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;在ADQL Text窗口输入：
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT ra, dec, pmra, pmdec, parallax, radial_velocity, bp_rp,
phot_g_mean_mag + 5*log10(parallax/100) as g_abs
FROM gaiadr2.gaia_source WHERE parallax &amp;gt; 15 AND parallax_over_error &amp;gt; 5
AND radial_velocity IS NOT NULL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;tap教程&quot;&gt;TAP教程&lt;/h2&gt;

&lt;h3 id=&quot;下载整个星表&quot;&gt;下载整个星表&lt;/h3&gt;

&lt;p&gt;SELECT * FROM “table_name”&lt;/p&gt;

&lt;p&gt;星表的名字可以先去Vizier搜链接，然后在TAP上找，就有了。&lt;/p&gt;

&lt;h3 id=&quot;选择星表的前n行select&quot;&gt;选择星表的前n行：SELECT&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT TOP 1 1+1 AS result FROM gaiadr1.tgas_source&lt;/code&gt;
&lt;img src=&quot;/img/in-post/post-topcat/T-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT [TOP setLimit] selectList FROM fromClause [WHERE conditions] [GROUP BY columns] [ORDER BY columns] &lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;选择 行内容 列内容 AS 结果列名 FROM 源星表&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT TOP 10 * FROM gaiadr1.tgas_source&lt;/code&gt;
&lt;img src=&quot;/img/in-post/post-topcat/T-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;*&lt;/code&gt;表示全部列都要（握拳）。&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;排序order-by&quot;&gt;排序：ORDER BY&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT TOP 5 source_id, parallax
  FROM gaiadr1.tgas_source
  ORDER BY parallax
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/img/in-post/post-topcat/T-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;降序的话可以这样写：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT TOP 5 source_id, parallax
  FROM gaiadr1.tgas_source
  ORDER BY parallax DESC
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT TOP 5 source_id, phot_g_mean_mag , parallax
  FROM gaiadr1.tgas_source
  ORDER BY phot_g_mean_mag, parallax
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;第二个排序列名的作用暂未确定。噢顺便，首行不缩进是因为：好看。&lt;/p&gt;

&lt;p&gt;练习：在gaiadr1.tgas_source中选出最亮的20颗星的id和视星等&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;表达式的一些内容&quot;&gt;表达式的一些内容&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;SQL中的名字是大小写敏感的&lt;/li&gt;
  &lt;li&gt;浮点数形式：&lt;code class=&quot;highlighter-rouge&quot;&gt;4.5e-8&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;字符串必须用单引号括起来（双引号不行）&lt;/li&gt;
  &lt;li&gt;运算符号们
    &lt;ul&gt;
      &lt;li&gt;加减乘除：&lt;code class=&quot;highlighter-rouge&quot;&gt;+-*/&lt;/code&gt;；次幂：&lt;code class=&quot;highlighter-rouge&quot;&gt;POWER(), SQRT(x),  SQUARE(x)&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;不等号：&lt;code class=&quot;highlighter-rouge&quot;&gt;=, &amp;lt;, &amp;gt;, &amp;lt;=, &amp;gt;=&lt;/code&gt;；注意不是&lt;code class=&quot;highlighter-rouge&quot;&gt;==&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;和或否：&lt;code class=&quot;highlighter-rouge&quot;&gt;AND, OR, NOT&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;字符串相加：&lt;code class=&quot;highlighter-rouge&quot;&gt;||&lt;/code&gt;（未验证）&lt;/li&gt;
      &lt;li&gt;格式化字符串：&lt;code class=&quot;highlighter-rouge&quot;&gt;LIKE()&lt;/code&gt;；支持&lt;code class=&quot;highlighter-rouge&quot;&gt;%, _, *, ?&lt;/code&gt;等（未验证）&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;COS, ASIN, ATAN, ATAN2, COS, SIN, TAN&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EXP, LOG&lt;/code&gt;(natural logarithm),&lt;code class=&quot;highlighter-rouge&quot;&gt;LOG10&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FLOOR(x), CEILING(x), ROUND(x), ROUND(x, n), TRUNCATE(x), TRUNCATE(x,n)&lt;/code&gt;；n表示截止到多少位小数&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DEGREES(rads), RADIANS(degs)&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RAND(seed)&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MOD(x,y)&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT TOP 10
  source_id,
  SQRT(POWER(pmdec_error,2)+POWER(pmra_error,2)) AS pm_errTot
  FROM gaiadr1.tgas_source
  ORDER BY pm_errTot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;自己算出来的东西&lt;code class=&quot;highlighter-rouge&quot;&gt;pm_errTot&lt;/code&gt;马上就可以拿来排序。&lt;/p&gt;

&lt;p&gt;练习：Select the source id, position, proper motion in arcsec/yr and mag g for the 20 fastest stars in tgas_source.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;有条件选择where&quot;&gt;有条件选择：WHERE&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT source_id, ra, dec
  FROM gaiadr1.tgas_source
  WHERE
  phot_g_mean_flux &amp;gt; 13
  AND parallax &amp;lt; 0.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;练习：Select the absolute magnitude, position and the source id for the 20 stars with the largest observed apparent magnitude in the g band from the table tgas_source (in case you don’t remember: The absolute magnitude is M= 5 + 5log π+ m with the parallax in arcsec π and the apparent magnitude m (check the units!). This will fail. Try to fix it.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;交叉证认join&quot;&gt;交叉证认：JOIN&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT TOP 10 h1.ra, h1.dec, h1.hip, t1.hip
  FROM hipparcos AS h1
  JOIN tycho2 AS t1
  USING (hip)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM hipparcos AS h1
  JOIN tycho2 AS t1
  USING (hip)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Don’t execute them.这俩是假例子。这俩的结果应该是内积。&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;更复杂的交叉证认join-on&quot;&gt;更复杂的交叉证认：JOIN ON&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT TOP 20 source_id, h.hip
  FROM gaiadr1.tgas_source AS tgas
  LEFT OUTER JOIN hipparcos as h ON (tgas.phot_g_mean_mag BETWEEN h.hpmag -0.05 AND h.hpmag+0.05)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这里就不是内积了，是留左表，同时交叉条件改成了星等差在&lt;script type=&quot;math/tex&quot;&gt;\pm 0.05&lt;/script&gt;之内。
（会出现1对n的情况吗？）&lt;/p&gt;

&lt;p&gt;举一反三，肯定还有&lt;code class=&quot;highlighter-rouge&quot;&gt;INNER JOIN&lt;/code&gt;（和&lt;code class=&quot;highlighter-rouge&quot;&gt;JOIN&lt;/code&gt;一样）、&lt;code class=&quot;highlighter-rouge&quot;&gt;RIGHT OUTER JOIN&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;FULL OUTER JOIN&lt;/code&gt;。&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;令人头大的交叉证认基于位置&quot;&gt;令人头大的交叉证认：基于位置&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT TOP 5
  source_id, tgas.ra, tgas.dec, tm.raj2000, tm.dej2000, hmag, e_hmag
  FROM gaiadr1.tgas_source as tgas
  JOIN twomass AS tm
  ON 1=CONTAINS (
     POINT('ICRS', tm.raj2000, tm.dej2000),
     CIRCLE('ICRS', tgas.ra, tgas.dec, 1.5/3600))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果历元不同的话，最好不要在查询中转换历元（位置加减自行），而是将交叉半径扩大，然后用WHERE去解决历元的问题：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT
   TOP 30
   *
   FROM ppmxl AS m
   JOIN gaiadr2.gaia_source AS g
   ON 1=CONTAINS(POINT('ICRS', m.raj2000, m.dej2000),
                 CIRCLE('ICRS', g.ra, g.dec, 30./3600.))
   WHERE 1=CONTAINS(POINT('ICRS',
   m.raj2000+m.pmra*COS(RADIANS(m.dej2000))*15,
   m.dej2000+m.pmde*15),
   CIRCLE('ICRS', g.ra, g.dec, 0.5/3600.))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;俄罗斯套娃查询中的查询&quot;&gt;俄罗斯套娃：查询中的查询&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SELECT count(*) as n, round((hmag-jmag)*2) as bin
  FROM (SELECT TOP 4000 * FROM twomass) AS q
  GROUP BY bin
  ORDER BY bin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;(SELECT TOP 4000 * FROM twomass)&lt;/code&gt;就是一个小的查询，用括号括起来就行了&lt;/p&gt;

&lt;h2 id=&quot;topcat使用的某些tips&quot;&gt;TOPCAT使用的某些tips&lt;/h2&gt;

&lt;h3 id=&quot;表格&quot;&gt;表格&lt;/h3&gt;

&lt;p&gt;Column Window中的 &lt;img src=&quot;/img/in-post/post-topcat/T-4.png&quot; alt=&quot;&quot; /&gt; 可以为subset在总表中添加布尔值标识&lt;/p&gt;
</description>
        <pubDate>Sat, 19 Jan 2019 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2019/01/19/topcat/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/01/19/topcat/</guid>
        
        <category>learning</category>
        
        
      </item>
    
  </channel>
</rss>
