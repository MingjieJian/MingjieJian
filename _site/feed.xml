<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mingjie's Blog</title>
    <description>ひびけ</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Mon, 22 Jan 2018 12:55:10 +0900</pubDate>
    <lastBuildDate>Mon, 22 Jan 2018 12:55:10 +0900</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>箱根探路者</title>
        <description>&lt;p&gt;箱根是我一直想去的地方，一是因为在那能看见富士山，第二是那里是新世纪福音战士第三新东京市的原型。正好这周想出去逛逛（当然发现switch入货是临时的事情），来实习的诺亚同学也刚好错过了松永组织的镰仓社寺一日游（真的全是社寺），就拉上他一起去那看看了。当然也有踩点的意思，毕竟下个月打算还来一次。&lt;/p&gt;

&lt;h3 id=&quot;大致路线&quot;&gt;大致路线&lt;/h3&gt;

&lt;p&gt;因为只能去一天，所以基本上是按照小田急给出的示范行程来走的，从箱根汤本一路往西经过强罗、大涌谷到达桃源台港，然后坐船穿过芦之湖到达箱根町和元箱根，稍作参观之后坐巴士回到箱根汤本，終了。一路的交通都是挺方便的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/hakone-route.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;出发之前&quot;&gt;出发之前&lt;/h3&gt;

&lt;p&gt;东京到箱根的交通大致分为两类：不使用JR和使用JR。一般不使用JR的方式是在新宿站购买小田急的箱根Free Pass（箱根フリーパス）并预约来回的特急“浪漫特快”（ロマンスカー），这样可以解决全部在箱根的交通问题和一大部分的景点门票。从新宿出发的2日箱根Free Pass是5140日元（儿童是1500），购买Free Pass之后单程的浪漫特快还需要加890日元，所以一共是6920日元。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/freepass-price.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Free Pass只有两天和三天的选择，所以即使只去一天也需要买两天的。不过这么一圈坐下来如果不买Pass的话大概是六千多日元，而且有Pass的话上下车相对自由一点。这些票都可以在新宿或者小田原的小田急窗口处购买。&lt;/p&gt;

&lt;p&gt;如果有JR Pass的话也可以选择乘坐JR到小田原再转箱根登山铁道到箱根汤本。上面最后一行写的就是在小田原购买箱根Free Pass的价格；如果不购买的话交通费大概是四千七日元，所以也还是买Pass便宜一点。&lt;/p&gt;

&lt;h3 id=&quot;特急浪漫特快&quot;&gt;特急“浪漫特快”&lt;/h3&gt;

&lt;p&gt;开往箱根汤本的浪漫特快无论工作日还是周末都是从7点钟开始首发，平均下来大概半个小时一班的样子。不住在新宿附近的话周末选择7:30、8:00、8:30或者9:00的比较合适，工作日的话就是7:00、7:27或者8:53了。（请注意时刻表可能会变，请到&lt;a href=&quot;http://www.odakyu.jp/romancecar/timetable/weekday/&quot;&gt;这里&lt;/a&gt;确认一下）。回来的车基本上都会停新宿，所以选择余地比较大，我觉得晚上7点出发的比较合适。&lt;/p&gt;

&lt;p&gt;时刻表里面带“展”字的车次是有展望席的，车头或者车尾有很大的窗户，适合观景。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/view-seat.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;大概是这个样子，司机要爬到上面开车。这些票和旺季（春节？）的特急票都可以在&lt;a href=&quot;https://www.web-odakyu.com/e-romancecar/&quot;&gt;这里&lt;/a&gt;提前预约或者购买。实际上展望席后面还紧接着两个不算展望席的座位，但是位置是和展望席一样的，所以没有预约到展望席又想坐在附近的话不妨在买票的时候问问还有没有展望席的位置。&lt;/p&gt;

&lt;p&gt;浪漫特快虽然叫特快，但是毕竟不是新干线而且过了小田原之后的登山铁道部分只有单线，所以从新宿出发还是需要85分钟的，请带上论文/书/ipad/3DS/Switch等。&lt;/p&gt;

&lt;h3 id=&quot;强罗午饭&quot;&gt;强罗=午饭&lt;/h3&gt;

&lt;p&gt;出于对时间的些许担心，我们决定到了箱根汤本之后马上去强罗。换乘去强罗的登山电车不需要出闸，直接到3号站台坐车就行。虽然从地图上看箱根汤本到强罗并不算远，但是登山电车本来就慢加上路上有三处像京张铁路的人字形轨道，所以整个用时为40分钟。这么下来我们到强罗的时候已经是10点半，该吃午饭了。&lt;/p&gt;

&lt;p&gt;这么早考虑午饭的原因在于想去试试一家比较出名的餐厅，田むら銀かつ亭。很多攻略都推荐了这家餐厅，既然来了就去试试呗。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/resturant.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;就是这家。11点开始营业，但是一般10点半开始就会有人来取号，开始营业之后按照号码顺序就餐。我们大概是40到的，已经是11号了。当然吃完之后出来发现还有将近三十个号在排队，看来的确挺出名的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/lunch.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;午饭基本上点的都是招牌套餐，豆腐猪排套餐(1330日元)和御膳(2050日元)。这两种的区别在于后者多了一个甜品、饮料和沙拉，而且后者的猪排下面是有小火一直加热的。我上面点的是套餐，就只有这几样。感觉还挺好吃，不过排队的人数让我觉得里面也有宣传的成分。&lt;/p&gt;

&lt;h3 id=&quot;强罗公园&quot;&gt;强罗公园&lt;/h3&gt;

&lt;p&gt;吃完饭之后走了走附近的强罗公园。冬天能看的不多，也没有雪，就是近处的温泉和远处的火山烟：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/gora-park.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;值得一提的是公园里面还有两个热带植物馆，可以取暖（误）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/park-flower1.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/park-flower2.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;看到了在南方随处可见的勒杜鹃还有鹤望兰。&lt;/p&gt;

&lt;h3 id=&quot;大涌谷&quot;&gt;大涌谷&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/cable-car.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;从强罗公园南门出来左转走一分钟就到了登山缆车的公园下站，等一会就有缆车带着上到早云山了。还是要注意一下发车时刻的，间隔在20分钟左右。本来在早云山可以直接转乘空中缆车到达大涌谷（顺便在空中看看硫磺烟），但是1月16日到2月7日之间早云山-大涌谷之间的&lt;a href=&quot;http://www.hakoneropeway.co.jp/info_img/255_pdf.pdf&quot;&gt;缆车维修&lt;/a&gt;，所以只能坐专用的大巴过去。出战之后跟着大部队走就行了，我们坐的是旅游大巴所以都有位置。&lt;/p&gt;

&lt;p&gt;大涌谷就是火山活动留下来的一直在往外冒烟的山谷，而因为附近硫磺比较多所以空气比较…臭。看还是挺好看的，也有很多吃的和纪念品卖。最出名的应该就是黑色的鸡蛋了，用山上的温泉泡熟，因为水中的成分和鸡蛋壳作用变成了黑色。实际上就是煮鸡蛋，里面没有任何区别。大涌谷本来还有两条登山道，但是我们去的时候因为空气中硫化物含量太高&lt;a href=&quot;http://www.hakoneropeway.co.jp/ohwakudani/&quot;&gt;封闭了&lt;/a&gt;，可惜。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/owakudani.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;芦之湖&quot;&gt;芦之湖&lt;/h3&gt;

&lt;p&gt;整个行程可能最需要注意的就是芦之湖海贼船的&lt;a href=&quot;https://www.hakone-kankosen.co.jp/timesheet/&quot;&gt;时刻表&lt;/a&gt;了，间隔可能会到一个小时左右，所以在大涌谷的时候要留意时间。大涌谷到湖边的桃源台港需要16分钟，也是空中缆车，之后就可以等着船准备坐半个小时了。如果嫌船挤的话可以花500日元买高级舱的票，人就不那么多了（资本主义）。在船上可以看见湖边的鸟居：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/lake-tori.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;至于终点到箱根町还是元箱根都没什么所谓，就算是走路也才十来分钟而已，还有巴士来往。&lt;/p&gt;

&lt;h3 id=&quot;箱根町和元箱根&quot;&gt;箱根町和元箱根&lt;/h3&gt;

&lt;p&gt;到这里的时候已经过了四点，天开始黑了，我们就只走了走箱根关所和恩赐箱根公园。这公园原来是天皇避暑的地方，也接待过不少政界要人，但是在之后的两次地震之中塌了75%的楼宇……现在只有一栋楼在那了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/park-tree.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;别的还有箱根神社可以看看，挺大的。晚上路灯亮了之后很有神秘的感觉。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-hakone-pathfinder/shrine.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后就是坐巴士回箱根汤本了。在元箱根出发的话R、H和K线都能到箱根汤本，每天的最后一班是R线17:40的车，25分钟到箱根汤本。错过了的话……我不知道了:)&lt;/p&gt;

&lt;h3 id=&quot;回程&quot;&gt;回程&lt;/h3&gt;

&lt;p&gt;回去之后还有一点时间，想逛一下EVA屋但是关门了。这个时候基本上所有的店铺都开始关门了，但是还是可以进去逛一下的；站内的商店没关，但是便当就不一定有了，另外我们坐的19:10的特急没有车内售卖的服务，所以最差的情况可能需要在附近的便利店买点吃的或者看看站台的小卖部有没有了（但是我没有确认过）。回到新宿8点半，时间挺合适。我觉得箱根还是一天比较好，虽然是一天稍微有一点赶，但是两天又感觉景点不够支撑的，没有太特别的理由一天就行。&lt;/p&gt;

&lt;h3 id=&quot;also-read&quot;&gt;Also Read&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.hakonenavi.jp/cn/&quot;&gt;小田急箱根导航&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.marshyfood.com/2015/06/2015.html&quot;&gt;有用的攻略&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 22 Jan 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/01/22/hakone-pathfinder/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/01/22/hakone-pathfinder/</guid>
        
        <category>hanging-around</category>
        
        
      </item>
    
      <item>
        <title>如何在Linux上制作延时摄影视频</title>
        <description>&lt;p&gt;在Windows上制作延时摄影有很多软件，AE、LRTimelapse（去闪）之类的；但是Linux上相关的制作软件虽然有，但是并不是很熟悉。隐约感觉Linux肯定能做，而且可以在命令行上面做，但是需要问问谷歌。结果来说的确可以做出来，这里就把相关的软件以及命令记录一下。&lt;/p&gt;

&lt;h3 id=&quot;原材料&quot;&gt;原材料&lt;/h3&gt;

&lt;p&gt;2017年底拍摄的东大赤门的100张照片，间隔大概在1秒左右，jpg格式。&lt;/p&gt;

&lt;h3 id=&quot;处理jpg文件&quot;&gt;处理jpg文件&lt;/h3&gt;

&lt;p&gt;因为拍摄的时候曝光有点不足，所以需要对每张照片进行亮度和对比度的处理。这里用的是GIMP；如果没有安装过的话先安装GIMP：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo apt-get install gimp&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;然后安装批处理的插件：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo apt-get install gimp-plugin-registry&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-time-lapse-linux/batch-open.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;安装之后打开GIMP，上方菜单栏里面会多了一些栏目。选择&lt;code class=&quot;highlighter-rouge&quot;&gt;Filters - Batch - Batch Process&lt;/code&gt;：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-time-lapse-linux/batch-window.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这个批处理窗口提供了一些我们需要的功能。选择&lt;code class=&quot;highlighter-rouge&quot;&gt;Add Files&lt;/code&gt;将要处理的照片都添加进去。简单的亮度对比度颜色处理在&lt;code class=&quot;highlighter-rouge&quot;&gt;Colour&lt;/code&gt;里面，选择&lt;code class=&quot;highlighter-rouge&quot;&gt;Enable&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;Auto Levels&lt;/code&gt;就可以了。最后在&lt;code class=&quot;highlighter-rouge&quot;&gt;Rename&lt;/code&gt;里面选择要输出的文件夹，需要的话先测试一下(&lt;code class=&quot;highlighter-rouge&quot;&gt;Test&lt;/code&gt;)，觉得没有问题的话&lt;code class=&quot;highlighter-rouge&quot;&gt;Start&lt;/code&gt;就行。处理过程中可能会报错，但是只要能成功输出就不用管了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-time-lapse-linux/comp.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;处理前后的对比&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;将jpg转换成视频&quot;&gt;将jpg转换成视频&lt;/h3&gt;

&lt;p&gt;所以我们现在有了一堆处理过的jpg文件，之后只要把它们拼成视频就行了。这一步需要保证文件的顺序是正确的，也就是没有从999到001的情况。如果有的话需要将它们按照正确的顺序重命名。另一个需要注意的细节是可以通过命令调节输出视频的分辨率，不过我一般按照源片的分辨率来，也不用调整了。拼合的命令如下：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ffmpeg -r 24 -pattern_type glob -i '*.jpg' -c:v copy output.avi&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-r&lt;/code&gt;后面的数字是帧数，可以随意调整，最后的&lt;code class=&quot;highlighter-rouge&quot;&gt;output.avi&lt;/code&gt;是输出的文件名字。我还没试过其他的格式，而这个命令会原原本本地将照片拼到一个视频里面，所以这个视频是没有被压缩过的，占用的空间和照片们的空间一样。&lt;/p&gt;

&lt;p&gt;这里的视频大小是2.2G，只是100张照片。当然这个大小不能轻易地放到网上去共享，所以我们进行压缩：&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ffmpeg -i MVI_7274.MOV -vcodec libx264 -preset fast -crf 20 -y -vf &quot;scale=1920:-1&quot; -acodec libmp3lame -ab 128k a.mp4&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;参考链接里面有很详细的介绍，这里不赘述了。最重要的是&lt;code class=&quot;highlighter-rouge&quot;&gt;-crf&lt;/code&gt;后面的参数，数字越小视频质量越高。可以多试几个不同的数字然后取合适的大小和质量。最后的视频如下：&lt;/p&gt;

&lt;iframe width=&quot;100%&quot; height=&quot;400&quot; src=&quot;/img/in-post/post-time-lapse-linux/cloud_tl.mp4&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h3 id=&quot;闲话&quot;&gt;闲话&lt;/h3&gt;

&lt;p&gt;刚刚想到其实也有别的思路，比如在GIMP编辑照片的时候将分辨率降低，那么占用的空间和后续处理时间都会变小。另外GIMP也有命令行模式，应该可以更细致地控制参数；不过稍微有点复杂，还需要研究一下。&lt;/p&gt;

&lt;h3 id=&quot;reference&quot;&gt;Reference&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://ubuntuforums.org/showthread.php?t=2022316&quot;&gt;jpg转成视频&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://segmentfault.com/a/1190000002502526&quot;&gt;视频压缩&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 21 Jan 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/01/21/time-lapse-linux/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/01/21/time-lapse-linux/</guid>
        
        <category>experience</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 8</title>
        <description>&lt;p&gt;虽然第七章说了“只要知道源函数，之后就可以根据辐射转移方程算出每一点的辐射强度了”，但那是对于光深来说的，也就是&lt;script type=&quot;math/tex&quot;&gt;I_\nu(\tau_\nu)&lt;/script&gt;；如果我们继续将光深拆开我们发现我们还要先知道&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;，也就是吸收系数。由原子的束缚-束缚跃迁引起的吸收系数当然只在某个波长范围内才不为0（形成谱线），但是由另一些跃迁/物理过程引起的吸收系数却对很宽的波长范围有效，我们称之为连续谱吸收系数。连续谱吸收的重要性在于它决定了光谱整体的形状，当我们希望比较理论光谱和观测光谱的时候需要将理论的归一化光谱转换成真正的光谱。同时在计算恒星模型的时候我们也需要用到连续吸收系数，除非我们直接用已知的模型来套在其他恒星身上。所以这章讨论的就是连续谱的吸收系数。&lt;/p&gt;

&lt;h3 id=&quot;连续谱吸收的来源&quot;&gt;连续谱吸收的来源&lt;/h3&gt;

&lt;p&gt;连续谱吸收的来源可以被归为两大类：电离过程（以及逆过程）和束缚-束缚跃迁。电离过程当然可以吸收/发出任何波长的光，只是量的多少而已。但是束缚-束缚跃迁作为谱线的主要来源一般是不作为连续谱吸收考虑的，这里的例外情况是当谱线非常密集的时候，它们总体造成的结果很像连续谱的吸收。之后我们会主要讨论这两类的吸收；但是在进入每种详细的吸收系数计算之前有必要先定义一个中间量：原子吸收系数。&lt;/p&gt;

&lt;p&gt;原子吸收系数&lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;指的是在某个波长上一个原子（或者是其他吸收粒子）的吸收截面大小。这个值肯定随着波长变化，而它乘上原子的数量（或者是归一化到另一种原子比如说氢原子的数量比例）就是这种原子的连续吸收系数&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;或者&lt;script type=&quot;math/tex&quot;&gt;\kappa_\lambda&lt;/script&gt;了。实际上原子吸收系数的推导比较复杂，所以之后一般只给出结论；来源会在文中标明，或者去看Ivan Hubeny《Theory of Stellar Atmospheres: An Introduction to Astrophysical Non-equilibrium Quantitative Spectroscopic Analysis》的第七章（后面提及的时候简称为TSA；我先吐会血）。&lt;/p&gt;

&lt;h3 id=&quot;受激辐射因子&quot;&gt;受激辐射因子&lt;/h3&gt;

&lt;p&gt;还有一个小东西要先提出来。很多过程中是有受激辐射的；本来我处于一个高能态但是环境不变的话我不会放出光子，现在你拿光来照我我肯定受不了要往低能态跑，光子就多了。考虑&lt;script type=&quot;math/tex&quot;&gt;(5.17)&lt;/script&gt;第二条式子和第一章里面的两能级占据数比例关系，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \kappa_\nu\rho &amp; = N_l B_{lu} h\nu - N_uB_{ul} h\nu \\ &amp;= N_l B_{lu} h\nu (1 - \frac{N_uB_{ul}}{N_l B_{lu}}) \\ &amp;= N_l B_{lu} h\nu (1-e^{-h\nu/kT}) \end{align} \tag{8.1} %]]&gt;&lt;/script&gt;

&lt;p&gt;所以考虑受激辐射的时候只是比单纯考虑吸收多乘上一个&lt;script type=&quot;math/tex&quot;&gt;(1-e^{-h\nu/kT})&lt;/script&gt;因子；这是当然的因为吸收光的物质本身也在发出光子所以总吸收就减小了。这给我们的计算带来的不小的方便，只需要先算好所有的吸收然后在最后加起来之后乘上这个因子就对了；我们将在最后才乘上它。&lt;/p&gt;

&lt;h3 id=&quot;中性氢&quot;&gt;中性氢&lt;/h3&gt;

&lt;h5 id=&quot;束缚-自由跃迁&quot;&gt;束缚-自由跃迁&lt;/h5&gt;

&lt;p&gt;有必要先把里德堡公式搬出来：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{1}{\lambda} = R(\frac{1}{n^2} - \frac{1}{m^2}) \tag{8.2}&lt;/script&gt;

&lt;p&gt;讨论电离的时候把&lt;script type=&quot;math/tex&quot;&gt;m&lt;/script&gt;改成&lt;script type=&quot;math/tex&quot;&gt;\infty&lt;/script&gt;就行了。我们之后用&lt;script type=&quot;math/tex&quot;&gt;\chi&lt;/script&gt;表示能级&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;与基态之间的能量，&lt;script type=&quot;math/tex&quot;&gt;I&lt;/script&gt;表示基态到&lt;script type=&quot;math/tex&quot;&gt;n = \infty&lt;/script&gt;之间的能量：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \chi &amp;= I - hRc/n^2 \\ &amp;= hRc - hRc/n^2 \\ &amp;= I(1 - 1/n^2) \end{align} \tag{8.3} %]]&gt;&lt;/script&gt;

&lt;p&gt;中性氢的束缚-自由辐射（电离）可以发生在任一个能级上；&lt;a href=&quot;http://www.tandfonline.com/doi/abs/10.1080/14786442308565244&quot;&gt;Kramers (1923)&lt;/a&gt;和&lt;a href=&quot;http://adsabs.harvard.edu/abs/1930RSPTA.229..163G&quot;&gt;Gaunt (1930)&lt;/a&gt;推出了束缚-自由辐射的吸收系数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \alpha_\mathrm{bf} &amp;= \frac{32}{2^{3/2}}\frac{\pi^2e^6}{h^3}\frac{R}{n^5\nu^3}g_\mathrm{bf} \\ &amp;= \frac{32}{2^{3/2}}\frac{\pi^2e^6}{h^3c^3}\frac{R\lambda^3}{n^5}g_\mathrm{bf} \\ &amp;= \alpha_0g_\mathrm{bf} \frac{\lambda^3}{n^5} \mathrm{cm^2}每个中性氢 \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;当&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;以埃为单位时&lt;script type=&quot;math/tex&quot;&gt;\alpha_0 = 1.0449\times10^{-26}&lt;/script&gt;；&lt;script type=&quot;math/tex&quot;&gt;g_\mathrm{bf}&lt;/script&gt;是从经典转换到量子的因子，接近1。&lt;a href=&quot;http://adsabs.harvard.edu/abs/1961ApJS....6..167K&quot;&gt;Karzas and Latter (1961)&lt;/a&gt;给出了一个表，但是一般来说用&lt;a href=&quot;http://adsabs.harvard.edu/abs/1935MNRAS..96...77M&quot;&gt;Menzel and Pekris (1935)&lt;/a&gt;的公式就足够了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;g_\mathrm{bf} = 1 - \frac{0.3456}{(\lambda R^{1/3})}(\frac{\lambda R}{n^2}-\frac{1}{2})&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} g_\mathrm{ff} &amp;= 1 + \frac{0.3456}{(\lambda R^{1/3})}(\frac{\lambda kT}{hc}-\frac{1}{2}) \\ &amp;= 1 + \frac{0.3456}{(\lambda R^{1/3})}(\frac{\log{e}}{\theta \chi_\lambda}-\frac{1}{2}) \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;分别对应束缚-自由和自由-自由过程。&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;仍然以埃为单位，&lt;script type=&quot;math/tex&quot;&gt;\theta = \frac{5040}{T}&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP8/gaunt.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;束缚-自由过程的Gaunt因子&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP8/alpha_H_bf.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;(线系限波长取自维基百科)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;如上图，不同线系在波长小于线系限处&lt;script type=&quot;math/tex&quot;&gt;\alpha_\mathrm{bf}&lt;/script&gt;不为0，且在线系限处&lt;script type=&quot;math/tex&quot;&gt;\lambda = n^2/R&lt;/script&gt;，所以此处的&lt;script type=&quot;math/tex&quot;&gt;\alpha_\mathrm{bf}&lt;/script&gt;与&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;成正比。&lt;script type=&quot;math/tex&quot;&gt;n = 1&lt;/script&gt;时的氢原子波尔半径为&lt;script type=&quot;math/tex&quot;&gt;0.53 Å&lt;/script&gt;，对应的“面积”为&lt;script type=&quot;math/tex&quot;&gt;8.8 \times 10^{-17} \mathrm{cm^2}&lt;/script&gt;，和912&lt;script type=&quot;math/tex&quot;&gt;Å&lt;/script&gt;处的原子吸收系数在同一个量级上。&lt;script type=&quot;math/tex&quot;&gt;\alpha_\mathrm{bf}&lt;/script&gt;的上升是很快的(&lt;script type=&quot;math/tex&quot;&gt;\propto \lambda^3&lt;/script&gt;)，而且从图中看到即使我们只考虑某个&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;主导的波长范围，其他&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;的吸收系数也不能忽略（特别是长波处），所以在求&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;的时候要从某个&lt;script type=&quot;math/tex&quot;&gt;n_0&lt;/script&gt;开始，对之后所有的&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;求和：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa(\mathrm{H_{bf}}) = \sum_{n_0}^\infty \frac{\alpha_\mathrm{bf}(\mathrm{H})N_n}{N}&lt;/script&gt;

&lt;p&gt;利用&lt;a href=&quot;https://mingjiejian.github.io/2017/11/11/OASP1/&quot;&gt;第一章&lt;/a&gt;原子激发和电离的公式并将氢原子能级的可能态数代入：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \frac{N_n}{N} &amp;= \frac{g_n}{g_1} e^{-\frac{\chi}{kT}} \\ &amp;= \frac{2n^2}{2} e^{-\frac{\chi}{kT}} \end{align} %]]&gt;&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \Rightarrow \kappa(\mathrm{H_{bf}}) &amp;= \alpha_0 \sum^{n_0}_\infty \frac{\lambda^3}{n^3}g_\mathrm{bf}e^{-\frac{\chi}{kT}} \\ &amp;= \alpha_0 \sum^{n_0}_\infty \frac{\lambda^3}{n^3}g_\mathrm{bf}10^{-\theta\chi} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;Unfold (1995)证明了大于&lt;script type=&quot;math/tex&quot;&gt;n_0 + 2&lt;/script&gt;的项之和可以用一个积分来代替：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\sum_{n_0+3}^\infty \frac{1}{n^3}e^{-\frac{\chi}{kT}} = -\frac{1}{2} \int_{n_0+3}^{\infty} e^{-\chi/kT} d(1/n^2)&lt;/script&gt;

&lt;p&gt;由&lt;script type=&quot;math/tex&quot;&gt;(8.3)&lt;/script&gt;得&lt;script type=&quot;math/tex&quot;&gt;d\chi = -Id(1/n^2)&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \sum_{n_0+3}^\infty \frac{1}{n^3}e^{-\frac{\chi}{kT}} &amp;= \frac{1}{2} \int_{n_0+3}^{\infty} e^{-\chi/kT} \frac{d(\chi)}{I} \\ &amp;= \frac{kT}{2I} (e^{-\chi_3/kT} - e^{-I/kT}) \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;其中&lt;script type=&quot;math/tex&quot;&gt;\chi_3 = I[1 - \frac{1}{(n_0+3)^2}]&lt;/script&gt;。不同&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;的Gaunt因子又被设成了1，因为这个积分相比前面三项求和来说很小。&lt;/p&gt;

&lt;p&gt;所以最终的吸收系数为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa(\mathrm{H_{bf}}) = \alpha_0\lambda^3[\sum_{n_0}^{n_0+2}\frac{g_\mathrm{bf}}{n^3}10^{-\theta\chi} + \frac{\log{e}}{2\theta I}(10^{-\chi_2\theta} - 10^{-I\theta})]&lt;/script&gt;

&lt;h5 id=&quot;自由-自由跃迁&quot;&gt;自由-自由跃迁&lt;/h5&gt;

&lt;p&gt;自由-自由跃迁的吸收截面比束缚-自由跃迁的小不少，同时它还和自由电子的速度有关。&lt;a href=&quot;http://www.tandfonline.com/doi/abs/10.1080/14786442308565244&quot;&gt;Kramers (1923)&lt;/a&gt;给出了结论：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;d\alpha_\mathrm{ff}(\mathrm{H}) = \frac{2}{3^{3/2}}\frac{h^2e^2R}{\pi m_e^3} \frac{1}{\nu^3v} dv&lt;/script&gt;

&lt;p&gt;那么要求&lt;script type=&quot;math/tex&quot;&gt;\alpha_\mathrm{ff}(\mathrm{H})&lt;/script&gt;当然要将上式乘上Maxwell-Boltzmann分布再积分：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \alpha_\mathrm{ff}(\mathrm{H}) &amp;= \frac{2}{3^{3/2}}\frac{h^2e^2R}{\pi m_e^3} \frac{1}{v} \int_0^\infty (\frac{2}{\pi})^{1/2} (\frac{m}{kT})^{3/2} v e^{-(mv^2/kT)} \\ &amp;= \frac{2}{3^{3/2}}\frac{h^2e^2R}{\pi m_e^3} \frac{1}{v} (\frac{2m}{\pi kT})^{1/2} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;同理，吸收系数就是吸收截面乘上Guant因子和归一化的粒子数量（在这里是质子和电子）就行了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa(\mathrm{H_{ff}}) = \frac{\alpha_\mathrm{ff}(\mathrm{H}) g_\mathrm{ff} N_\mathrm{p} N_\mathrm{e}}{N_0}&lt;/script&gt;

&lt;p&gt;加上Saha公式（不过我还没推出来）：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa(\mathrm{H_{ff}}) = \alpha_0 \lambda^3 g_\mathrm{ff} \frac{\log{e}}{2\theta I} 10^{-\theta I}&lt;/script&gt;

&lt;p&gt;在B、A型恒星中，中性氢是主要的连续谱吸收来源，所以我们会在它们的光谱中看到明显的特征比如线系限处的下降。但是低温恒星的中性氢吸收很少，主要来源转为负氢离子。&lt;/p&gt;

&lt;h3 id=&quot;负氢离子&quot;&gt;负氢离子&lt;/h3&gt;

&lt;p&gt;负氢离子就是氢原子加上一个电子在周围，并没有养生功效（比如&lt;a href=&quot;https://www.youtube.com/results?search_query=Negative+Hydrogen+Ions&quot;&gt;这些……&lt;/a&gt;）。负氢离子的结合能是0.755eV，所以波长小于16421Å的光子都能将它电离。这些“多余”的电子来自处于电离态的金属（you know比氢氦重的家伙们），所以负氢离子以及它的吸收性质依赖于金属的丰度以及它们电离的程度。像之前说的负氢离子的吸收主要在中温度的恒星中出现；高温会把负氢离子电离，而低温会减少负氢离子所需的额外电子供给。&lt;/p&gt;

&lt;p&gt;给出结论：&lt;a href=&quot;http://adsabs.harvard.edu/abs/1979MNRAS.187P..59W&quot;&gt;Wishart (1979)&lt;/a&gt;给出了在2250到15000Å处误差小于0.2%的吸收截面六次多项式拟合：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP8/alpha_Hm_bf.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以看出来最大值在8500Å左右。&lt;/p&gt;

&lt;p&gt;同样的利用Saha公式:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\log{\frac{N(\mathrm{H})}{N(\mathrm{H^-})}} = -\log{P_\mathrm{e}} - \theta I + 2.5 \log{T} + \log{\frac{2}{1}} - 0.1762&lt;/script&gt;

&lt;p&gt;有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa(\mathrm{H_{bf}^-}) = 4.158\times10^{-10} \alpha_\mathrm{bf} P_\mathrm{e} \theta^{5/2} 10^{0.754\theta}&lt;/script&gt;

&lt;p&gt;自由-自由吸收（氢原子与电子的复合）的截面以及系数的表达式由&lt;a href=&quot;http://iopscience.iop.org/article/10.1088/0022-3700/20/4/019/pdf&quot;&gt;Bell and Berrington (1987)&lt;/a&gt;给出。它主要影响红外辐射，用这个公式算出来的吸收系数已经考虑了受激辐射。图的话请看下面的gif。&lt;/p&gt;

&lt;h3 id=&quot;其他氢&quot;&gt;其他氢&lt;/h3&gt;

&lt;p&gt;继续往低温方向走，我们会遇到氢分子&lt;script type=&quot;math/tex&quot;&gt;\mathrm{H_2}&lt;/script&gt;。虽然氢分子本身并不会对光谱造成影响，但是它的离子们会。&lt;script type=&quot;math/tex&quot;&gt;\mathrm{H_2^+}&lt;/script&gt;主要在紫外造成吸收，但是在大于3800Å处的吸收只有负氢离子的百分之几。&lt;a href=&quot;https://academic.oup.com/mnras/article/112/1/40/2834699&quot;&gt;Bates (1952)&lt;/a&gt;给出了计算方法。&lt;script type=&quot;math/tex&quot;&gt;\mathrm{H_2^+}&lt;/script&gt;主要造成自由-自由辐射，因为它没有稳定的束缚态。&lt;/p&gt;

&lt;h3 id=&quot;氦&quot;&gt;氦&lt;/h3&gt;

&lt;p&gt;氦也是恒星的主要组成部分之一，但是氦不活泼，所以只能在OB型恒星里面见到。氦原子的&lt;script type=&quot;math/tex&quot;&gt;\chi_1 = 19.72&lt;/script&gt;eV，所以当第一个电子被激发的时候我们可以将剩下的原子核和电子当成一个氢原子来看待：对于&lt;script type=&quot;math/tex&quot;&gt;n \succsim 3&lt;/script&gt;来说，我们有(Ueno 1954)：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\alpha(\mathrm{He}) = 4e^{-10.92/kT}\alpha(\mathrm{H})&lt;/script&gt;

&lt;p&gt;而且这对男朋友(bf)和FFF团(ff)跃迁都有效。氦离子&lt;script type=&quot;math/tex&quot;&gt;\mathrm{He^+}&lt;/script&gt;的行为也和氢原子类似，只不过能量间隔是氢原子的大概4倍。&lt;/p&gt;

&lt;p&gt;负氦离子也是有吸收的，只不过一般不考虑束缚-自由跃迁（因为束缚能级能量大概为19eV）。John(1994)给出了自由-自由跃迁吸收截面的表达式，而知道了吸收截面之后吸收系数可以表示为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa(\mathrm{He_{ff}^-}) = \frac{\alpha(\mathrm{He_{ff}^-})A(\mathrm{He})P_\mathrm{e}}{1 + \Phi(\mathrm{He})/P_\mathrm{e}}&lt;/script&gt;

&lt;p&gt;分母考虑了氦原子的电离。实际上&lt;script type=&quot;math/tex&quot;&gt;\mathrm{He^-}&lt;/script&gt;的吸收一般是很小的。&lt;/p&gt;

&lt;h3 id=&quot;小结&quot;&gt;小结&lt;/h3&gt;

&lt;p&gt;把所有的&lt;script type=&quot;math/tex&quot;&gt;\kappa&lt;/script&gt;加起来就变成了这样：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP8/kappa_animate.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以看出来低温的时候负氢离子的束缚-自由跃迁占主导，随着温度上升不断下降切换成氢原子的跃迁。&lt;/p&gt;

&lt;p&gt;坑：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;算氢原子的bf的时候只算6项不够，要算100项左右；&lt;/li&gt;
  &lt;li&gt;配分函数怎么具体算还不是很明确导致&lt;script type=&quot;math/tex&quot;&gt;\mathrm{He_{ff}^-}&lt;/script&gt;没加进去（虽然都是可以忽略的）；可能需要估计各种元素丰度？&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;电子的thomson散射&quot;&gt;电子的Thomson散射&lt;/h3&gt;

&lt;p&gt;电子的经典以及量子Thomson散射都会给出同一个吸收截面：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\alpha(\mathrm{e}) = \frac{8\pi}{3} (\frac{e^2}{m_\mathrm{e}c^2})^2&lt;/script&gt;

&lt;p&gt;不服请看TSA第六章。至于康普顿散射的截面，只有在光子能量大于5 keV，大概对应&lt;script type=&quot;math/tex&quot;&gt;5\times10^7&lt;/script&gt;度的时候才明显。虽然散射不一定是各向同性的，但是在恒星里面的光被各种散射，所以可以认为总体来说各向同性，所以：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa(\mathrm{e}) = \alpha(\mathrm{e}) \frac{N_\mathrm{e}}{N_\mathrm{H}} = \alpha(\mathrm{e}) \frac{P_\mathrm{e}}{P_\mathrm{H}}&lt;/script&gt;

&lt;p&gt;考虑到恒星中的所有粒子为电子和其他粒子的和，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;N = N_\mathrm{e} + \sum N_\mathrm{j} = N_\mathrm{e} + N_\mathrm{H} \sum A_\mathrm{j}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;A_\mathrm{j} = N_\mathrm{j} - N_\mathrm{H}&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;N_\mathrm{H} = \frac{N - N_\mathrm{e}}{\sum A_\mathrm{j}}, P_\mathrm{H} = \frac{P_\mathrm{g} - P_\mathrm{e}}{\sum A_\mathrm{j}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Rightarrow \kappa(\mathrm{e}) = \alpha(\mathrm{e}) \frac{P_\mathrm{e}}{P_\mathrm{g} - P_\mathrm{e}}\sum A_\mathrm{j}&lt;/script&gt;

&lt;p&gt;在OB型星中，氢原子被电离，&lt;script type=&quot;math/tex&quot;&gt;P_\mathrm{e} \approx 0.5P_\mathrm{g}&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;\kappa(\mathrm{e}) \approx \alpha(\mathrm{e}) \sum A_\mathrm{j} \approx 7\times10^{-25}&lt;/script&gt;cm^2/hydrogen particle。对于低温恒星，&lt;script type=&quot;math/tex&quot;&gt;P_\mathrm{e} \ll P_\mathrm{g} \Rightarrow \kappa_\mathrm{e} / P_\mathrm{e} \approx 7\times10^{-25}/P_\mathrm{g}&lt;/script&gt;；当&lt;script type=&quot;math/tex&quot;&gt;P_\mathrm{g} \approx 10^3-10^5&lt;/script&gt;时，散射吸收系数可以被忽略。&lt;/p&gt;

&lt;h3 id=&quot;其他的吸收源&quot;&gt;其他的吸收源&lt;/h3&gt;

&lt;p&gt;其他的就剩金属元素了。它们的束缚-自由跃迁在紫外提供了额外的吸收系数。精确的计算和之前的过程类似（参考文献请看P163-164）；一些方便的计算方法包括类氢原子的方法，但是不一定对；或者仅适用于LS耦合的quantum defect method (Burgess and Seaton 1960)。&lt;a href=&quot;http://adsabs.harvard.edu/doi/10.1086/149790&quot;&gt;Travis and Matsushima (1968)&lt;/a&gt;给出了下面的图：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP8/kappa_metal.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;要注意这里取了对数，&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;的单位是&lt;script type=&quot;math/tex&quot;&gt;\mathrm{cm^2/g}&lt;/script&gt;。低温恒星还要考虑分子以及分子离子的吸收。&lt;/p&gt;

&lt;h3 id=&quot;谱线&quot;&gt;谱线&lt;/h3&gt;

&lt;p&gt;谱线和连续吸收关系不大，但是低温恒星的谱线非常密集，所以有的时候也要考虑。方法包括将谱线的吸收系数加在最后的连续吸收系数上，或者对光谱进行采样（要看！）。&lt;/p&gt;

&lt;h3 id=&quot;总连续吸收系数&quot;&gt;总连续吸收系数&lt;/h3&gt;

&lt;p&gt;好了该完了。把上面的所有吸收系数加起来，该考虑受激辐射的乘上因子：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa_\mathrm{total} = \{[\kappa(\mathrm{H_{bf}}) + \kappa(\mathrm{H_{ff}}) + \kappa(\mathrm{H_{bf}^-}) + \kappa(\mathrm{H_{2}^+})](1-10^{-\chi_\lambda \theta}) + \kappa(\mathrm{H_{ff}^-}) + ...\} \times \frac{1}{1 + \Phi(\mathrm{H})/P_\mathrm{e}}\\ + \kappa(\mathrm{metals}) + \kappa(\mathrm{He_{ff}^-}) + \kappa(\mathrm{e}) + ...&lt;/script&gt;

&lt;p&gt;大括号后面的因子是将单位从每个中性氢原子专成每个氢原子的（Saha公式）。要转成单位质量的话除一个平均质量就行：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\kappa_\nu = \frac{\kappa_\mathrm{total}}{\sum A_j\mu_j}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\sum A_j\mu_j&lt;/script&gt;的典型值为&lt;script type=&quot;math/tex&quot;&gt;2.0\times10^{-24}&lt;/script&gt;g/H。&lt;/p&gt;
</description>
        <pubDate>Tue, 02 Jan 2018 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2018/01/02/OASP8/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/01/02/OASP8/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 7</title>
        <description>&lt;p&gt;恒星表面的主要传能方式是辐射。对流传能在恒星内部以及低温恒星是不可以忽略的，所以最后会稍微涉及到。同时也只有在辐射传能主导的区域内恒星的物理参数才会跟光谱有关系，之后也会有有效温度的例子。这一章我们会建立辐射传能的微分方程，然后讨论几种简单的解。但是除此之外的解都是数值的，需要进行数值积分。我们希望计算出合成光谱，而这个目标的前提就是有恒星光球层内尽可能多的物理参数；第七八九章就是干这个的。&lt;/p&gt;

&lt;h3 id=&quot;辐射转移方程以及它的通解&quot;&gt;辐射转移方程以及它的通解&lt;/h3&gt;

&lt;p&gt;接着&lt;a href=&quot;https://mingjiejian.github.io/2017/12/18/OASP5/&quot;&gt;第五章&lt;/a&gt;最后两条公式，假设辐射沿着&lt;script type=&quot;math/tex&quot;&gt;s&lt;/script&gt;方向传播，那么光强在一个微元上的变化&lt;script type=&quot;math/tex&quot;&gt;dI_\nu&lt;/script&gt;为损失的光加上增加的光：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;dI_\nu = -\kappa_\nu \rho I_\nu ds + j_\nu\rho ds&lt;/script&gt;

&lt;p&gt;首先看到等号后面的两项都有一个&lt;script type=&quot;math/tex&quot;&gt;\rho ds&lt;/script&gt;，同时考虑到如果能把第一项变成&lt;script type=&quot;math/tex&quot;&gt;-I_\nu&lt;/script&gt;那么积分之后就是一个负e指数函数，比较方便，所以定义&lt;strong&gt;光深&lt;/strong&gt;&lt;script type=&quot;math/tex&quot;&gt;d\tau_\nu = \kappa_\nu \rho ds&lt;/script&gt;，得&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \frac{dI_\nu}{d\tau_\nu} &amp;= -I_\nu + \frac{j_\nu}{\kappa_\nu} \\  &amp;= -I_\nu + S_\nu \end{align} \tag{7.1} %]]&gt;&lt;/script&gt;

&lt;p&gt;“对吧看着很复杂的东西为什么要去管呢？把它搞成另一个变量就好了嘛！”在这样的思想指导下我们把&lt;script type=&quot;math/tex&quot;&gt;\frac{j_\nu}{\kappa_\nu}&lt;/script&gt;叫做&lt;strong&gt;源函数&lt;/strong&gt;&lt;script type=&quot;math/tex&quot;&gt;S_\nu&lt;/script&gt;。当然实际上源函数还是代表着辐射转移方程发射（光强增加）的那一部分，只是为了凑前面光损部分的简单形式它打了个折扣，衡量得是发射与吸收的比；吸收占比越大，就越靠近负e指数下降。&lt;/p&gt;

&lt;p&gt;看着式&lt;script type=&quot;math/tex&quot;&gt;(7.1)&lt;/script&gt;我们很轻易地用膝盖想到了方程的通解应该有这样的形式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu(\tau_\nu) = fe^{b\tau_\nu} \tag{7.2}&lt;/script&gt;

&lt;p&gt;当然&lt;script type=&quot;math/tex&quot;&gt;f&lt;/script&gt;是个函数。把它丢进&lt;script type=&quot;math/tex&quot;&gt;(7.1)&lt;/script&gt;，得到：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;bI_\nu + e^{b\tau_\nu}\frac{df}{d\tau_\nu} = -I_\nu + S_\nu&lt;/script&gt;

&lt;p&gt;前后一一对应，易得&lt;script type=&quot;math/tex&quot;&gt;b = -1&lt;/script&gt;以及&lt;script type=&quot;math/tex&quot;&gt;f = \int_0^{\tau_\nu} S_\nu e^{t_\nu} dt_\nu + c_0&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} I_\nu(\tau_\nu) &amp;= e^{-\tau_\nu}\int_0^{\tau_\nu} S_\nu e^{t_\nu} dt_\nu + c_0e^{-\tau_\nu} \\ &amp;= e^{-\tau_\nu}\int_0^{\tau_\nu} S_\nu e^{t_\nu} dt_\nu + I_\nu(0)e^{-\tau_\nu} \end{align} \tag{7.3} %]]&gt;&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;0&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;\tau_\nu&lt;/script&gt;取决于从哪开始算以及算到哪。把负e指数丢到积分号里面，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu(\tau_\nu) = \int_0^{\tau_\nu} S_\nu e^{-(\tau_\nu-t_\nu)} dt_\nu + I_\nu(0)e^{-\tau_\nu} \tag{7.4}&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP7/rt1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如上图，这个通解说明辐射传播方向上某一点的光强为起始点的光乘上一个负e指数衰减，加上起始点到观测点之间每一点上发出的光各自乘上负e指数衰减之和；其实挺直白的。到此似乎万事大吉，只要知道源函数表达式加上十来根头发，应该能给出解析解；不想给头发的话让计算机愣算也能给出数值解来。同时回想一下&lt;a href=&quot;https://mingjiejian.github.io/2017/12/18/OASP5/&quot;&gt;第五章&lt;/a&gt;粒子的两种散射情况，我们也能知道最简单的源函数就是平均光强(&lt;script type=&quot;math/tex&quot;&gt;J_\nu&lt;/script&gt;)和黑体辐射函数(&lt;script type=&quot;math/tex&quot;&gt;B_\nu&lt;/script&gt;)。&lt;/p&gt;

&lt;h4 id=&quot;不同形状下的辐射转移方程&quot;&gt;不同形状下的辐射转移方程&lt;/h4&gt;

&lt;p&gt;之前我们只考虑了一条直线上的辐射转移方程。对于星际介质来说这是没问题的，但是恒星是真空中的球形鸡，所以定义沿着恒星半径方向以及视线方向的光深会对解释恒星内部结构以及我们所看到的东西比较方便。用球坐标系,同时因为我们在观测，我们令&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;方向为视线方向，所以：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dI_\nu}{\kappa_\nu \rho dz} = -I_\nu + \frac{j_\nu}{\kappa_\nu}&lt;/script&gt;

&lt;p&gt;将&lt;script type=&quot;math/tex&quot;&gt;z&lt;/script&gt;换成球坐标的&lt;script type=&quot;math/tex&quot;&gt;r, \theta&lt;/script&gt;：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dI}{dz} = \frac{dI}{dr}\frac{dr}{dz} + \frac{dI}{d\theta}\frac{d\theta}{dz} \tag{7.5}&lt;/script&gt;

&lt;p&gt;什么你问&lt;script type=&quot;math/tex&quot;&gt;\phi&lt;/script&gt;哪去了？当然是认为&lt;script type=&quot;math/tex&quot;&gt;\phi&lt;/script&gt;方向光强处处一样啦，简单嘛。从图中可得：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;dr = \cos{\theta} dz&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;rd\theta = -\sin{\theta} dz&lt;/script&gt;

&lt;p&gt;所以，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\partial I_\nu}{\partial r} \frac{\cos{\theta}}{\kappa_\nu\rho} - \frac{\partial I_\nu}{\partial \theta} \frac{\sin{\theta}}{\kappa_\nu\rho r} = -I_\nu + S_\nu \tag{7.6}&lt;/script&gt;

&lt;p&gt;对于恒星内部或者大气很厚的恒星（超巨星）来说这就是要解的方程；但是一般的恒星光球层非常薄，所以可以认为光强跟&lt;script type=&quot;math/tex&quot;&gt;\theta&lt;/script&gt;也没有关系（高兴），得出：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{d I_\nu}{d r} \frac{\cos{\theta}}{\kappa_\nu\rho} = -I_\nu + S_\nu&lt;/script&gt;

&lt;p&gt;虽然不知道为什么，但是在这里我们可以定义一个和&lt;script type=&quot;math/tex&quot;&gt;dr&lt;/script&gt;反向的量&lt;script type=&quot;math/tex&quot;&gt;dx = -dr&lt;/script&gt;以及&lt;script type=&quot;math/tex&quot;&gt;d\tau'_\nu = \kappa_\nu\rho dr&lt;/script&gt;，使得这个方程的解为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu(\tau_\nu) = \int_c^{\tau_\nu} S_\nu e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} d\tau'_\nu \tag{7.8}&lt;/script&gt;

&lt;p&gt;就是在&lt;script type=&quot;math/tex&quot;&gt;t_\nu, \tau_\nu&lt;/script&gt;后面加了个&lt;script type=&quot;math/tex&quot;&gt;-\sec{\theta}&lt;/script&gt;同时把常数放进了积分下限而已。这里把原来式子的&lt;script type=&quot;math/tex&quot;&gt;I_\nu(0)e^{-\tau_\nu}&lt;/script&gt;放到了积分号的下限里面是因为之前只有视线方向一个方向，但是现在有了恒星的径向（以及反径向）和视线方向，就有一个夹角的问题：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP7/rt2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;当&lt;script type=&quot;math/tex&quot;&gt;\theta &gt; 90^\circ&lt;/script&gt;的时候是从外往里的方向，反之是从里往外。对于式子&lt;script type=&quot;math/tex&quot;&gt;(7.4)&lt;/script&gt;来说不同的方向只是换一个起始点和矢量而已，但是现在对于恒星光球层内部和外部来说有不同（而且可以确定）的边界条件，所以视线方向向内和向外的光强分别为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} I_\nu^\mathrm{out} &amp;= \int_{\tau_\nu}^\infty S_\nu e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} dt_\nu \\ I_\nu^\mathrm{in} &amp;= -\int_0^{\tau_\nu} S_\nu e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} dt_\nu \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;也就是说方向向外时从光球层最底层开始算，光深为&lt;script type=&quot;math/tex&quot;&gt;\infty&lt;/script&gt;，向内时从恒星表面开始算，光深为&lt;script type=&quot;math/tex&quot;&gt;0&lt;/script&gt;。视线方向上某一点的“总光强”为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} I_\nu(\tau_\nu) &amp;= I_\nu^\mathrm{out} + I_\nu^\mathrm{in} \\ &amp;= \int_{\tau_\nu}^\infty S_\nu e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} dt_\nu -\int_0^{\tau_\nu} S_\nu e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} dt_\nu \end{align} \tag{7.9} %]]&gt;&lt;/script&gt;

&lt;p&gt;所以在观测从恒星表面出射的辐射的时候用的是&lt;script type=&quot;math/tex&quot;&gt;I_\nu^\mathrm{out}(0)&lt;/script&gt;：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu^\mathrm{out}(0) = \int_{0}^\infty S_\nu e^{-t_\nu\sec{\theta}}\sec{\theta} dt_\nu \tag{7.10}&lt;/script&gt;

&lt;p&gt;这条式子会在计算合成光谱的时候用到。&lt;/p&gt;

&lt;h4 id=&quot;光强积分&quot;&gt;光强积分&lt;/h4&gt;

&lt;p&gt;就像&lt;a href=&quot;https://mingjiejian.github.io/2017/12/18/OASP5/&quot;&gt;第五章&lt;/a&gt;说的那样，实际上我们不能分辨出恒星的源面，所以当然要将光强积分成流量了。利用式&lt;script type=&quot;math/tex&quot;&gt;(5.5)&lt;/script&gt;并且认为&lt;script type=&quot;math/tex&quot;&gt;I_\nu&lt;/script&gt;与&lt;script type=&quot;math/tex&quot;&gt;\phi&lt;/script&gt;方向无关，我们得到：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} F_\nu &amp;= 2\pi \int_0^\pi I_\nu \cos{\theta} \sin{\theta} d\theta \\ &amp;= 2\pi \int_0^{\pi/2} I_\nu^\mathrm{out} \cos{\theta} \sin{\theta} d\theta + 2\pi \int_{\pi/2}^\pi I_\nu^\mathrm{in} \cos{\theta} \sin{\theta} d\theta \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;将式&lt;script type=&quot;math/tex&quot;&gt;(7.9)&lt;/script&gt;代入，得：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu = 2\pi \int_0^{\pi/2}\int_{\tau_\nu}^\infty S_\nu e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} dt_\nu d\theta - 2\pi \int_{\pi/2}^\pi\int_0^{\tau_\nu} S_\nu e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} dt_\nu d\theta&lt;/script&gt;

&lt;p&gt;假设源函数各向同性，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu = 2\pi \int_{\tau_\nu}^\infty S_\nu \int_0^{\pi/2} e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} d\theta dt_\nu - 2\pi \int_0^{\tau_\nu} S_\nu \int_{\pi/2}^\pi e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} d\theta dt_\nu \tag{7.11}&lt;/script&gt;

&lt;p&gt;所以之后就看中间的那个&lt;script type=&quot;math/tex&quot;&gt;e&lt;/script&gt;指数积分了。先直接给结论：令&lt;script type=&quot;math/tex&quot;&gt;w = \sec{\theta}, x = t_\nu - \tau_\nu&lt;/script&gt;，则有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^{\pi/2} e^{-(t_\nu-\tau_\nu)\sec{\theta}}\sec{\theta} d\theta = \int_1^\infty \frac{e^{-xw}}{w^2} dw \tag{7.12}&lt;/script&gt;

&lt;p&gt;为了方便起见将后面的&lt;script type=&quot;math/tex&quot;&gt;e&lt;/script&gt;指数积分叫做&lt;script type=&quot;math/tex&quot;&gt;E_n&lt;/script&gt;:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;E_n(x) = \int_1^\infty \frac{e^{-xw}}{w^n} dw \tag{7.13}&lt;/script&gt;

&lt;p&gt;所以刚刚的流量就是：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu(\tau_\nu) = 2\pi \int_{\tau_\nu}^\infty S_\nu E_2(t_\nu - \tau_\nu) dt_\nu - 2\pi \int_0^{\tau_\nu} S_\nu E_2(\tau_\nu - t_\nu) dt_\nu \tag{7.14}&lt;/script&gt;

&lt;p&gt;照例在恒星表面变成&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu(0) = 2\pi \int_{0}^\infty S_\nu(t_\nu) E_2(t_\nu) dt_\nu \tag{7.15}&lt;/script&gt;

&lt;p&gt;举一反三得K积分里面的量&lt;script type=&quot;math/tex&quot;&gt;J_\nu, K_\nu&lt;/script&gt;可以表示为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} J_\nu(\tau_\nu) &amp;= \frac{1}{2} \int_{\tau_\nu}^\infty S_\nu E_1(t_\nu - \tau_\nu) dt_\nu + \frac{1}{2} \int_0^{\tau_\nu} S_\nu E_1(\tau_\nu - t_\nu) dt_\nu \\ K_\nu(\tau_\nu) &amp;= \frac{1}{2} \int_{\tau_\nu}^\infty S_\nu E_3(t_\nu - \tau_\nu) dt_\nu + \frac{1}{2} \int_0^{\tau_\nu} S_\nu E_3(\tau_\nu - t_\nu) dt_\nu \end{align} \tag{7.16} %]]&gt;&lt;/script&gt;

&lt;h4 id=&quot;e指数积分的性质&quot;&gt;e指数积分的性质&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;E_n(0) = \int_1^\infty \frac{1}{w^n} dw = \frac{1}{n-1}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dE_n}{dx} = -E_{n-1} \tag{7.19}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;nE_{n+1}(x) = e^{-x} - xE_n(x) \tag{7.20}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;E_n(x) \approx \frac{1}{xe^x}&lt;/script&gt;

&lt;p&gt;大概就是这样。&lt;/p&gt;

&lt;h3 id=&quot;辐射平衡&quot;&gt;辐射平衡&lt;/h3&gt;

&lt;p&gt;实际上辐射平衡指的就是能量守恒。我们认为光球层是不产生能量的，所以光球层处处都不能有源或者汇，吃进去多少就得吐出来多少。我们仍然处于平面平行层的假设之中，所以散度为0的条件可以表述为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{d}{dx}F(x) = 0, F(x) = F_0 \tag{7.21}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;指的是光球层中的某一点。如果所有能量都是辐射的话，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x) = \int_0^\infty F(\tau_\nu) d\nu = F_0 \tag{7.22}&lt;/script&gt;

&lt;p&gt;这就是辐射平衡条件。如果也有对流的话，则变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Phi(x) + \int_0^\infty F(\tau_\nu) d\nu = F_0 \tag{7.23}&lt;/script&gt;

&lt;p&gt;还有其他能量源的话，加上去就好了。&lt;/p&gt;

&lt;p&gt;先不管对流，将&lt;script type=&quot;math/tex&quot;&gt;(7.14)&lt;/script&gt;代入&lt;script type=&quot;math/tex&quot;&gt;(7.22)&lt;/script&gt;，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty [\int_{\tau_\nu}^\infty S_\nu E_2(t_\nu - \tau_\nu) dt_\nu - 2\pi \int_0^{\tau_\nu} S_\nu E_2(\tau_\nu - t_\nu) dt_\nu] d_\nu = \frac{F_0}{2\pi} \tag{7.24}&lt;/script&gt;

&lt;p&gt;这叫做Milne第二公式，其他两条Milne公式之后会讨论到。这条公式里面唯一的未知量是&lt;script type=&quot;math/tex&quot;&gt;S_\nu(\tau_\nu)&lt;/script&gt;，也就是说在辐射平衡条件下，符合这条式子的源函数就是我们要找的源函数；把它丢回&lt;script type=&quot;math/tex&quot;&gt;(7.14)&lt;/script&gt;就可以将流量算出来了。&lt;/p&gt;

&lt;p&gt;另外两个Milne公式可以从辐射转移方程推出来：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\cos{\theta} \frac{dI_\nu}{dx} = \kappa_\nu\rho I_\nu - \kappa_\nu\rho S_\nu \tag{7.25}&lt;/script&gt;

&lt;p&gt;对立体角积分并且认为&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu, S_\nu&lt;/script&gt;与方向无关，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{dF(x)}{dx} = 4\pi\kappa_\nu\rho J_\nu - 4\pi\kappa_\nu \rho S_\nu \tag{7.26}&lt;/script&gt;

&lt;p&gt;对所有频率积分，并考虑到辐射平衡条件&lt;script type=&quot;math/tex&quot;&gt;(7.21)&lt;/script&gt;，左边等于0，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty \kappa_\nu\rho J_\nu d\nu = \int_0^\infty \kappa_\nu\rho S_\nu d\nu \tag{7.28}&lt;/script&gt;

&lt;p&gt;用&lt;script type=&quot;math/tex&quot;&gt;(7.16)&lt;/script&gt;的&lt;script type=&quot;math/tex&quot;&gt;J_\nu&lt;/script&gt;代入，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty \kappa_\nu [\frac{1}{2} \int_{\tau_\nu}^\infty S_\nu E_1(t_\nu - \tau_\nu) dt_\nu + \frac{1}{2} \int_0^{\tau_\nu} S_\nu E_1(\tau_\nu - t_\nu) dt_\nu - S_\nu] d\nu = 0&lt;/script&gt;

&lt;p&gt;这也是一条Milne公式（书上没写是第几条…），也是给求&lt;script type=&quot;math/tex&quot;&gt;S_\nu&lt;/script&gt;用的。如果在恒星内部，所有频率上的光深都很大的话，&lt;script type=&quot;math/tex&quot;&gt;\frac{dF(x)}{dx}&lt;/script&gt;就大概为0，所以从&lt;script type=&quot;math/tex&quot;&gt;(7.26)&lt;/script&gt;我们可以认为&lt;script type=&quot;math/tex&quot;&gt;J_\nu = S_\nu&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;最后一条Milne公式是从&lt;script type=&quot;math/tex&quot;&gt;(7.25)&lt;/script&gt;乘上一个&lt;script type=&quot;math/tex&quot;&gt;\cos{\theta}&lt;/script&gt;来的。乘上之后对方位角和频率积分，最后一项就没了，剩下的是：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty \frac{dK_\nu}{d\tau_\nu} = \frac{F_0}{4\pi}&lt;/script&gt;

&lt;p&gt;同样将&lt;script type=&quot;math/tex&quot;&gt;K_\nu&lt;/script&gt;代入，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\int_0^\infty \frac{d}{d\tau_\nu} [\frac{1}{2} \int_{\tau_\nu}^\infty S_\nu E_3(t_\nu - \tau_\nu) dt_\nu + \frac{1}{2} \int_0^{\tau_\nu} S_\nu E_3(\tau_\nu - t_\nu) dt_\nu - S_\nu] d\nu = \frac{F_0}{4\pi}&lt;/script&gt;

&lt;p&gt;实际上这三条Milne公式都是从光强加上辐射平衡条件来的，所以它们并不独立，满足某一条公式的源函数必定满足其他两条。回到遥远的第一章，我们可以看到现在代表着有效温度决定着&lt;script type=&quot;math/tex&quot;&gt;F_0&lt;/script&gt;，所以有效温度实际上是模型的一个重要参数。&lt;/p&gt;

&lt;p&gt;现在既然所有的公式都齐了，剩下的就是确定源函数。这里只讨论一种最简单的情况，灰大气。更复杂的情况留给论文去说。&lt;/p&gt;

&lt;h3 id=&quot;灰大气模型&quot;&gt;灰大气模型&lt;/h3&gt;

&lt;p&gt;灰大气模型确定的源函数值得在这里讨论并不仅仅是因为它是比较早得出的解，还因为它是很多其他源函数迭代的初始函数。灰大气指的是&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;与频率无关，当然它不怎么真实(by Quin)。&lt;/p&gt;

&lt;p&gt;从&lt;script type=&quot;math/tex&quot;&gt;(7.7)&lt;/script&gt;开始，将式子对全频率积分，并将积分后的结果写成不带&lt;script type=&quot;math/tex&quot;&gt;\nu&lt;/script&gt;角标的量，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\cos{\theta} \frac{dI}{d\tau} = I - S&lt;/script&gt;

&lt;p&gt;可以“简单地”理解为把角标拿掉；那么式&lt;script type=&quot;math/tex&quot;&gt;(7.22), (7.28), (7.30)&lt;/script&gt;变成：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} F &amp;= F_0 \\ J &amp;= S \\ \frac{dK}{d\tau} &amp;= \frac{F_0}{4\pi} \end{align} \tag{7.32} %]]&gt;&lt;/script&gt;

&lt;p&gt;在这里爱丁顿老爷子假设入射和出射的光强和方向无关，都是一样的，也就是：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
I(\tau) = \begin{cases} I^\mathrm{out}(\tau) &amp; 0 \le \theta \le \pi/2 \\ I^\mathrm{in}(\tau) &amp; \pi/2 \le \theta \le \pi \end{cases} %]]&gt;&lt;/script&gt;

&lt;p&gt;然后三个K积分就变成了&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} F(\tau) &amp;= \pi[I^\mathrm{out}-I^\mathrm{in}] \\ J(\tau) &amp;= \frac{1}{2}[I^\mathrm{out} + I^\mathrm{in}] \\ K(\tau) &amp;= \frac{1}{6} [I^\mathrm{out} + I^\mathrm{in}] \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;不信？不信自己代进定义里面算去。把它们丢进&lt;script type=&quot;math/tex&quot;&gt;(7.32)&lt;/script&gt;里面，该相等的相等，该积分的积分，得到&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S(\tau) = J(\tau) = 3K(\tau)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;K(\tau) = \frac{F_0}{4\pi}\tau + \frac{F_0}{6\pi}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Rightarrow S(\tau) = \frac{3F_0}{4\pi}(\tau+\frac{2}{3})&lt;/script&gt;

&lt;p&gt;热动平衡之下我们还有黑体辐射定律；利用&lt;script type=&quot;math/tex&quot;&gt;(6.4)&lt;/script&gt;，我们可以得出&lt;script type=&quot;math/tex&quot;&gt;S(\tau) = J(\tau) = \sigma/\pi T^4(\tau),&lt;/script&gt;&lt;script type=&quot;math/tex&quot;&gt;F_0 = \sigma T_\mathrm{eff}^4&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;T(\tau) = [\frac{3}{4}(\tau+\frac{2}{3})]^{1/4} T_\mathrm{eff} \tag{7.36}&lt;/script&gt;

&lt;p&gt;这样一来每层的温度由有效温度和光深决定，也可以知道了。如果把老爷子的假设去掉，解会从&lt;script type=&quot;math/tex&quot;&gt;\frac{2}{3} \rightarrow q(\tau)&lt;/script&gt;，稍微复杂一点。当然灰大气和实际情况差得比较远，因为大大简化了&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;的情况。&lt;/p&gt;

&lt;h3 id=&quot;对流传能&quot;&gt;对流传能&lt;/h3&gt;

&lt;p&gt;这一章快该结束了。中高温恒星的对流层比较深，但是低温恒星的对流层可以延伸到光球层的底部，所以需要考虑对流传能。对流元需要和环境温度有差别（要不然哪有能量传输），而且光深需要比较大（要不然被辐射传能搞没了）。一个对流元所携带的能量为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Phi = \rho C_p v \Delta T&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\rho, C_p, v, \Delta T&lt;/script&gt;分别为密度、比热、速度、温度差。这些对流元可上可下、可冷可热。太阳的米粒（儿）组织就是我们可以看到的对流层的顶部，同时对流层传输的能量是辐射传能的&lt;script type=&quot;math/tex&quot;&gt;\sim 10^{-3}&lt;/script&gt;倍，可以忽略掉。但是因为对流带来的速度不均匀会对光球层产生影响（对流超射），使得谱线形状发生变化，带来不对称性，所以可以用这种不对称性来研究恒星的米粒组织（第十七章）。然后对流还会产生一些声学波，将恒星内部的元素带到恒星表面。对流传能虽然能量小，但是速度比辐射传能快，周/月的量级vs&lt;script type=&quot;math/tex&quot;&gt;\sim 10^5&lt;/script&gt;年。&lt;/p&gt;

&lt;h4 id=&quot;对流传能条件&quot;&gt;对流传能条件&lt;/h4&gt;

&lt;p&gt;一团气体能上升主要是因为它的密度比环境要小；但是气体在上升的过程中会膨胀，所以它的密度并不是不变的。当气体密度的导数比环境密度的导数小的时候，气体就可以上升（假设对流元是绝热的）：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;(\frac{d\log{\rho}}{d\log{P}})_\mathrm{cell} &gt; (\frac{d\log{\rho}}{d\log{P}})_\mathrm{average}&lt;/script&gt;

&lt;p&gt;我们比较喜欢用温度来说事，利用理想气体公式&lt;script type=&quot;math/tex&quot;&gt;P = (\rho/\mu)kT&lt;/script&gt;：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;(\frac{d\log{\rho}}{d\log{P}})_\mathrm{average} = 1 + \frac{d\log{\mu}}{d\log{P}} - \frac{d\log{T}}{d\log{P}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Rightarrow (\frac{d\log{T}}{d\log{P}})_\mathrm{average} &gt; 1 - (\frac{d\log{\rho}}{d\log{P}})_\mathrm{cell} + \frac{d\log{\mu}}{d\log{P}}&lt;/script&gt;

&lt;p&gt;所以想有对流，一是增大左边，也就是温度梯度；温度梯度很大的时候恒星甚至会膨胀或者收缩。二是右边很小，也就是&lt;script type=&quot;math/tex&quot;&gt;(\frac{d\log{\rho}}{d\log{P}})_\mathrm{cell}&lt;/script&gt;比较大。这说明当恒星温度比较低，质量比较大的分子可以存在的时候对流比较容易产生；另一种增大它的方法是在对流元内部有辐射。&lt;/p&gt;

&lt;h4 id=&quot;混合长&quot;&gt;混合长&lt;/h4&gt;

&lt;p&gt;解决了对流发生的条件之后我们来看看对流传能的最后两项。从能量守恒有&lt;script type=&quot;math/tex&quot;&gt;\frac{1}{2}\rho v^2 = g\Delta\rho l&lt;/script&gt;，其中&lt;script type=&quot;math/tex&quot;&gt;l&lt;/script&gt;是对流元存活的长度，也就是混合长。压强平衡要求&lt;script type=&quot;math/tex&quot;&gt;\Delta \rho / \rho = \Delta T / T&lt;/script&gt;，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \Phi &amp;= \rho C_p (\frac{gl}{T})^{1/2} \Delta T^{3/2} \\ &amp;= \rho C_p (\frac{gl}{T})^{1/2} [(\frac{dT}{dx})_\mathrm{cell} - (\frac{dT}{dx})_\mathrm{average}]^{3/2} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;混合长的具体数值是任意，没有理论支撑的；它在恒星内部有一些经验取值，但是光球层上没有。&lt;/p&gt;

&lt;p&gt;恒星的对流比较复杂，一些更准确的计算需要看相关论文。&lt;/p&gt;
</description>
        <pubDate>Wed, 27 Dec 2017 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2017/12/27/OASP7/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/27/OASP7/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 6</title>
        <description>&lt;p&gt;无聊的一章。请自行谷歌黑体辐射。&lt;/p&gt;

&lt;h3 id=&quot;可公开的信息&quot;&gt;可公开的信息&lt;/h3&gt;

&lt;p&gt;韦恩定律（高频）：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu = \nu^3f(\nu/T) \tag{6.1}&lt;/script&gt;

&lt;p&gt;瑞利金斯近似（低频/长波）：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu = \frac{2kT\nu^2}{c^2} = \frac{2kT}{\lambda^2} \tag{6.6}&lt;/script&gt;

&lt;h3 id=&quot;推导&quot;&gt;“推导”&lt;/h3&gt;

&lt;p&gt;前提：只有两个能级 + 处于热动平衡&lt;/p&gt;

&lt;p&gt;第一章的原子激发与电离里面有这样的一个公式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{N_n}{N_m} = \frac{g_n}{g_m} e^{-\frac{h\nu}{kT}}&lt;/script&gt;

&lt;p&gt;从第五章最后的两个公式得出细致平衡原理：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;N_u A_{ul} + N_u B_{ul} I_\nu = N_l B_{lu} I_\nu&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu = \frac{A_{ul}}{B_{lu}(N_l/N_u) - B_{ul}}&lt;/script&gt;

&lt;p&gt;合在一起就有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu = \frac{A_{ul}}{(g_l/g_u)B_{lu}e^{-\frac{h\nu}{kT}} - B_{ul}}&lt;/script&gt;

&lt;p&gt;将&lt;script type=&quot;math/tex&quot;&gt;e&lt;/script&gt;指数展开&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu \approx \frac{A_{ul}}{(g_l/g_u)B_{lu} + (g_l/g_u)B_{lu}\frac{h\nu}{kT} - B_{ul}}&lt;/script&gt;

&lt;p&gt;令它等于瑞利金斯近似，得&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;B_{ul} = B_{lu}g_l/g_u, A_{ul} = \frac{2h\nu^3}{c^2}B_{ul}&lt;/script&gt;

&lt;p&gt;所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu = B_\nu = \frac{2h\nu^3}{c^2} \frac{1}{e^{-\frac{h\nu}{kT}}-1}&lt;/script&gt;

&lt;p&gt;求导等于0可以得出韦恩位移定律，对频率积分可以得出斯特芬玻尔兹曼定律：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\lambda T = b, F_\nu = \oint I_\nu \cos{\theta} d\omega = \sigma T^4&lt;/script&gt;

&lt;p&gt;之前有一个疑惑就是物质的发射或者吸收是怎么从稀薄的谱线到一大块的黑体谱的，&lt;a href=&quot;https://physics.stackexchange.com/questions/105875/blackbody-radiation-and-spectral-lines&quot;&gt;这里&lt;/a&gt;有一个思路。&lt;/p&gt;

&lt;p&gt;再联络。&lt;/p&gt;
</description>
        <pubDate>Tue, 19 Dec 2017 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2017/12/19/OASP6/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/19/OASP6/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 5</title>
        <description>&lt;h3 id=&quot;辐射强度-specific-intensity&quot;&gt;辐射强度 (specific intensity)&lt;/h3&gt;

&lt;p&gt;辐射强度描述的是穿过一个表面的光的强度分布，是辐射场的性质，跟接下来用到的面元的性质无关。这个量当然需要是在单位时间、单位频率下的；同时这个表面处在不同位置也会不一样，所以要将表面缩小成面元。我们先将面元固定在一个点上，看如何描述光的强度分布。&lt;/p&gt;

&lt;p&gt;我们只能通过单位时间、单位频率下穿过单位面积面元的能量大小来描述光的强度。但是面元是有朝向的，一个只朝一个方向的辐射场和面元的法向量平行的时候会产生最大的通量；如果将辐射场（或者面元）旋转一个角度，除了方向外辐射场没有任何其他的变化，不过通量就小了。然而辐射强度是辐射场的性质，和面元的方向无关，所以除了&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}A\mathrm{d}t\mathrm{d}\nu&lt;/script&gt;需要和描述辐射场强度（其实就是辐射强度）的量相乘之外，我们还需要一个表示方向的立体角源和表示方向与面元法向夹角的余弦值将（可能倾斜的）面元“摆正”，去导出正确的能量。所以能量和辐射强度有这样的关系：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{d}E_\nu = I_\nu cos{\theta} \mathrm{d}\omega\mathrm{d}A\mathrm{d}t\mathrm{d}\nu&lt;/script&gt;

&lt;p&gt;也得到了辐射强度的表达式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu = \frac{\mathrm{d}E_\nu}{cos{\theta}\mathrm{d}\omega\mathrm{d}A\mathrm{d}t\mathrm{d}\nu} \tag{5.1}&lt;/script&gt;

&lt;p&gt;它表达的是单位时间(&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}t&lt;/script&gt;)单位频率(&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}\nu&lt;/script&gt;)下穿过某一点(&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}A&lt;/script&gt;)朝某个方向(&lt;script type=&quot;math/tex&quot;&gt;cos{\theta}\mathrm{d}\omega&lt;/script&gt;)的光的能量。当然我们也可以用波长去表达，而从上式我们可以推出&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I_\nu\mathrm{d}\nu = I_\lambda\mathrm{d}\lambda  \tag{5.2}&lt;/script&gt;

&lt;p&gt;它们的单位分别是&lt;script type=&quot;math/tex&quot;&gt;\mathrm{erg / (s~cm^2~rad^2~Hz)}, \mathrm{W / (m^2~rad^2~Hz)}&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;\mathrm{erg / (s~cm^2~rad^2~Å)}, \mathrm{W / (m^2~rad^2~Å)}&lt;/script&gt;。这条式子，加上熟悉的频率-波长关系&lt;script type=&quot;math/tex&quot;&gt;\lambda\nu = c&lt;/script&gt;，我们会发现同一个物体&lt;script type=&quot;math/tex&quot;&gt;I_\nu&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;I_\lambda&lt;/script&gt;的形状是不一样的。这是因为&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}\nu = -\frac{c}{\lambda^2}\mathrm{d}\lambda \Rightarrow -\frac{c}{\lambda^2}I_\nu = I_\lambda&lt;/script&gt;（负号表示波长和频率变化方向相反），所以即使不同波长下的辐射强度一样，翻译到频率下会变成一条曲线。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://soap.siteturbine.com/uploaded_files/www.oceanopticsbook.info/images/WebBook/2048a65071bc4c0a0e2402ba5bc51157.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;频域和波长域下太阳的辐射强度，可以看到形状改变了。取自&lt;a href=&quot;http://www.oceanopticsbook.info/view/light_and_radiometry/level_2/a_common_misconception&quot;&gt;这里&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;我们也可以定义平均辐射强度，为辐射强度在所有方向上的平均：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;J_\nu = \frac{1}{4\pi} \oint I_\nu \mathrm{d}\omega  \tag{5.3}&lt;/script&gt;

&lt;h3 id=&quot;流量&quot;&gt;流量&lt;/h3&gt;

&lt;p&gt;比起辐射强度，流量可能更容易理解一点。流量就是通过一个面的所有能量之和；一个方向为正的话，另一个方向就为负；或者说流量就是一个面对所有方向辐射强度的积分。从这两个表述里面我们可以得到流量的两个定义式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu = \frac{\oint \mathrm{d}E_\nu}{\mathrm{d}A\mathrm{d}t\mathrm{d}\nu} = \oint I_\nu \cos{\theta} \mathrm{d}\omega  \tag{5.4}&lt;/script&gt;

&lt;p&gt;显然当辐射场各向同性的时候，流量为零（进出一样）；所以也可以说流量是衡量辐射场非各向同性程度的一个量。&lt;/p&gt;

&lt;p&gt;假设我们讨论的点在恒星的表面上，将流量的辐射强度积分拆成两个半球，一个在恒星内部，一个在外部，我们可以得到&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} F_\nu &amp; = \int_0^{2\pi}\mathrm{d}\phi\int_0^\pi I_\nu\sin{\theta}\cos{\theta}\mathrm{d}\theta \\ &amp; = \int_0^{2\pi}\mathrm{d}\phi (\int_0^\frac{2}{\pi} I_\nu\sin{\theta}\cos{\theta}\mathrm{d}\theta + \int_\frac{2}{\pi}^\pi I_\nu\sin{\theta}\cos{\theta}\mathrm{d}\theta) \\ &amp; = F_\nu^\mathrm{out} + F_\nu^\mathrm{in} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;实际上就是向里的和向外的之和。对于恒星来说，一般是没有向内的辐射的；同时如果在&lt;script type=&quot;math/tex&quot;&gt;\phi&lt;/script&gt;方向各向同性的话，上式可以简化为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu  = 2\pi\int_0^\frac{2}{\pi} I_\nu\sin{\theta}\cos{\theta}\mathrm{d}\theta  \tag{5.6}&lt;/script&gt;

&lt;p&gt;再简化一下，如果向外的辐射在各个&lt;script type=&quot;math/tex&quot;&gt;\theta&lt;/script&gt;方向都相等的话，那么&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F_\nu = \pi I_\nu  \tag{5.7}&lt;/script&gt;

&lt;p&gt;对恒星来说这样的简化是可以接受的。&lt;/p&gt;

&lt;p&gt;辐射强度是一个辐射场的内禀量，所以不应该随着距离而变化；而流量遵循平方反比律。这里的不同之处在于辐射强度的定义式中有一个&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}\omega&lt;/script&gt;，但流量里面没有。这也说明了只有当我们明确知道观测的源的&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}\omega&lt;/script&gt;有多大，也就是能分辨清楚源面的时候，我们才能测量辐射强度；否则我们测量的只能是流量。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP5/if.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;图中左侧是天空中的一个均匀的延展源，右侧是它的像。假设我们现在讨论通过中间透镜的辐射强度和流量，而&lt;script type=&quot;math/tex&quot;&gt;A_S&lt;/script&gt;所张的立体角刚好可以看作一个面元。这那么根据定义，包含在&lt;script type=&quot;math/tex&quot;&gt;A_S&lt;/script&gt;这个圆锥中的能量就是在透镜这一点上、&lt;script type=&quot;math/tex&quot;&gt;A_S&lt;/script&gt;方向的辐射强度。如果我们改变这个源的距离，因为这个圆锥（立体角大小）不变，虽然源距离我们远了，每个点发出的光少了，但是有更多的面积进入了&lt;script type=&quot;math/tex&quot;&gt;A_S&lt;/script&gt;中，所以接收到的能量是不变的。当整个源的面积小于等于&lt;script type=&quot;math/tex&quot;&gt;A_S&lt;/script&gt;的时候，我们就不能分辨源的面了，所以此时测量到的就变成了流量，遵循平方反比定律。&lt;/p&gt;

&lt;h3 id=&quot;k积分&quot;&gt;K积分&lt;/h3&gt;

&lt;p&gt;到现在为止我们从辐射强度中引出了两个值，平均辐射强度和流量：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} J_\nu &amp; = \frac{1}{4\pi} \oint I_\nu \mathrm{d}\omega \\ F_\nu &amp; = \oint I_\nu \cos{\theta} \mathrm{d}\omega \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;如果在积分号里面再加一个&lt;script type=&quot;math/tex&quot;&gt;\cos{\theta}&lt;/script&gt;，也可以定义出一个有物理意义的量：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;K_\nu = \frac{1}{4\pi} \oint I_\nu \cos^2{\theta} \mathrm{d}\omega  \tag{5.8}&lt;/script&gt;

&lt;p&gt;它跟辐射压有关。&lt;/p&gt;

&lt;p&gt;光子的动量为&lt;script type=&quot;math/tex&quot;&gt;P = \frac{E}{c}&lt;/script&gt;，则单位时间单位面积内穿过某个面的总动量就是辐射压：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{d}P_\nu = \frac{\mathrm{d}E_\nu}{c} \frac{\cos{\theta}}{\mathrm{d}t\mathrm{d}A}&lt;/script&gt;

&lt;p&gt;用辐射强度代入，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{d}P_\nu = \frac{I_\nu}{c} \cos^2{\theta} \mathrm{d}\nu\mathrm{d}\omega&lt;/script&gt;

&lt;p&gt;对立体角和频率积分一下，就有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P_R = \frac{1}{c} \int_0^\infty\oint I_\nu \cos^2{\theta} \mathrm{d}\omega\mathrm{d}\nu = \frac{4\pi}{c} \int_0^\infty K_\nu \mathrm{d}\nu  \tag{5.9}&lt;/script&gt;

&lt;p&gt;如果各向同性的话，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P_R = \frac{4\pi}{3c} \int_0^\infty I_\nu \mathrm{d}\nu \tag{5.10}&lt;/script&gt;

&lt;p&gt;而第六章会讨论温度的一个定义方式：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\pi\int_0^\infty I_\nu \mathrm{d}\nu = \sigma T^4&lt;/script&gt;

&lt;p&gt;故有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P_R = \frac{4\sigma}{3c}T^4 \tag{5.11}&lt;/script&gt;

&lt;p&gt;所以高温恒星的辐射压是很强的；同时太阳等低温恒星辐射压可以被忽略。&lt;/p&gt;

&lt;h3 id=&quot;辐射能量密度&quot;&gt;辐射能量密度&lt;/h3&gt;

&lt;p&gt;在继续之前我们稍微再从不同的角度理解一下辐射强度。辐射强度可以被理解为单位时间单位频率内往某个方向的能量对某个面元的平均，也就是这个“摆正了的”面元单位时间单位频率内的单位面积上有多少正前方的能量穿过。所以辐射强度某种程度上来说是辐射能量面密度。&lt;/p&gt;

&lt;p&gt;那么有了面密度，能不能有体密度呢？当然是可以的，我们仿照辐射强度把&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}A&lt;/script&gt;写成&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}V&lt;/script&gt;就行了（记得带上&lt;script type=&quot;math/tex&quot;&gt;\cos{\theta}&lt;/script&gt;）。但是注意到我们在讨论光，光肯定以光速运动，所以面元在空间中相对光扫过的体积和面积的关系为&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}V = c\mathrm{d}A&lt;/script&gt;，也就是说&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;u_\nu = \frac{I_\nu}{c}&lt;/script&gt;

&lt;p&gt;体积的数值肯定比面积大，所以同样的光分摊到了一个更大的数字上，密度就小了。&lt;/p&gt;

&lt;h3 id=&quot;吸收系数和光深&quot;&gt;吸收系数和光深&lt;/h3&gt;

&lt;p&gt;光穿过介质时候的衰减遵循以下规律：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{d}I_\nu = -\kappa_\nu\rho I_\nu \mathrm{d}x \tag{5.12}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\rho&lt;/script&gt;是单位体积的质量密度，&lt;script type=&quot;math/tex&quot;&gt;\mathrm{d}x&lt;/script&gt;是长度，所以&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;是单位质量上的面积(&lt;script type=&quot;math/tex&quot;&gt;\mathrm{\frac{cm^2}{g}}&lt;/script&gt;)，也就是吸收截面。&lt;/p&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;反映的是物质本身的性质；实际上这个值有两个方面，一个是真正的吸收，另一个是物质对光的散射。所以这个吸收系数实际上是消光系数。&lt;/p&gt;

&lt;p&gt;在没有介质发射的情况下我们可以装作化简地把式子写得简单一点，利用&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \tau_\nu &amp; = \int_0^L \kappa_\nu \rho \mathrm{d}x \Rightarrow \\ \mathrm{d}I_\nu &amp; = -I_\nu\mathrm{d}\tau_\nu \Rightarrow \\ I_\nu &amp; = I_\nu^0 \exp{-\tau_\nu} \end{align} \tag{5.13} %]]&gt;&lt;/script&gt;

&lt;p&gt;这是最简单的消光规律。&lt;/p&gt;

&lt;h3 id=&quot;发射系数和源函数&quot;&gt;发射系数和源函数&lt;/h3&gt;

&lt;p&gt;对发射系数的定义和吸收系数非常类似，只是没有了负号：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{d}I_\nu = j_\nu \rho \mathrm{d}x \tag{5.14}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;j_\nu&lt;/script&gt;的单位是&lt;script type=&quot;math/tex&quot;&gt;\mathrm{\frac{erg}{s~rad^2~Hz~g}}&lt;/script&gt;。发射系数同样包含真正的发射和散射到我们考虑的方向上的光。&lt;/p&gt;

&lt;p&gt;如果我们把发射系数和吸收系数相除，我们会发现这个商的单位和辐射强度是一样的；所以我们可以把这个商当作一个新的“辐射强度”，并定义为源函数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_\nu = \frac{j_\nu}{\kappa_\nu} \tag{5.15}&lt;/script&gt;

&lt;p&gt;源函数的表征了光线在穿过介质的时候被介质替换掉的比例。它在之后的辐射转移中很有用。但是源函数的计算是比较复杂的，这里只考虑两个最极端的例子，纯各向同性散射以及纯吸收。&lt;/p&gt;

&lt;h5 id=&quot;纯各向同性散射&quot;&gt;纯各向同性散射&lt;/h5&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP5/pis.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如上图，介质中的粒子在接收到来自某个方向的光(&lt;script type=&quot;math/tex&quot;&gt;I_\nu \mathrm{d}\omega&lt;/script&gt;)之后会将其中一部分(&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;)散射掉，而且是均匀地散射到&lt;script type=&quot;math/tex&quot;&gt;4\pi&lt;/script&gt;立体角中。所以对于某个方向上单位立体角的观测者来说只能接收到&lt;script type=&quot;math/tex&quot;&gt;1/4\pi&lt;/script&gt;的光，即&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathrm{d}j_\nu = \frac{1}{4\pi}\kappa_\nu I_\nu \mathrm{d}\omega&lt;/script&gt;

&lt;p&gt;对不同方向求积分，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;j_\nu = \frac{1}{4\pi} \oint\kappa_\nu I_\nu \mathrm{d}\omega&lt;/script&gt;

&lt;p&gt;一般来说&lt;script type=&quot;math/tex&quot;&gt;\kappa_\nu&lt;/script&gt;和方向没有关系，所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_\nu = \frac{j_\nu}{\kappa_\nu} = \frac{1}{4\pi} \oint I_\nu \mathrm{d}\omega = J_\nu&lt;/script&gt;

&lt;p&gt;此时粒子“发射”的辐射强度是入射光的平均辐射强度，源函数只取决于辐射场，和粒子本身无关。&lt;/p&gt;

&lt;h5 id=&quot;纯吸收&quot;&gt;纯吸收&lt;/h5&gt;

&lt;p&gt;纯吸收并不意味着粒子就不发光了；只不过之前的散射是只改变光的方向，现在粒子吸收全部的光然后再发出自己的光。一般来说我们讨论粒子到达了热动平衡之后的状态，那么此时的源函数就是黑体辐射函数&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_\nu = B_\nu = \frac{2h\nu^3}{c^2} \frac{1}{e^{h\nu/kT}-1} \tag{5.16}&lt;/script&gt;

&lt;p&gt;此时粒子作为&lt;strong&gt;黑体&lt;/strong&gt;发光。&lt;/p&gt;

&lt;h3 id=&quot;爱因斯坦系数&quot;&gt;爱因斯坦系数&lt;/h3&gt;

&lt;p&gt;我们将自发辐射归入辐射，受激辐射（负吸收）和受激吸收归到吸收里面，并分别用&lt;script type=&quot;math/tex&quot;&gt;A, B&lt;/script&gt;表示它们的爱因斯坦系数，&lt;script type=&quot;math/tex&quot;&gt;l, u&lt;/script&gt;表示低、高能级，则有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} j_\nu\rho &amp; = N_uA_{ul}h\nu \\ \kappa_\nu\rho I_\nu &amp; = N_l B_{lu}I_\nu h\nu - N_uB_{ul}I_\nu h\nu \end{align} \tag{5.17} %]]&gt;&lt;/script&gt;
</description>
        <pubDate>Mon, 18 Dec 2017 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2017/12/18/OASP5/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/18/OASP5/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 4</title>
        <description>&lt;p&gt;这一章讲的是有关光电探测器的东西。从观测的角度来说，知道光电探测器的一些参数是很有必要的，比如说在仪器选择和之后的数据处理上。光电探测器分为两大类，积分的（常见的硅CCD）和脉冲计数的（光电倍增管）。积分类型的适合获取高信噪比图像，脉冲计数的信噪比稍低一点。当然除了探测器本身之外，我们还需要有很多其他的电子器件，来控制开关、记录时间、进行模数转换等。&lt;/p&gt;

&lt;h3 id=&quot;量子效率和光谱响应&quot;&gt;量子效率和光谱响应&lt;/h3&gt;

&lt;p&gt;量子效率定义为探测到的光子数和入射的光子数的比值，即&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;q(\lambda) = \frac{\mathrm{探测到的光子数}}{\mathrm{入射的光子数}}&lt;/script&gt;

&lt;p&gt;这个量当然越大越好，因为我们不想损失任何一个光子。同时比值的分子和分母都是波长&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;的函数，所以量子效率作为波长的函数也可以被称为光谱响应；这个量也是越宽越好。&lt;/p&gt;

&lt;p&gt;另一种量子效率的定义方式是从能量/电荷的角度去定义。我们可以用普朗克关系将入射光子数转化成能量：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;J = N \frac{hc}{\lambda}&lt;/script&gt;

&lt;p&gt;同时将探测到的光子数转化为电荷量：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Q = q'(\lambda)eN&lt;/script&gt;

&lt;p&gt;那么量子效率就变成了&lt;script type=&quot;math/tex&quot;&gt;J&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;Q&lt;/script&gt;的比：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;r = \frac{Q}{J} = \frac{e\lambda}{hc}q'(\lambda) = 8.066\times 10^{-5}\lambda q'(\lambda)&lt;/script&gt;

&lt;p&gt;一般来说硅探测器有很高的量子效率和比较宽的光谱响应。&lt;/p&gt;

&lt;h3 id=&quot;线性响应&quot;&gt;线性响应&lt;/h3&gt;

&lt;p&gt;除了“横向”的光谱响应以外，“纵向”的线性响应也是一个重要的参数。线性响应指的是输出的电子数量和入射的光子数量成正比的区间。在线性响应区间内，不考虑其他的误差时，探测到的谱线形状是不变的。但是如果离开了线性响应区间，就会使误差增大同时要做适当的改正。线性响应的区域和探测器用到的原理以及之后对电子的处理有关。&lt;/p&gt;

&lt;h3 id=&quot;硅二极管阵具体过程&quot;&gt;硅二极管阵（具体过程）&lt;/h3&gt;

&lt;p&gt;充电之后的硅二极管阵就像一个个小电容，光子在转化成电子之后被存储在每个单元中，通过方波信号控制读取或者移动。自扫描阵列(self scanning array)是1维的阵列，但是现在用的比较多的CCD是2维的阵列。（读出方式请回忆自己的理解）电子在不同像素中移动的时候会有损失，留下来的比例比较高(0.99950-0.999999)，但是架不住CCD太大。CCD在拍摄光谱的时候会将光谱在垂直色散方向的致宽求和；至于是在读出之前求和还是读出之后求和就看天体的亮度：是太暗所以先求和减少读出误差还是太亮所以后求和防止饱和。像素合并也可以提高读出速度。&lt;/p&gt;

&lt;p&gt;信号在离开探测器之后后被各种处理，放大、数字化、积分等等。重要的是最好在离开探测器之后马上进行放大，以防止后续操作带来的误差也被放大了。最后一步的数字化要求进行模数转换(Analog-to-digital, A/D conversion)，所以转换出来的数值的单位叫做ADU(A/D Unit)。ADU和光子数之间的关系可以通过放大器和探测器的性质得出。&lt;/p&gt;

&lt;p&gt;探测器不同像素之间的不一致大概在百分之几左右，可以用平场解决。为了减少误差平场的信噪比应当比亮帧的高几倍。但是对于靠近光谱响应边缘的光来说，因为探测器开始变得透明，望远镜结构和探测器本身会带来一些额外的像，这是平场所不能解决的，但是对于可见光来说问题不大。&lt;/p&gt;

&lt;h3 id=&quot;本底和宇宙线&quot;&gt;本底和宇宙线&lt;/h3&gt;

&lt;p&gt;所有的照片都是有本底的，即使没有打开镜头盖。这些电子的产生主要是因为热运动，所以冷却是一个减少热噪声的好办法。除了冷却之外，有些探测器还需要真空，防止因为温度梯度太大导致的结霜或者结露。足够低的温度可以将热噪声降低到可被忽略的水平，但是冷却也会影响探测器的光谱响应，如当温度降低100度时，红端的响应会降到1/10。所以宽光谱响应的探测器需要把温度浮动保持在1度以下。&lt;/p&gt;

&lt;p&gt;除此之外有的探测器还有一些偶尔出现的固定图样，如果每次的图样都一致的话也可以通过偏置减掉。宇宙线也会在照片中留下亮斑；只要像素合并不是很多的话比较容易被认出来。&lt;/p&gt;

&lt;h3 id=&quot;噪声&quot;&gt;噪声&lt;/h3&gt;

&lt;p&gt;噪声主要来自三个方面：星光本身的光子噪声、天光的光子噪声和仪器噪声。第一和第二种噪声是比较稳定而且容易计算的，所以它们的和提供了理论的噪声最小值。&lt;/p&gt;

&lt;p&gt;光子噪声遵从玻色-爱因斯坦统计：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta N = N^{1/2}(1 + \frac{1}{e^{\frac{h\nu}{kT}}-1})&lt;/script&gt;

&lt;p&gt;当&lt;script type=&quot;math/tex&quot;&gt;h\nu \ll kT&lt;/script&gt;的时候，上式可以简化为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta N = N^{1/2}&lt;/script&gt;

&lt;p&gt;假设仪器噪声也符合玻色-爱因斯坦统计，我们可以得出信噪比和探测到的光子数的关系。令&lt;script type=&quot;math/tex&quot;&gt;N&lt;/script&gt;为探测到的光子总数、&lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;为探测到的来自天体的光子总数、&lt;script type=&quot;math/tex&quot;&gt;B&lt;/script&gt;为来自所有其他源的光子总数，则根据光子守恒以及误差传递公式，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;L = N - B&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta L = (\Delta N^2 + \Delta B^2)^{1/2}&lt;/script&gt;

&lt;p&gt;将简化的玻色-爱因斯坦统计公式代入，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta L = (N + B)^{1/2}&lt;/script&gt;

&lt;p&gt;此时信噪比为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;s/n = L / \Delta L = \frac{L}{(L + 2B)^{1/2}}&lt;/script&gt;

&lt;p&gt;当来自其他源的光子数很小，即&lt;script type=&quot;math/tex&quot;&gt;B \ll L&lt;/script&gt;时，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;s/n \approx L^{1/2}&lt;/script&gt;

&lt;p&gt;信噪比正比于根号下恒星光子数。比如&lt;script type=&quot;math/tex&quot;&gt;10^4&lt;/script&gt;个光子对应100的信噪比，即1%的误差。而当&lt;script type=&quot;math/tex&quot;&gt;B \gg L&lt;/script&gt;的时候，式子变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;s/n = \frac{L}{(2B)^{1/2}}&lt;/script&gt;

&lt;p&gt;此时应尽量增大&lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;（增大口径、提高量子效率等），或减少&lt;script type=&quot;math/tex&quot;&gt;B&lt;/script&gt;。这个时候增大&lt;script type=&quot;math/tex&quot;&gt;L&lt;/script&gt;对信噪比的提高比&lt;script type=&quot;math/tex&quot;&gt;B \ll L&lt;/script&gt;时要快（正比）。&lt;/p&gt;

&lt;p&gt;当然在所有情况下，获得同样信噪比需要的时间是和天体的亮度有关的。&lt;/p&gt;

&lt;h3 id=&quot;探测器的选择&quot;&gt;探测器的选择&lt;/h3&gt;

&lt;p&gt;之前推出来的公式只是和探测到的光子数而不是天体入射的光子数有关，不利于实际计算，所以需要再作推广。&lt;/p&gt;

&lt;p&gt;令&lt;script type=&quot;math/tex&quot;&gt;l&lt;/script&gt;为恒星入射的光子数，则有&lt;script type=&quot;math/tex&quot;&gt;L = q(\lambda)l&lt;/script&gt;；同时假设天光的光子噪声相对仪器噪声可忽略（光谱情况下），仪器噪声为&lt;script type=&quot;math/tex&quot;&gt;r&lt;/script&gt;，则信噪比表达式为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;s/n = \frac{q(\lambda)l}{(q(\lambda)l + r^2)^{1/2}}&lt;/script&gt;

&lt;p&gt;从上式可以看出信噪比只和量子效率、入射光子数和读出噪声有关，而量子效率和读出噪声都可以测量。不同的&lt;script type=&quot;math/tex&quot;&gt;q, l, r&lt;/script&gt;值下的信噪比曲线如下图所示：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP4/fig4.4.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;入射光子数和信噪比的图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;显然当入射光子数大时，应选用量子效率高的探测器；而小时，应选用读出噪声小的。&lt;/p&gt;

&lt;h3 id=&quot;阱深和动态范围&quot;&gt;阱深和动态范围&lt;/h3&gt;

&lt;p&gt;一个像素点可以容纳的电量成为它的阱深。当势阱被填满了之后，这个像素将不能继续探测光子。所以当天体的光子噪声主导时，从理论上来说，势阱可容纳的最大光子数的平方根就是可以获得的最大信噪比。但是实际上达不到，因为逼近势阱的顶部的时候会出现其他问题；如果想提高信噪比就需要多次曝光并叠加。&lt;/p&gt;

&lt;p&gt;探测器本身的读出噪声加上可容纳的最大电量可以描述探测器的动态范围，也就是可以探测到的光子数量范围。比如读出噪声是400个电子，势阱可以容纳&lt;script type=&quot;math/tex&quot;&gt;1.2 \times 10^7&lt;/script&gt;个电子，那么动态范围为&lt;script type=&quot;math/tex&quot;&gt;\frac{1.2 \times 10^7}{400} = 3 \times 10^4&lt;/script&gt;。&lt;/p&gt;

&lt;h3 id=&quot;噪声的测量&quot;&gt;噪声的测量&lt;/h3&gt;

&lt;p&gt;作为主要对科学感兴趣的阵营，我们有的时候对总体的噪声水平感兴趣，而不是具体的噪声来源。一个简单而又直接的方法就是测拍摄多幅暗场，统计每个像素的ADU分布；分布的宽度就是噪声、平均值就是偏置。&lt;/p&gt;

&lt;p&gt;有的时候我们想知道测得的噪声ADU值对应多少光子；这时需要利用信噪比表达式将&lt;script type=&quot;math/tex&quot;&gt;s/n, L_{\mathrm{ADU}}, u_0&lt;/script&gt;（模数转换的常数，&lt;script type=&quot;math/tex&quot;&gt;\mathrm{photons/ADU}&lt;/script&gt;）&lt;script type=&quot;math/tex&quot;&gt;, r_{\mathrm{ADU}}&lt;/script&gt;联系起来：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;s/n = \frac{u_0 L_\mathrm{ADU}}{(u_0 L_\mathrm{ADU} + u_0^2 r_\mathrm{ADU}^2)^{1/2}} \\ = \frac{L_\mathrm{ADU}}{(\frac{ L_\mathrm{ADU}}{u_0} + r_\mathrm{ADU}^2)^{1/2}}&lt;/script&gt;

&lt;p&gt;利用暗场的起伏可以测出&lt;script type=&quot;math/tex&quot;&gt;r_\mathrm{ADU}&lt;/script&gt;，已知光度的灯平场以及起伏可以测出&lt;script type=&quot;math/tex&quot;&gt;s/n&lt;/script&gt;以及&lt;script type=&quot;math/tex&quot;&gt;L_\mathrm{ADU}&lt;/script&gt;，即可算出此时的&lt;script type=&quot;math/tex&quot;&gt;u_0&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;u_0 r_\mathrm{ADU}&lt;/script&gt;即为噪声对应的光子数。&lt;/p&gt;

&lt;h3 id=&quot;空间分辨率&quot;&gt;空间分辨率&lt;/h3&gt;

&lt;p&gt;空间分辨率是指可以将两个源分开的最小角距离。从频域的角度理解，因为像素阵列有大小，所以傅里叶变换之后频率大于奈奎斯特频率的信号会被盖掉，丢失了高频的信号。但是探测器单独的空间分辨率并不足以描述数据的轮廓；整体的谱线轮廓会在第12章讨论。&lt;/p&gt;

&lt;h3 id=&quot;略过的内容&quot;&gt;略过的内容&lt;/h3&gt;

&lt;p&gt;光电倍增管、照相底片&lt;/p&gt;
</description>
        <pubDate>Mon, 18 Dec 2017 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2017/12/18/OASP4/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/18/OASP4/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>OASP笔记 - 3</title>
        <description>&lt;p&gt;我们需要光谱仪，没有光谱仪哪来的光谱。低分辨率光谱仪可以得到天体的连续谱（第十章），而高分辨率的光谱仪可以得到天体的谱线（第十二章）。&lt;/p&gt;

&lt;h3 id=&quot;概述&quot;&gt;概述&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/3.1.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;光谱仪示意图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;从望远镜中过来的光在狭缝的中心聚焦，然后被准直器变为平行光照到光栅上面，色散后经过改正镜再被聚焦到CCD上。单色光会在焦面上形成一条线；而因为一般狭缝的宽度都比较大，最终在焦面形成的线宽基本不受光栅衍射条纹的影响。而当复色光入射到光谱仪的时候，焦面上将形成一段连续谱。连续谱中每个颜色的“纯净”程度由&lt;script type=&quot;math/tex&quot;&gt;\Delta \lambda&lt;/script&gt;决定。&lt;script type=&quot;math/tex&quot;&gt;\Delta \lambda&lt;/script&gt;越小，色散程度越大，天文学家们越高兴。不过色散程度也需要和天体入射的光的总量协调，因为色散程度越大每个像素的光流量越小，需要的积分时间就越长。一般来说我们需要&lt;script type=&quot;math/tex&quot;&gt;\Delta \lambda&lt;/script&gt;小于我们关心的光谱结构；第十二章有定量计算。&lt;/p&gt;

&lt;h3 id=&quot;衍射光栅及其原理&quot;&gt;衍射光栅及其原理&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/3.2.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;衍射光栅示意图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;令&lt;script type=&quot;math/tex&quot;&gt;P(0)&lt;/script&gt;所指示的点为相位0点，则在光栅上任一点和它的相位差为&lt;script type=&quot;math/tex&quot;&gt;x \sin{\alpha}&lt;/script&gt;；&lt;script type=&quot;math/tex&quot;&gt;\alpha&lt;/script&gt;为入射平面光法向与光栅法向的夹角，是一个定值。所以我们可以将在光栅上的入射光表达为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x, t) = F_0(t)e^{2\pi i\frac{x\sin{\alpha}}{\lambda}} \tag{3.1}&lt;/script&gt;

&lt;p&gt;同时因为入射光的频率很大，积分时间一般又比较长，所以可以将&lt;script type=&quot;math/tex&quot;&gt;F_0(t)&lt;/script&gt;用它的平均值&lt;script type=&quot;math/tex&quot;&gt;F_0&lt;/script&gt;代替。&lt;/p&gt;

&lt;p&gt;令&lt;script type=&quot;math/tex&quot;&gt;G(x)&lt;/script&gt;为光栅，&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
G(x) = \begin{cases} 1 &amp; \mathrm{狭缝中}\\ 0　&amp; \mathrm{狭缝外} \end{cases} %]]&gt;&lt;/script&gt;

&lt;p&gt;在&lt;script type=&quot;math/tex&quot;&gt;\beta&lt;/script&gt;角上看到的光强为&lt;script type=&quot;math/tex&quot;&gt;F(x, t)&lt;/script&gt;与&lt;script type=&quot;math/tex&quot;&gt;G(x)&lt;/script&gt;的乘积加上离开光栅后的相位差在&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;上的积分：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} g(\beta) &amp; = \int^{\infty}_{-\infty} F(x, t) e^{2\pi i\frac{x\sin{\beta}}{\lambda}} G(x) dx \\ &amp; = F_0\int^{\infty}_{-\infty} G(x) e^{2\pi i\frac{x\sin{\alpha}+x\sin{\beta}}{\lambda}} dx \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;令&lt;script type=&quot;math/tex&quot;&gt;\theta = \frac{\theta'}{\lambda} = \frac{\sin{\alpha} + \sin{\beta}}{\lambda}&lt;/script&gt;，有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;g(\theta) = F_0 \int^{\infty}_{-\infty} G(x) e^{2\pi ix\theta} dx \tag{3.2}&lt;/script&gt;

&lt;p&gt;将这个式子与&lt;a href=&quot;https://mingjiejian.github.io/2017/11/11/OASP2/&quot;&gt;第二章&lt;/a&gt;的傅里叶变换定义式比较，我们发现它们是一样的，所以光栅就相当于一个傅里叶变换器。因为这里&lt;script type=&quot;math/tex&quot;&gt;F_0&lt;/script&gt;是一个常数，重要的是后面的积分，所以之后我们将直接讨论&lt;script type=&quot;math/tex&quot;&gt;G(x)&lt;/script&gt;的傅里叶变换。&lt;/p&gt;

&lt;h4 id=&quot;gx的傅里叶变换&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;G(x)&lt;/script&gt;的傅里叶变换&lt;/h4&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;G(x)&lt;/script&gt;是由宽为&lt;script type=&quot;math/tex&quot;&gt;b&lt;/script&gt;的狭缝等距&lt;script type=&quot;math/tex&quot;&gt;d&lt;/script&gt;摆放直至充满宽度&lt;script type=&quot;math/tex&quot;&gt;W&lt;/script&gt;而来的：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;G(x) = B_1(x) * III(x) B_2(x) \tag{3.3}&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;B_1(x)&lt;/script&gt;为单个狭缝，它与&lt;script type=&quot;math/tex&quot;&gt;III(x)&lt;/script&gt;的卷积为无限宽的光栅，&lt;script type=&quot;math/tex&quot;&gt;B_2(x)&lt;/script&gt;为光栅的宽度。它的傅里叶变换为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}  g(\theta) &amp;= b_1(\theta) iii(\theta) * b_2(\theta) \\  &amp; = \frac{b\sin{\pi\theta b}}{\pi\theta b} iii(\theta) * \frac{W\sin{\pi\theta W}}{\pi\theta W} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;将Shah函数用&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数表达：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} g(\theta) &amp; = \sum \delta(\theta-\frac{n}{d}) * \frac{W\sin{\pi\theta W}}{\pi\theta W} \frac{b\sin{\pi\theta b}}{\pi\theta b} \\ &amp; = \sum_n \frac{W\sin{\pi(\theta-\frac{n}{d}) W}}{\pi(\theta-\frac{n}{d}) W} \frac{b\sin{\pi\theta b}}{\pi\theta b}  \end{align} \tag{3.4} %]]&gt;&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/grating.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;光栅以及它的傅里叶变换&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;在小角度下&lt;script type=&quot;math/tex&quot;&gt;d\theta'&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;d\beta&lt;/script&gt;近似是一样的：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\sin{\alpha} + \sin{\beta} = \theta' \Rightarrow d\theta' = \cos{\beta} d\beta \approx d\beta&lt;/script&gt;

&lt;p&gt;每个尖峰下降到0时的宽度由&lt;script type=&quot;math/tex&quot;&gt;B_2(x)&lt;/script&gt;决定：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \theta' = \frac{\lambda}{W}&lt;/script&gt;

&lt;p&gt;每个尖峰的位置由&lt;script type=&quot;math/tex&quot;&gt;III(x)&lt;/script&gt;决定：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\theta' = \frac{n\lambda}{d} = \sin{\alpha} + \sin{\beta} \tag{3.5}&lt;/script&gt;

&lt;p&gt;所以不同波长的光有不同的宽度和尖峰位置。这里的&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;称为级数，0级光谱所有波长的光都集中在&lt;script type=&quot;math/tex&quot;&gt;x=0&lt;/script&gt;处，所以为白光。1级和其他级光谱的分辨率为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{d\theta'}{d\lambda} = \frac{n}{d} \tag{3.6}&lt;/script&gt;

&lt;p&gt;将&lt;script type=&quot;math/tex&quot;&gt;\Delta \theta' = \frac{\lambda}{W}&lt;/script&gt;代入&lt;script type=&quot;math/tex&quot;&gt;(3.6)&lt;/script&gt;，得：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda = \frac{\lambda}{W} \frac{d}{n} \tag{3.7}&lt;/script&gt;

&lt;p&gt;这个量可以理解为单位角度上的波长改变量是多少；我们当然希望它越小越好，所以&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;小的时候要增大板宽和多刻线；&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;大的时候则不一定。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/chrome_I.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;复色光入射时的情况&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;闪耀光栅&quot;&gt;闪耀光栅&lt;/h3&gt;

&lt;p&gt;上图中我们可以看到透射光栅的光谱受到狭缝宽度影响，主要的能量落在了0级处，并没有分开。我们自然不希望这样，而是想让多数的光落在我们想要的级数上。要做到这一点，我们只需要将&lt;script type=&quot;math/tex&quot;&gt;b_2(\theta)&lt;/script&gt;的最高点从0移动到对应的级数位置即可。第二章傅里叶变换的性质2表明如果想在某个域上平移函数，需要在另一个域上引入相位差，在这里也就是不同的光程。实际的操作可以在狭缝中插入三棱镜让光线偏转，但是棱镜会带来色散，而且这样的光栅也很难制作。所以常用的是将狭缝改成倾斜的面镜，从而将光反射到某个特定角度。这样的光栅叫闪耀光栅，光栅法线与槽面法线之间的夹角&lt;script type=&quot;math/tex&quot;&gt;\phi&lt;/script&gt;叫闪耀角(在法线同侧的角度正负号相同)。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/3.3.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;闪耀光栅（右）示意图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;这个时候式子&lt;script type=&quot;math/tex&quot;&gt;(3.4)&lt;/script&gt;的最后一项发生了变化，&lt;script type=&quot;math/tex&quot;&gt;\alpha, \beta&lt;/script&gt;变成了&lt;script type=&quot;math/tex&quot;&gt;\alpha-\phi, \beta-\phi&lt;/script&gt;。这里用减号的原因是虽然对于槽面来说，图示的&lt;script type=&quot;math/tex&quot;&gt;\phi&lt;/script&gt;角会使得入射角和反射角都增大，但是&lt;script type=&quot;math/tex&quot;&gt;(3.4)&lt;/script&gt;中的&lt;script type=&quot;math/tex&quot;&gt;\alpha, \beta&lt;/script&gt;指的是箭头所指的线段长度，这两段线在反射光栅的情况下都减小了。所以对于归一化的这一项，我们有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I(\beta) = \left[\frac{\sin{\left\{ \pi b/\lambda [\sin{(\alpha-\phi)}+\sin{(\beta-\phi)}]\right\}}}{\pi b/\lambda [\sin{(\alpha-\phi)}+\sin{(\beta-\phi)}]}\right]^2 \tag{3.8}&lt;/script&gt;

&lt;p&gt;因为光栅的分光，只有符合&lt;script type=&quot;math/tex&quot;&gt;(3.5)&lt;/script&gt;的波长的光才能通过，所以我们可以将&lt;script type=&quot;math/tex&quot;&gt;(3.5)&lt;/script&gt;代入&lt;script type=&quot;math/tex&quot;&gt;(3.8)&lt;/script&gt;消去&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;（注意&lt;script type=&quot;math/tex&quot;&gt;(3.5)&lt;/script&gt;中的&lt;script type=&quot;math/tex&quot;&gt;\alpha, \beta&lt;/script&gt;不变），得到：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;I(\beta) = \left[\frac{\sin{\left\{ n\pi b/d [\cos{\phi}-\sin{\phi}\frac{\cos{\alpha}+\cos{\beta}}{\sin{\alpha}+\sin{\beta}}]\right\}}}{n\pi b/d [\cos{\phi}-\sin{\phi}\frac{\cos{\alpha}+\cos{\beta}}{\sin{\alpha}+\sin{\beta}}]}\right]^2 \tag{3.8}&lt;/script&gt;

&lt;p&gt;示例图如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/blazed_I.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;闪耀光栅的光强包络线，&lt;script type=&quot;math/tex&quot;&gt;\phi=15^\circ&lt;/script&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;可以看到这个时候整个函数的最大值被推到了&lt;script type=&quot;math/tex&quot;&gt;\alpha+\beta = 2\phi&lt;/script&gt;的地方。当然我们也可以用&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;作为自变量，画出&lt;script type=&quot;math/tex&quot;&gt;I(\beta)&lt;/script&gt;随&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;的变化情况。&lt;/p&gt;

&lt;h4 id=&quot;利特罗条件&quot;&gt;利特罗条件&lt;/h4&gt;

&lt;p&gt;一般来说光栅在制造的时候会被造成当入射角和衍射角一样的时候，1级光谱会被闪耀，这被叫做利特罗条件。但是当入射光线和衍射光线在同一个方向的时候，我们并不能接收到光谱，所以一般使用的是别的入射角；这种情况下1级光谱的闪耀波长会发生变化。假设利特罗条件下的闪耀波长为&lt;script type=&quot;math/tex&quot;&gt;\lambda_0&lt;/script&gt;，则根据&lt;script type=&quot;math/tex&quot;&gt;(3.5)&lt;/script&gt;有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{n\lambda}{d} = \sin{\alpha} + \sin{\beta}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \frac{n\lambda_0}{d} &amp;= 2\sin{\phi} \\ &amp;= 2\sin{\alpha+\beta} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;两式相除，得：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\lambda = \lambda_0 \cos{0.5(\alpha-\beta)}&lt;/script&gt;

&lt;h4 id=&quot;阴影&quot;&gt;阴影&lt;/h4&gt;

&lt;p&gt;光栅的摆放方式有很多种。我们之前讨论的都是入射光线和光栅法线在槽面法线的两侧；当然也可以倒过来摆，将入射光线和光栅法线放在槽面法线的同一侧(&lt;script type=&quot;math/tex&quot;&gt;% &lt;![CDATA[
\alpha &lt; \beta %]]&gt;&lt;/script&gt;的时候)。不过这样的话会引起一部分的光在反射后照射到槽的侧面，引起光损和杂散光。光损比例由下式决定：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f=\frac{2\tan{\phi}\tan{\beta-\phi}}{1+\tan{\phi}\tan{\beta-\phi}}&lt;/script&gt;

&lt;h4 id=&quot;如果光谱仪有缺陷&quot;&gt;如果光谱仪有缺陷&lt;/h4&gt;

&lt;p&gt;首先有周期性缺陷的光谱仪一般会产生鬼线。这样的光谱仪相当于两个光谱仪的叠加：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;G'(x) = G(x)H(x)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;H(x) = B_3(x) * III(x) B_2(x)&lt;/script&gt;

&lt;p&gt;所以“缺陷光谱仪”会在原来的谱线周围再加上一堆鬼线。如果周期性缺陷相对于原来的光谱的间隔很大，那么鬼线会在母线（原来的谱线）附近。我们可以仿照&lt;script type=&quot;math/tex&quot;&gt;(3.5)&lt;/script&gt;并且代入&lt;script type=&quot;math/tex&quot;&gt;(3.6)&lt;/script&gt;写出鬼线的&lt;script type=&quot;math/tex&quot;&gt;\Delta \lambda&lt;/script&gt;：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \theta_g = \frac{m\lambda_g}{D}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \lambda_g = \frac{d}{n}\frac{m}{D}\lambda_g&lt;/script&gt;

&lt;p&gt;所以鬼线是等距分布的。鬼线的光强比较复杂，但是一般母线的强度最大。&lt;/p&gt;

&lt;p&gt;还有另外的几种因缺陷引起的线，如卫星线（有一块刻歪了）等。&lt;/p&gt;

&lt;h3 id=&quot;色散和分辨率&quot;&gt;色散和分辨率&lt;/h3&gt;

&lt;p&gt;分辨率是光谱仪很重要的一个参数。但是在讨论分辨率之前我们需要分清楚它和色散的区别。&lt;/p&gt;

&lt;h4 id=&quot;角线色散&quot;&gt;角、线色散&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/3.4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如上图，如果两束不同波长的光射入镜头的角度为&lt;script type=&quot;math/tex&quot;&gt;\Delta \beta&lt;/script&gt;，则称它们的角色散为&lt;script type=&quot;math/tex&quot;&gt;\Delta \beta&lt;/script&gt;。角色散的大小是由光栅决定的，具体来说是&lt;script type=&quot;math/tex&quot;&gt;(3.6)&lt;/script&gt;式。这个角度最终在焦平面上投影的长度叫做线色散，易得：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta x = f_\mathrm{cam} \Delta \beta&lt;/script&gt;

&lt;p&gt;或者&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{d\beta}{dx} = \frac{1}{f_\mathrm{cam}}&lt;/script&gt;

&lt;p&gt;将角度转化成波长，有：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \frac{d\lambda}{dx} &amp;= \frac{d\lambda}{d\beta} \frac{d\beta}{dx} \\ &amp;= \frac{1}{f_\mathrm{cam}} \frac{1}{d\beta/d\lambda} \\ &amp;= \frac{1}{f_\mathrm{cam}} \frac{d\cos{\beta}}{n} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;这里没有小角度入射的假设，所以有一个&lt;script type=&quot;math/tex&quot;&gt;\cos{\beta}&lt;/script&gt;在。同样，高的色散程度对应着小的&lt;script type=&quot;math/tex&quot;&gt;\frac{d\lambda}{dx}&lt;/script&gt;。&lt;/p&gt;

&lt;h4 id=&quot;分辨率&quot;&gt;分辨率&lt;/h4&gt;

&lt;p&gt;我们从狭缝的大小开始考虑。令&lt;script type=&quot;math/tex&quot;&gt;f_\mathrm{coll}, f_\mathrm{cam}&lt;/script&gt;为准直器、成像相机的焦距，在小角度情况下，宽度为&lt;script type=&quot;math/tex&quot;&gt;W'&lt;/script&gt;的狭缝在准直器（或者光栅）上的角度为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \alpha = \frac{W'}{f_\mathrm{coll}}&lt;/script&gt;

&lt;p&gt;对&lt;script type=&quot;math/tex&quot;&gt;(3.5)&lt;/script&gt;式求导，得出：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta\beta = -\frac{\cos{\alpha}}{\cos{\beta}} \Delta \alpha&lt;/script&gt;

&lt;p&gt;所以&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \beta = -\frac{\cos{\alpha}W'}{\cos{\beta}f_\mathrm{coll}}&lt;/script&gt;

&lt;p&gt;令&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;为狭缝在CCD上的像宽，则&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} w &amp;= \Delta \beta f_\mathrm{cam} \\ &amp;= -\frac{\cos{\alpha}}{\cos{\beta}} \frac{f_\mathrm{cam}}{f_\mathrm{coll}} W' \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;{w/W'}&lt;/script&gt;正比于&lt;script type=&quot;math/tex&quot;&gt;f_\mathrm{cam}/f_\mathrm{coll}&lt;/script&gt;。一般来说我们需要CCD的像素与狭缝在CCD上的像宽相匹配，最好是1个单位像宽对应CCD上的两个像素（奈奎斯特频率）。稍微的过采样可能会有好处，但是面临着更长时间曝光和深度减小的问题；而欠采样会使得信息丢失。&lt;/p&gt;

&lt;p&gt;我们也可以将像宽&lt;script type=&quot;math/tex&quot;&gt;w&lt;/script&gt;转换成单位长度上的波长改变量（分辨率）：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align} \Delta \lambda &amp;= w \frac{d\lambda}{dx} \\ &amp;= -\frac{\cos{\alpha}}{\cos{\beta}} \frac{f_\mathrm{cam}}{f_\mathrm{coll}} W' \frac{1}{f_\mathrm{cam}} \frac{d\cos{\beta}}{n} \\ &amp;= -\cos{\alpha} \frac{W'd}{f_\mathrm{coll}n} \end{align} %]]&gt;&lt;/script&gt;

&lt;p&gt;可以看出分辨率与成像相机的焦距没有关系。提升分辨率可以通过改变上式的参数，但是一般会导致光损(减小&lt;script type=&quot;math/tex&quot;&gt;W'&lt;/script&gt;)或者需要更大/更好的光栅(增大&lt;script type=&quot;math/tex&quot;&gt;f_\mathrm{coll}&lt;/script&gt;或者&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;)。&lt;/p&gt;

&lt;h3 id=&quot;阶梯光谱仪&quot;&gt;阶梯光谱仪&lt;/h3&gt;

&lt;p&gt;通过增大&lt;script type=&quot;math/tex&quot;&gt;n&lt;/script&gt;来提高分辨率实际上没那么简单。使用高级数光谱的时候，虽然光谱的确被色散到了更宽的角度上（当然传统上这意味着需要更长的CCD），但是不同级数的光谱会发生重叠，使得不同（但是分立）波长的光同时照到了一个像素上。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/wav_inter.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;高级数光谱重叠情况；选择的当的话黑色虚线中间可以包含了整个波长范围的光&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;那么如果我们截取某一段区域，使得这段区域几个级数的光谱加起来刚好覆盖我们想要的波长，然后在后面加上一个在另一个方向上色散的光栅，就可以把光谱分成独立的条状并且覆盖很宽的波长范围；这就是阶梯光谱仪。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/echelle.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;阶梯光谱仪示意图&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;阶梯光谱仪的一个例子是京都产业大学制造的&lt;a href=&quot;http://merlot.kyoto-su.ac.jp/LIH/WINERED/index.html&quot;&gt;WINERED&lt;/a&gt;：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP3/winered-index.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://merlot.kyoto-su.ac.jp/LIH/WINERED/images/pic-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;图中下方从右到左为狭缝、准直镜以及阶梯光栅，中间的白色部分为CCD。这个光谱仪波长虽然在近红外(&lt;script type=&quot;math/tex&quot;&gt;0.90-1.35 \mu \mathrm{m}&lt;/script&gt;)，但是除了CCD部分之外都在常温下工作，不需要冷却；同时在分辨率、波长覆盖和灵敏度上都有不错的数值。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://merlot.kyoto-su.ac.jp/LIH/WINERED/images/pic-2.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;WINERED与其他光谱仪参数对比&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;略过的内容&quot;&gt;略过的内容&lt;/h3&gt;

&lt;p&gt;多目标光谱仪、迈克尔逊干涉仪、望远镜基础&lt;/p&gt;
</description>
        <pubDate>Mon, 18 Dec 2017 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2017/12/18/OASP3/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/18/OASP3/</guid>
        
        <category>learning</category>
        
        
      </item>
    
      <item>
        <title>公开课微信群</title>
        <description>&lt;h4 id=&quot;201712&quot;&gt;2017.12&lt;/h4&gt;

&lt;p&gt;这个月有一点忙，所以完成的质量不是很高；不过至少完成了python的matplotlib课程。
稍微简单总结一下吧，matplotlib是一个画图的软件包。画图虽然看起来很简单基本上而且是研究的最后一步，但是它却比一般想象中的重要。首先我们要思考的是我们需要用什么样的图去表达我们的数据；如果是时间序列那很显然不应该用柱状图而应该用点线来表达，如果是比例大小那就应该用饼图。选定了图表种类之后应该考虑的是如何准确地表达数据。如果柱状图中不同的柱子相差很小，那么将y轴范围设到刚好小于最小值与刚好大于最大值可以“显著地”拉开它们的差距，给人一种相差很大的感觉；这招在16年美国大选的时候被媒体用来误导读者川普的支持率很低。在准确性之上还有图表的配色，比如我是应该用不同的颜色去区分不同的线还是用不同的线型；两组不同的线可以再用什么风格去区分？这里的原则是能尽量不用彩色就不用彩色；不仅是因为印刷的时候更费油墨，也是考虑到色盲/色弱读者的情况。第二是面对不同的读者群体使用不同的风格。如果是同行/研究者，图标应该越简单越好，有利于同行尽快得到信息。而如果是面对普通读者，那么可以考虑加一些令人印象深刻的元素，比如用男女身体曲线来表达数据，会让看过的人很难忘记这组数据。&lt;/p&gt;

&lt;p&gt;当然现在matplotlib里面已经内置了不少画图的包，拿来用就好了。不过从默认到真正合适的图表还是要花不少心思的。&lt;/p&gt;

&lt;h4 id=&quot;201711&quot;&gt;2017.11&lt;/h4&gt;

&lt;p&gt;这个月完成了Coursera网页前端基础系列课程之中的两个。&lt;/p&gt;

&lt;p&gt;说起网页制作和设计，这是一直以来都挺想学的内容。第一它的实质仍然是编程，将代码转化为网页，自己对编程比较熟悉；第二它又和一直以来接触的数据处理不一样，主要负责呈现，也就是处在数据处理前面的内容。在数据可视化的过程中，一般平常用到编程语言的UI都是不怎么好看的，而且依赖于语言本身；但是通过网页前端呈现内容可以将两部分分离，也就是说不管后端用的是什么语言，只要输出格式正确，都能套到同一个网页中；而且网页的呈现方式基本上统一，HTML5+CSS3+JS，这就保证了在不同的平台/设备上都能获得相似的体验。&lt;/p&gt;

&lt;p&gt;这个月主要跟的是密歇根大学的Web Design for Everybody系列课程，从HTML5到JavaScript。实际上课程难度非常小，基本上只是教了语言最基本的用法；但是其中的思考方式和数据处理是很不一样的。作为网页，HTML5+CSS3将内容和样式分离，给与了一个网页无限多的可能；同时也给代码赋予了很大的灵活性，可以将某个元素多次定义，浏览器只会显示最后定义的样式。而在数据处理中，我们总是希望（至少在一个模块内）一个变量由始至终代表同一个数据而且尽量不去改变。当然JS的确就回到了传统意义上的编程，而且也通过程序给网页带来了非常多的可能性。&lt;/p&gt;

&lt;p&gt;有人监督的确更有动力去学，看着列表里面完成了的课越来越多挺有成就感的。下个月继续往网页设计方向稍微学深一点。&lt;/p&gt;

&lt;p&gt;同时推荐&lt;a href=&quot;http://www.csszengarden.com/&quot;&gt;CSS Zen Garden&lt;/a&gt;，看看别人是怎么将同一个网页通过不同的CSS3玩出花来的。&lt;/p&gt;
</description>
        <pubDate>Sun, 03 Dec 2017 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2017/12/03/course-group1/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/03/course-group1/</guid>
        
        <category>正业以外</category>
        
        
      </item>
    
      <item>
        <title>OASP - 2</title>
        <description>&lt;p&gt;傅里叶变换是非常有用的工具；不仅在时序上可以确定周期/频率，之后还会看到一个光谱仪也相当于一个傅里叶变换器。在这里有一点需要明确的是我们以后会经常讨论光谱，所以傅里叶变换的&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;域一般是光谱的频率域，而&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;域并没有很好的名字；所以下文统一称傅里叶变换前后的域为&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;域与&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;域。&lt;/p&gt;

&lt;h3 id=&quot;定义&quot;&gt;定义&lt;/h3&gt;

&lt;p&gt;一个函数&lt;script type=&quot;math/tex&quot;&gt;F(x)&lt;/script&gt;和它的傅里叶变换&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;的关系为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f(\sigma) = \int_{-\infty}^\infty F(x) e^{2\pi i x\sigma} \mathrm{d}x&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x) = \int_{-\infty}^\infty f(\sigma) e^{-2\pi i x\sigma} \mathrm{d}\sigma&lt;/script&gt;

&lt;p&gt;对于傅里叶变换的直观理解&lt;a href=&quot;https://www.zhihu.com/topic/19600515/top-answers&quot;&gt;知乎上&lt;/a&gt;已经有了很多不错的答案，我觉得只要了解可以将任何函数拆成各种各样的三角函数相加就可以了。&lt;script type=&quot;math/tex&quot;&gt;F,f&lt;/script&gt;一般都是复函数，只有当&lt;script type=&quot;math/tex&quot;&gt;F(x)&lt;/script&gt;为实偶函数的时候对应的&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;才是实函数。&lt;/p&gt;

&lt;p&gt;当&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;或&lt;script type=&quot;math/tex&quot;&gt;x = 0&lt;/script&gt;的时候，傅里叶和逆傅里叶变换变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f(0) = \int_{-\infty}^\infty F(x)  \mathrm{d}x&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(0) = \int_{-\infty}^\infty f(\sigma)  \mathrm{d}\sigma&lt;/script&gt;

&lt;p&gt;如果讨论谱线，此时傅里叶变换的意义就是谱线和&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;轴围成的面积，也就是总吸收量。&lt;/p&gt;

&lt;h3 id=&quot;常见的傅里叶变换&quot;&gt;常见的傅里叶变换&lt;/h3&gt;

&lt;p&gt;这里给出了常见的傅里叶变换以及图像。fft的结果因为是取模后画的图所以相当于解析的结果取了绝对值。&lt;/p&gt;

&lt;h5 id=&quot;方波&quot;&gt;方波&lt;/h5&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
B(x) = \begin{cases} 0 &amp; x \notin [-\frac{W}{2}, \frac{W}{2}] \\ 1 &amp; x \in [-\frac{W}{2}, \frac{W}{2}] \end{cases} %]]&gt;&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;b(\sigma) = W \frac{\sin{(\pi W\sigma)}}{\pi W\sigma}&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP2/01square_wave.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;高斯函数&quot;&gt;高斯函数&lt;/h5&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;G(x) = \frac{1}{\beta\pi^\frac{1}{2}} e^{-\frac{x^2}{\beta^2}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;g(\sigma) = e^{-(\pi\beta\sigma)^2}&lt;/script&gt;

&lt;p&gt;高斯的傅里叶变换是另一个高斯。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP2/02gauss.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;洛仑兹函数&quot;&gt;洛仑兹函数&lt;/h5&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;L(x) = \frac{1}{\pi} \frac{\beta}{x^2+\beta^2}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;l(x) = e^{-2\pi\beta|\sigma|}&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP2/03lorentz.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;delta函数&quot;&gt;&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数&lt;/h5&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x) = \delta(x-x_1)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f(\sigma) = e^{2\pi i x_1\sigma}&lt;/script&gt;

&lt;p&gt;单个&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数的傅里叶变换的振幅是常数，相位随着&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;线性增加；两个正而且对称的&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数的傅里叶变换是余弦函数，一正一负（对称）的傅里叶变换的振幅是正弦函数。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP2/04delta.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP2/05ddelta.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;shah函数&quot;&gt;Shah函数&lt;/h5&gt;

&lt;p&gt;Shah函数实际上是一堆等间距分布的&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;III(x) = \sum\limits_{n=-\infty}^{\infty} \delta(x - n\Delta x)&lt;/script&gt;

&lt;p&gt;它的傅里叶变换还是一个Shah函数，只不过间距变了：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;iii(\sigma) = \sum\limits_{n=-\infty}^{\infty} \delta(\sigma - n\frac{1}{\Delta x})&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/post-OASP2/06shah.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;以上的函数以及它们的傅里叶变换在接下来的一节以及第三章都会经常用到。&lt;/p&gt;

&lt;h3 id=&quot;数据采样&quot;&gt;数据采样&lt;/h3&gt;

&lt;p&gt;实际上观测到的数据都是离散的点，所以我们要考虑这样的离散化会带来什么样的结果。&lt;/p&gt;

&lt;p&gt;仍然从连续函数出发，离散化意味着将连续函数与Shah函数相乘（以波长为横坐标）：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D(\lambda) = III(\lambda)F(\lambda)&lt;/script&gt;

&lt;p&gt;实际测量的函数等于Shah函数与理想的连续函数相乘。同时一般来说，无论是时变数据还是光谱数据，我们都不可能无限地测量下去（望远镜时间不是无限的，光谱仪有截止波长），所以我们还需要加上一个响应度函数&lt;script type=&quot;math/tex&quot;&gt;B(\lambda)&lt;/script&gt;，来限制波长范围以及修改每个波长上的响应度（时间域上的数据应该不需要有响应度）：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D(\lambda) = B(\lambda)III(\lambda)F(\lambda)&lt;/script&gt;

&lt;p&gt;这个时候如果想求&lt;script type=&quot;math/tex&quot;&gt;D(\lambda)&lt;/script&gt;的傅里叶变换的话就需要知道几个函数相乘的傅里叶变换是什么，这就涉及到卷积了。&lt;/p&gt;

&lt;h3 id=&quot;卷积&quot;&gt;卷积&lt;/h3&gt;

&lt;p&gt;两个函数&lt;script type=&quot;math/tex&quot;&gt;f(\sigma), g(\sigma)&lt;/script&gt;的卷积定义为：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;k(\sigma) = f(\sigma) * g(\sigma) = \int_{-\infty}^{\infty} f(\sigma_1) g(\sigma-\sigma_1) \mathrm{d}\sigma_1&lt;/script&gt;

&lt;p&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%8D%B7%E7%A7%AF&quot;&gt;维基百科&lt;/a&gt;上的一张图可以比较直观地帮助理解卷积：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/b/b9/Convolution_of_spiky_function_with_box2.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;将其中一个函数以0为中心翻转、从左往右平移，两函数每点相乘在求和的结果就是这两个函数在第一个函数对称中心处的值。&lt;/p&gt;

&lt;p&gt;从定义以及理解可以容易得到&lt;script type=&quot;math/tex&quot;&gt;f(\sigma) * g(\sigma) = g(\sigma) * f(\sigma)&lt;/script&gt;。&lt;/p&gt;

&lt;h5 id=&quot;卷积和傅里叶变换的关系&quot;&gt;卷积和傅里叶变换的关系&lt;/h5&gt;

&lt;p&gt;实际上两函数相乘的傅里叶变换就是这两函数各自傅里叶变换的卷积(倒过来也对)，即&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x)G(x) \Longrightarrow f(\sigma) * g(\sigma)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x) * G(x) \Longrightarrow f(\sigma)g(\sigma)&lt;/script&gt;

&lt;p&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%8D%B7%E7%A7%AF%E5%AE%9A%E7%90%86&quot;&gt;维基百科&lt;/a&gt;上有证明；这里为了理解方便将证明过程倒过来写一遍。简单起见我们证明两函数各自傅里叶变换的卷积的逆傅里叶变换为两函数的乘积，可用富比尼定理，则：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align}  \int f(\sigma) * g(\sigma) e^{-2\pi ix\sigma} \mathrm{d}\sigma &amp; = F(x)G(x) \\ \int \left(\int f(\sigma_1) g(\sigma-\sigma_1) \mathrm{d}\sigma_1\right) e^{-2\pi ix\sigma} d\sigma &amp; = \int f(\sigma_1) \left( \int g(\sigma-\sigma_1) e^{-2\pi ix\sigma} \mathrm{d}\sigma\right) \mathrm{d}\sigma_1 \\ &amp; = \int f(\sigma_1) \left( \int g(\alpha) e^{-2\pi ix(\alpha + \sigma_1)} \mathrm{d}\alpha\right) \mathrm{d}\sigma_1 \\ &amp; = \int f(\sigma_1) e^{-2\pi ix\sigma_1} \mathrm{d}\sigma_1 \int g(\alpha) e^{-2\pi ix\alpha} \mathrm{d}\alpha \\ &amp; = F(x)G(x) \end{align} %]]&gt;&lt;/script&gt;

&lt;h5 id=&quot;与delta函数的卷积&quot;&gt;与&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数的卷积&lt;/h5&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x) * \delta(x-x_1) = F(x-x_1) \Longrightarrow f(\sigma) e^{2\pi ix_1\sigma}&lt;/script&gt;

&lt;p&gt;这个结果会在接下来的性质2中用到。&lt;/p&gt;

&lt;h5 id=&quot;高斯洛仑兹函数之间的卷积&quot;&gt;高斯、洛仑兹函数之间的卷积&lt;/h5&gt;

&lt;p&gt;高斯函数的傅里叶变换还是高斯函数&lt;script type=&quot;math/tex&quot;&gt;g(\sigma) = e^{-(\pi\beta\sigma)^2}&lt;/script&gt;，所以两个高斯函数卷积的傅里叶变换为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;g_a(\sigma)g_b(\sigma) = e^{-(\pi\beta_a\sigma)^2}e^{-(\pi\beta_b\sigma)^2} = e^{-(\pi\beta_c\sigma)^2}&lt;/script&gt;

&lt;p&gt;还是一个高斯函数；此时的&lt;script type=&quot;math/tex&quot;&gt;G(x)&lt;/script&gt;更窄，但是&lt;script type=&quot;math/tex&quot;&gt;g(\sigma)&lt;/script&gt;更宽&lt;script type=&quot;math/tex&quot;&gt;(\beta_c^2 = \beta_a^2+\beta_b^2)&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;同理，洛仑兹与洛仑兹函数的卷积也还是个洛仑兹函数，只不过现在&lt;script type=&quot;math/tex&quot;&gt;\beta_c = \beta_a + \beta_b&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;高斯函数和洛仑兹函数的卷积叫做福格特(Voigt)函数，它的傅里叶变换为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;v(\sigma) = e^{-\pi^2\beta_g^2\sigma^2} e^{-2\pi\beta_l|\sigma|}&lt;/script&gt;

&lt;p&gt;在第11章会用到。&lt;/p&gt;

&lt;h3 id=&quot;被模糊的数据&quot;&gt;被模糊的数据&lt;/h3&gt;

&lt;p&gt;我们现在可以回到&lt;script type=&quot;math/tex&quot;&gt;D(\lambda)&lt;/script&gt;中。除了截断和采样之外，观测仪器当然也会在最终的结果中留下一些特征，叫做仪器轮廓(instrumental profile)。一般来说这些特征是一个&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数；也就是说一个很窄的&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数在经过观测仪器之后会变成另一个宽一点的&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数，或者说两个&lt;script type=&quot;math/tex&quot;&gt;\delta&lt;/script&gt;函数卷积了。仪器轮廓可以被测出来（通过观测很细的谱线；第12章），我们在这里记作&lt;script type=&quot;math/tex&quot;&gt;I(\lambda)&lt;/script&gt;。所以现在的&lt;script type=&quot;math/tex&quot;&gt;D(\lambda)&lt;/script&gt;变成了&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D(\lambda) = [B(\lambda)III(\lambda)F(\lambda)] * I(\lambda)&lt;/script&gt;

&lt;p&gt;在&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;域，上式变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;d(\sigma) = [b(\sigma) * III(\sigma) * f(\sigma)] \times i(\sigma)&lt;/script&gt;

&lt;p&gt;可以看到最终傅里叶域的函数被乘上了一个&lt;script type=&quot;math/tex&quot;&gt;i(\sigma)&lt;/script&gt;。一般仪器轮廓是一个比较窄的高斯或者洛仑兹轮廓，所以它的傅里叶变换是一个相对宽的轮廓，对&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;域中的“低频”部分没有很大影响；但是轮廓会在高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;部分下降，所以会抹掉高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;部分的信息。在&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;域上这意味着每个数据点不再是一个孤立的点，而因为与仪器轮廓的卷积会和旁边的数据点耦合，将高&lt;script type=&quot;math/tex&quot;&gt;\lambda&lt;/script&gt;的信息“平均”掉。&lt;/p&gt;

&lt;h3 id=&quot;采样-iiisigma的影响&quot;&gt;采样 &lt;script type=&quot;math/tex&quot;&gt;III(\sigma)&lt;/script&gt;的影响&lt;/h3&gt;

&lt;p&gt;采样对高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;信号的也会产生影响（可能比仪器轮廓更大）。信号与Shah函数的卷积&lt;script type=&quot;math/tex&quot;&gt;III(\sigma) * f(\sigma)&lt;/script&gt;会使得信号在Shah函数每个不为0处附近重复，使得一样的图样发生重叠，同样抹掉了高&lt;script type=&quot;math/tex&quot;&gt;x&lt;/script&gt;的信息。因为Shah函数傅里叶变换后成为间隔为&lt;script type=&quot;math/tex&quot;&gt;\frac{1}{\Delta x}&lt;/script&gt;的Shah函数，所以我们认为在这个间隔的一半区间内，信号是没有重叠的，叫做奈奎斯特频率：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\sigma_N = \frac{1}{2\Delta x}&lt;/script&gt;

&lt;p&gt;在这里因为我们对信号进行了采样，所以得到的实际上是离散的信号点；我们并不知道点和点之间究竟是怎么样的（虽然经常认为是平滑过渡的），而点和点之间丢失的信息就对应着频域中大于奈奎斯特频率的部分，它们重叠了。与仪器轮廓的不同在于采样是离散化，而仪器轮廓是模糊。&lt;/p&gt;

&lt;p&gt;我们想做的是通过测量&lt;script type=&quot;math/tex&quot;&gt;D(\lambda)&lt;/script&gt;求得&lt;script type=&quot;math/tex&quot;&gt;d(\sigma)&lt;/script&gt;，再转换成&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;最后求得&lt;script type=&quot;math/tex&quot;&gt;F(\lambda)&lt;/script&gt;。从&lt;script type=&quot;math/tex&quot;&gt;d(\sigma)&lt;/script&gt;到&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;这一步有&lt;script type=&quot;math/tex&quot;&gt;III(\sigma)&lt;/script&gt;的作用，它们都抹掉了高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;的信息。如果&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;在高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;处趋于0，那么转换这一步基本上是正确的。但是如果重叠的部分很宽，这部分就不会有唯一的解，解决办法是减少采样的间隔。实际上&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;一般的确在高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;处趋于0，而且&lt;script type=&quot;math/tex&quot;&gt;i(\sigma)&lt;/script&gt;的存在也会强制使得&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;的值减小，所以转换是成立的。&lt;/p&gt;

&lt;p&gt;最后一个需要提及的是&lt;script type=&quot;math/tex&quot;&gt;b(\sigma)&lt;/script&gt;。只要&lt;script type=&quot;math/tex&quot;&gt;B(x)&lt;/script&gt;够宽，问题就不大；但是不够宽的时候&lt;script type=&quot;math/tex&quot;&gt;b(\sigma)&lt;/script&gt;本身的宽度和在&lt;script type=&quot;math/tex&quot;&gt;\sigma &gt; \frac{1}{W}&lt;/script&gt;处的起伏都会导致数据的模糊，所以有必要修改&lt;script type=&quot;math/tex&quot;&gt;B(x)&lt;/script&gt;的边缘以消除起伏。&lt;script type=&quot;math/tex&quot;&gt;b(\sigma)&lt;/script&gt;本身的宽度会使和&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;的卷积很大，所以有必要稍微减小&lt;script type=&quot;math/tex&quot;&gt;f(\sigma)&lt;/script&gt;。12章会有更多介绍。&lt;/p&gt;

&lt;h3 id=&quot;一些定理&quot;&gt;一些定理&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x_1) + F(x_2) \Leftrightarrow f(\sigma_1) + f(\sigma_2)&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;script type=&quot;math/tex; mode=display&quot;&gt;F(x - x_1) \Leftrightarrow e^{2\pi ix_1\sigma}f(\sigma)&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;script type=&quot;math/tex; mode=display&quot;&gt;F(ax) \Leftrightarrow |\frac{1}{a}|f(\frac{1}{a})&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{\mathrm{d}F(x)}{\mathrm{d}x} \Leftrightarrow 2\pi i \sigma f(\sigma)&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;script type=&quot;math/tex; mode=display&quot;&gt;K(x) = F(x) * G(x) \Rightarrow \frac{\mathrm{d}K(x)}{\mathrm{d}x} = \frac{\mathrm{d}F(x)}{\mathrm{d}x} * G(x) + F(x) * \frac{\mathrm{d}G(x)}{\mathrm{d}x}&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;script type=&quot;math/tex; mode=display&quot;&gt;\int G(x) \mathrm{d}x = 1 \Rightarrow \int F(x) * G(x) \mathrm{d}x = \int F(x) \mathrm{d}x&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;定义&lt;script type=&quot;math/tex&quot;&gt;z = \frac{\int xF(x) \mathrm{d}x}{\int F(x) \mathrm{d}x}&lt;/script&gt;，则若&lt;script type=&quot;math/tex&quot;&gt;K(x) = F(x) * G(x)&lt;/script&gt;，有&lt;script type=&quot;math/tex&quot;&gt;z_K = z_F + z_G&lt;/script&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;script type=&quot;math/tex; mode=display&quot;&gt;\int F(x) G^+(x) \mathrm{d}x = \int f(\sigma) g^+(\sigma) \mathrm{d}\sigma&lt;/script&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;离散计算&quot;&gt;离散计算&lt;/h3&gt;

&lt;p&gt;用定义计算有的时候会带来很大的计算量；而我们经常遇到的数据是均匀采样的，这个时候用快速傅里叶变换(FFT)可以很方便地计算。&lt;/p&gt;

&lt;p&gt;FFT中的输入和结果都是离散的，也就是说&lt;script type=&quot;math/tex&quot;&gt;D(x)&lt;/script&gt;变成了&lt;script type=&quot;math/tex&quot;&gt;D(j\Delta x)&lt;/script&gt;，&lt;script type=&quot;math/tex&quot;&gt;j&lt;/script&gt;是整数，从&lt;script type=&quot;math/tex&quot;&gt;0&lt;/script&gt;到&lt;script type=&quot;math/tex&quot;&gt;N&lt;/script&gt;。同理，将结果也离散化成&lt;script type=&quot;math/tex&quot;&gt;\sigma = k \Delta \sigma&lt;/script&gt;，从傅里叶变换的定义出发我们可以得到&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;d(\sigma) = d(k) = \sum_{j=1}^N D(j)e^{2\pi ijk\Delta x \Delta\sigma} \Delta x&lt;/script&gt;

&lt;p&gt;从上一节我们知道，采样后数据的傅里叶变换只在奈奎斯特频率以下包含有用数据，所以结果的计算也只到&lt;script type=&quot;math/tex&quot;&gt;\sigma_N  = \frac{1}{2\Delta x}&lt;/script&gt;为止。同时我们要求结果的长度和输入的数组长度一致，而且中间为0，所以频域的步长&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \sigma = \frac{\sigma_N}{N/2} = \frac{1}{\Delta x N}&lt;/script&gt;

&lt;p&gt;或者&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\Delta \sigma \Delta x = \frac{1}{N}&lt;/script&gt;

&lt;p&gt;所以最后我们得到&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;d(k) = \sum_{j=1}^N D(j)e^{2\pi ijk/N} \Delta x&lt;/script&gt;

&lt;p&gt;其实现在就是一个FFT命令的事情。&lt;/p&gt;

&lt;h5 id=&quot;有关numpy中的fft&quot;&gt;有关numpy中的fft&lt;/h5&gt;

&lt;p&gt;因为采样的缘故，fft只计算到奈奎斯特频率的位置。而如果原函数不是实数函数，那么傅里叶变换关于0点对称的复数值将不会共轭，所以numpy中的fft先计算0到&lt;script type=&quot;math/tex&quot;&gt;\sigma_N&lt;/script&gt;的值，再计算0到&lt;script type=&quot;math/tex&quot;&gt;-\sigma_N&lt;/script&gt;的值，并使傅里叶变换的长度与源函数长度一致（一半分给正频率，一半给负频率）。这给我们画图带来了一些麻烦，所以numpy提供了&lt;code class=&quot;highlighter-rouge&quot;&gt;numpy.fft.fftfreq(n[, d])&lt;/code&gt;来给出傅里叶变换的x值，只需输入原函数长度和步长即可。上面的画图中因为结果已知而且基本上特征都在0附近，所以人为地截断到了和原函数同样的x值上；也能看出fft的结果分辨率比解析的差一点，是采样带来的后果。&lt;/p&gt;

&lt;p&gt;有关模，fft结果乘上步长之后取模才是正确的大小，这是因为fft只计算了前两项，没有乘上最后的&lt;script type=&quot;math/tex&quot;&gt;\Delta x&lt;/script&gt;；当然这是因为程序不知道步长的缘故了。&lt;/p&gt;

&lt;p&gt;&lt;em&gt;（暂未解决shah函数的fft结果和预计不符的问题）&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;参见&lt;a href=&quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/routines.fft.html#module-numpy.fft&quot;&gt;这里&lt;/a&gt;。&lt;/p&gt;

&lt;h3 id=&quot;误差&quot;&gt;误差&lt;/h3&gt;

&lt;p&gt;测量是有误差的，那么测量的傅里叶变换误差是多少呢？假设&lt;script type=&quot;math/tex&quot;&gt;E(x)&lt;/script&gt;为函数&lt;script type=&quot;math/tex&quot;&gt;F_0(x)&lt;/script&gt;的测量误差，即&lt;script type=&quot;math/tex&quot;&gt;F(x) = F_0(x) + E(x)&lt;/script&gt;，那么根据定理1，&lt;script type=&quot;math/tex&quot;&gt;F(x)&lt;/script&gt;的傅里叶变换为&lt;script type=&quot;math/tex&quot;&gt;f(\sigma) = f_0(\sigma) + e(\sigma)&lt;/script&gt;。同时定理8告诉我们&lt;script type=&quot;math/tex&quot;&gt;\int \vert E(x)\vert^2  \mathrm{d}x = \int \vert e(\sigma)\vert^2 \mathrm{d}\sigma&lt;/script&gt;。&lt;/p&gt;

&lt;p&gt;&lt;em&gt;（实际上我们并不一定能知道&lt;script type=&quot;math/tex&quot;&gt;E(x)&lt;/script&gt;，更多时候是知道&lt;script type=&quot;math/tex&quot;&gt;E(x)&lt;/script&gt;的一些性质比如说平均值，这个时候怎么办？）&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;离散傅里叶变换里面上式会变为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\sum_1^N E^2(x_j)\Delta x = \sum_1^N e^2(\sigma_j) \Delta \sigma&lt;/script&gt;

&lt;p&gt;定义误差的标准差为&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_x = [\sum_1^N \frac{E^2(x_j)}{N-1}]^{1/2}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_\sigma = [\sum_1^N \frac{E^2(\sigma_j)}{N-1}]^{1/2}&lt;/script&gt;

&lt;p&gt;代进定理8导出来的式子里面，再加上&lt;script type=&quot;math/tex&quot;&gt;\Delta x&lt;/script&gt;和&lt;script type=&quot;math/tex&quot;&gt;\Delta \sigma&lt;/script&gt;的关系，我们有&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;S_\sigma = S_x \Delta x N^{1/2}&lt;/script&gt;

&lt;p&gt;也就是说想减少傅里叶变换的误差，可以减少测量误差或者缩短采样间隔，或者增大采样范围。实际测量的时候只把关心的数据点纳入（比如说某条谱线），将其他的点改成平均值或者1这种误差为0的数值可以减少测量误差。&lt;/p&gt;

&lt;p&gt;&lt;em&gt;（书里提到了FFT的数组长度必须为2的指数，但是实际上似乎不是？）&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;当误差与&lt;script type=&quot;math/tex&quot;&gt;x,\sigma&lt;/script&gt;无关，并且采样间隔小到除了&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;域的主体之外，还有一部分高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;的变换也在&lt;script type=&quot;math/tex&quot;&gt;\sigma_N&lt;/script&gt;之内时，我们通过可以高&lt;script type=&quot;math/tex&quot;&gt;\sigma&lt;/script&gt;部分直接测量&lt;script type=&quot;math/tex&quot;&gt;S_\sigma&lt;/script&gt;从而算出&lt;script type=&quot;math/tex&quot;&gt;S_x&lt;/script&gt;。&lt;/p&gt;

&lt;h3 id=&quot;时间序列略&quot;&gt;时间序列（略）&lt;/h3&gt;

&lt;p&gt;对于有周期的信号来说，长时间观测之后可以求出周期；但是观测时间不长或者周期性不明显的时候，可以考虑使用傅里叶变换。但是要注意由于采样引起的假信号（Shah函数），不一定每个峰都是真的。&lt;/p&gt;
</description>
        <pubDate>Sat, 11 Nov 2017 00:00:00 +0900</pubDate>
        <link>http://localhost:4000/2017/11/11/OASP2/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/11/OASP2/</guid>
        
        <category>learning</category>
        
        
      </item>
    
  </channel>
</rss>
